
==================================================
FILE: api.js
==================================================

import axios from "axios";
import { SERVER_BASE_URL } from "./config";

const API = axios.create({
  baseURL: `${SERVER_BASE_URL}/api`,
});

API.interceptors.request.use((req) => {
  const token = localStorage.getItem("token");
  if (token) {
    req.headers.Authorization = `Bearer ${token}`;
  }
  return req;
});

// USER AUTH
export const loginUser = (credentials) => API.post("/auth/login", credentials);
export const signupUser = (userData) => API.post("/auth/register", userData);
export const verifyEmail = (verificationData) =>
  API.post("/auth/verify-email", verificationData);
export const resendVerificationEmail = (email) =>
  API.post("/auth/resend-verification", { email });
export const requestPasswordReset = (email) =>
  API.post("/auth/forgot-password", { email });
export const resetPassword = (token, password) =>
  API.post("/auth/reset-password", { token, password });

// ADMIN AUTH
export const adminLogin = (credentials) =>
  API.post("/admin/auth/login", credentials);
export const getAdminStatus = () => API.get("/admin/auth/status");
export const adminSignup = (userData) =>
  API.post("/admin/auth/signup", userData);
export const verifyAdmin = (verificationData) =>
  API.post("/admin/auth/verify", verificationData);
export const getAdminProfile = () => API.get("/admin/users/me");

// TEMPLATES
export const getTemplates = () => API.get("/templates/");
export const getTemplate = (templateId) => API.get(`/templates/${templateId}`);
export const createTemplate = (formData) =>
  API.post("/templates/", formData, {
    headers: { "Content-Type": "multipart/form-data" },
  });
export const updateTemplate = (templateId, formData) =>
  API.put(`/templates/${templateId}`, formData, {
    headers: { "Content-Type": "multipart/form-data" },
  });
export const deleteTemplate = (templateId) =>
  API.delete(`/templates/${templateId}`);
export const createCustomTemplate = (formData) =>
  API.post("/templates/upload-custom", formData, {
    headers: { "Content-Type": "multipart/form-data" },
  });
export const updateCustomTemplate = (templateId, formData) =>
  API.put(`/templates/upload-custom/${templateId}`, formData, {
    headers: { "Content-Type": "multipart/form-data" },
  });

// CERTIFICATES
export const getCertificates = () => API.get("/certificates/");
export const createCertificate = (certData) =>
  API.post("/certificates/", certData);
export const getCertificate = (certId) => API.get(`/certificates/${certId}`);
export const updateCertificate = (certId, certData) =>
  API.put(`/certificates/${certId}`, certData);
export const deleteCertificate = (certId) =>
  API.delete(`/certificates/${certId}`);
export const verifyCertificate = (verificationId) =>
  API.get(`/certificates/verify/${verificationId}`);
export const bulkCreateCertificates = (formData) =>
  API.post("/certificates/bulk", formData, {
    headers: { "Content-Type": "multipart/form-data" },
  });
export const updateCertificateStatus = (certId, status) =>
  API.put(`/certificates/${certId}/status`, { status });
export const advancedSearchCertificates = (params) => {
  const cleanedParams = Object.entries(params).reduce((acc, [key, value]) => {
    if (value !== null && value !== "" && value !== undefined) acc[key] = value;
    return acc;
  }, {});
  return API.get(
    `/certificates/advanced-search?${new URLSearchParams(
      cleanedParams
    ).toString()}`
  );
};
export const getCertificatePDF = (certId) =>
  API.get(`/certificates/${certId}/pdf`, { responseType: "blob" });

// EMAILING
export const sendCertificateEmail = (certId) =>
  API.post(`/certificates/${certId}/send`);
export const sendBulkEmails = (certificateIds) =>
  API.post("/certificates/bulk-send", { certificate_ids: certificateIds });

// USER PROFILE & SETTINGS
export const getCurrentUser = () => API.get("/users/me");
export const uploadUserSignature = (formData) =>
  API.post("/users/me/signature", formData, {
    headers: { "Content-Type": "multipart/form-data" },
  });
export const switchToCompany = (companyName) =>
  API.post("/users/me/switch-to-company", { company_name: companyName });
export const generateApiKey = () => API.post("/users/me/api-key");
export const updateUserProfile = (data) => API.put("/users/me", data);

// PAYMENTS
export const initializePayment = (plan) =>
  API.post("/payments/initialize", { plan });
export const verifyPayment = (reference) =>
  API.get(`/payments/verify/${reference}`);

// USER ANALYTICS
export const getUserAnalytics = () => API.get("/analytics/dashboard");

// GROUPS
export const getGroups = (page = 1) => API.get(`/groups/?page=${page}`);
export const createGroup = (name) => API.post("/groups/", { name });
export const getGroupDetails = (groupId) => API.get(`/groups/${groupId}`);
export const deleteGroup = (groupId) => API.delete(`/groups/${groupId}`);
export const sendGroupBulkEmail = (groupId) =>
  API.post(`/groups/${groupId}/send-bulk-email`);
export const downloadGroupBulkPDF = (groupId) =>
  API.get(`/groups/${groupId}/download-bulk-pdf`, { responseType: "blob" });

// SUPPORT TICKETS
export const createUserTicket = (formData) =>
  API.post("/support/tickets", formData, {
    headers: { "Content-Type": "multipart/form-data" },
  });
export const getUserTickets = () => API.get("/support/tickets");
export const getUserTicketDetails = (ticketId) =>
  API.get(`/support/tickets/${ticketId}`);
export const replyToTicket = (ticketId, formData) =>
  API.post(`/support/tickets/${ticketId}/reply`, formData, {
    headers: { "Content-Type": "multipart/form-data" },
  });
export const deleteUserTicket = (ticketId) =>
  API.delete(`/support/tickets/${ticketId}`);

// CANVA
export const getCanvaAuthUrl = () => API.get("/canva/auth");

// CONTACT
export const sendContactMessage = (contactData) =>
  API.post("/contact/", contactData);

// MISC
export const downloadBulkTemplate = () =>
  API.get("/certificates/bulk-template", { responseType: "blob" });
export const uploadEditorImage = (formData) =>
  API.post("/uploads/editor-images", formData, {
    headers: { "Content-Type": "multipart/form-data" },
  });

// ADMIN API
export const getAdminUsers = (params = {}) =>
  API.get(`/admin/users?${new URLSearchParams(params).toString()}`);
export const getAdminUserDetails = (userId) =>
  API.get(`/admin/users/${userId}`);
export const adjustUserQuota = (userId, adjustment, reason) =>
  API.post(`/admin/users/${userId}/adjust-quota`, { adjustment, reason });
export const suspendAdminUser = (userId) =>
  API.post(`/admin/users/${userId}/suspend`);
export const unsuspendAdminUser = (userId) =>
  API.post(`/admin/users/${userId}/unsuspend`);
export const updateAdminUserPlan = (userId, plan) =>
  API.put(`/admin/users/${userId}/plan`, { plan });
export const deleteAdminUser = (userId) =>
  API.delete(`/admin/users/${userId}/delete`);
export const getAdminCompanies = (params = {}) =>
  API.get(`/admin/companies?${new URLSearchParams(params).toString()}`);
export const getAdminCompanyDetails = (companyId) =>
  API.get(`/admin/companies/${companyId}`);
export const deleteAdminCompany = (companyId) =>
  API.delete(`/admin/companies/${companyId}/delete`);
export const getEmailRecipients = () => API.get("/admin/messaging/recipients");
export const sendAdminBulkEmail = (emailData) =>
  API.post("/admin/messaging/send-email", emailData);
export const getAdminTransactions = (params = {}) =>
  API.get(
    `/admin/payments/transactions?${new URLSearchParams(params).toString()}`
  );
export const getAdminTransactionDetails = (paymentId) =>
  API.get(`/admin/payments/transactions/${paymentId}`);
export const getAdminCertificatesOverview = () =>
  API.get("/admin/certificates/overview");
export const getAdminCertificates = (params = {}) =>
  API.get(`/admin/certificates?${new URLSearchParams(params).toString()}`);
export const revokeAdminCertificate = (certId) =>
  API.post(`/admin/certificates/${certId}/revoke`);
export const getAdminAnalytics = (period = "1y") =>
  API.get(`/admin/analytics/insights?period=${period}`);
export const getAdminDashboardStats = () => API.get("/admin/dashboard-stats");
export const getOpenTicketsCount = () =>
  API.get("/admin/support/tickets/open-count");
export const getAdminSupportTickets = (params = {}) =>
  API.get(`/admin/support/tickets?${new URLSearchParams(params).toString()}`);
export const getAdminTicketDetails = (ticketId) =>
  API.get(`/admin/support/tickets/${ticketId}`);
export const adminReplyToTicket = (ticketId, message, file) => {
  const formData = new FormData();
  formData.append("message", message);
  if (file) formData.append("file", file);
  return API.post(`/admin/support/tickets/${ticketId}/reply`, formData, {
    headers: { "Content-Type": "multipart/form-data" },
  });
};
export const updateTicketStatus = (ticketId, status) =>
  API.put(`/admin/support/tickets/${ticketId}/status`, { status });



==================================================
FILE: App.css
==================================================

/* --- START OF FILE frontend/src/App.css --- */
:root {
  --primary-blue: #2563eb;
  --secondary-gold: #facc15;
  --background-white: #f9fafb;
  --text-slate: #1e293b;
  --accent-green: #22c55e;
  --text-slate-light: #64748b;
  --sidebar-bg: #111827; /* Darker sidebar for more contrast */
  --sidebar-text: #94a3b8;
  --sidebar-text-active: #ffffff;
  --border-color: #e5e7eb; /* A consistent light border color */
}

body {
  font-family: "Inter", sans-serif;
  background-color: var(--background-white);
  color: var(--text-slate);
}

h1,
h2,
h3,
h4,
h5,
h6 {
  font-family: "Poppins", sans-serif;
  font-weight: 700;
  color: var(--text-slate);
}

/* --- DASHBOARD LAYOUT & UI POLISH --- */
.dashboard-layout {
  display: flex;
  min-height: 100vh;
}
.sidebar {
  width: 260px;
  background-color: var(--sidebar-bg);
  color: var(--sidebar-text);
  padding: 1.5rem 1rem;
  display: flex;
  flex-direction: column;
  flex-shrink: 0;
  border-right: 1px solid #1f2937; /* Subtle separator */
}
.sidebar-logo {
  font-family: "Poppins", sans-serif;
  font-weight: 700;
  font-size: 1.5rem;
  color: white;
  margin-bottom: 3rem;
  text-decoration: none;
  padding-left: 0.5rem;
}
.sidebar-logo .green {
  color: var(--accent-green);
}
.sidebar-logo .blue {
  color: var(--primary-blue);
}

.sidebar .nav-link {
  color: var(--sidebar-text);
  font-weight: 500;
  padding: 0.75rem 1rem;
  border-radius: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.75rem;
  transition: all 0.2s ease-in-out;
}
.sidebar .nav-link:hover {
  background-color: rgba(255, 255, 255, 0.05);
  color: white;
}
.sidebar .nav-link.active {
  background-color: var(--primary-blue);
  color: var(--sidebar-text-active);
  font-weight: 600;
  box-shadow: 0 4px 10px rgba(37, 99, 235, 0.3);
}

.main-content {
  flex-grow: 1;
  background-color: var(--background-white);
}
.dashboard-nav {
  background-color: var(--background-white);
  border-bottom: 1px solid var(--border-color);
  position: sticky;
  top: 0;
  z-index: 1000;
}
.workspace {
  padding: 2rem;
}

/* Custom Main Content Card */
.page-content-card {
  background-color: white;
  padding: 2rem;
  border-radius: 1.5rem; /* Super curvy */
  border: 1px solid var(--border-color);
  box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
}

/* --- MODERN COMPONENT STYLES --- */
.stat-card {
  background-color: white;
  border: 1px solid var(--border-color);
  border-radius: 1.5rem;
  padding: 1.5rem;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.stat-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.07);
}
.stat-card-icon {
  width: 48px;
  height: 48px;
  border-radius: 0.75rem;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 1rem;
}
.stat-card-icon.blue {
  background-color: rgba(37, 99, 235, 0.1);
  color: var(--primary-blue);
}
.stat-card-icon.green {
  background-color: rgba(34, 197, 94, 0.1);
  color: var(--accent-green);
}
.stat-card-icon.gold {
  background-color: rgba(250, 204, 21, 0.1);
  color: var(--secondary-gold);
}

.empty-state-card {
  border-style: dashed;
  border-width: 2px;
  border-color: #cbd5e1;
  background-color: #fdfdff;
  padding: 4rem;
  text-align: center;
  border-radius: 1.5rem;
}
.settings-tabs .nav-link {
  color: var(--text-slate-light);
  font-weight: 600;
  border: none;
  border-bottom: 2px solid transparent;
  padding: 0.5rem 0;
  margin-right: 2rem;
}
.settings-tabs .nav-link.active {
  color: var(--primary-blue);
  border-bottom: 2px solid var(--primary-blue);
}

/* Custom Form Styles */
.custom-form-control {
  border-radius: 0.75rem !important;
  padding: 0.9rem 1rem !important;
  border: 1px solid var(--border-color) !important;
  background-color: var(--background-white) !important;
}
.custom-form-control:focus {
  border-color: var(--primary-blue) !important;
  box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.2) !important;
}

/* Custom Accordion Styles */
.custom-accordion .accordion-item {
  background-color: #f9fafb; /* Slightly off-white */
  border: 1px solid var(--border-color);
  border-radius: 1rem !important;
  margin-bottom: 1rem;
}
.custom-accordion .accordion-button {
  font-weight: 600;
  color: var(--text-slate);
  background-color: #f9fafb;
  border-radius: 1rem !important;
}
.custom-accordion .accordion-button:focus {
  box-shadow: none;
}
.custom-accordion .accordion-button:not(.collapsed) {
  background-color: #f0f2f5;
  color: var(--primary-blue);
}
.custom-accordion .accordion-body {
  padding: 1rem 1.25rem;
}
.certificate-preview {
  background-color: #f9fafb;
  border: 1px solid var(--border-color);
  border-radius: 1.5rem;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  padding: 2rem;
  position: sticky;
  top: 100px;
}
/* --- END OF FILE frontend/src/App.css --- */



==================================================
FILE: App.jsx
==================================================

import React from "react";
import { Routes, Route } from "react-router-dom";

// User-facing imports
import DashboardLayout from "./layouts/DashboardLayout";
import LandingPage from "./pages/LandingPage";
import LoginPage from "./pages/LoginPage";
import SignupPage from "./pages/SignupPage";
import MyCertificatesPage from "./pages/MyCertificatesPage";
import CreateCertificatePage from "./pages/CreateCertificatePage";
import SettingsPage from "./pages/SettingsPage";
import TemplatesPage from "./pages/TemplatesPage";
import ViewCertificatePage from "./pages/ViewCertificatePage";
import VerifyCertificatePage from "./pages/VerifyCertificatePage";
import BulkCreateCertificatesPage from "./pages/BulkCreateCertificatesPage";
import ProtectedRoute from "./components/ProtectedRoute";
import GroupsPage from "./pages/GroupsPage";
import ContactSupportPage from "./pages/ContactSupportPage";
import ForgotPasswordPage from "./pages/ForgotPasswordPage";
import ResetPasswordPage from "./pages/ResetPasswordPage";
import AnalyticsPage from "./pages/AnalyticsPage";
import UploadTemplatePage from "./pages/UploadTemplatePage";
import OpenLedgerPage from "./pages/OpenLedgerPage";
import SupportHubPage from "./pages/SupportHubPage";
import HelpArticlePage from "./pages/HelpArticlePage";
import VerifyEmailPage from "./pages/VerifyEmailPage";
import PricingPage from "./pages/PricingPage"; // Import new page
import ContactPage from "./pages/ContactPage"; // Import new page

// Admin imports
import AdminPortalPage from "./pages/AdminPortalPage";
import AdminVerifyPage from "./pages/AdminVerifyPage";
import AdminProtectedRoute from "./components/AdminProtectedRoute";
import AdminLayout from "./layouts/AdminLayout";
import AdminDashboardPage from "./pages/AdminDashboardPage";
import AdminUserManagementPage from "./pages/AdminUserManagementPage";
import AdminPaymentsPage from "./pages/AdminPaymentsPage";
import AdminCertificatesPage from "./pages/AdminCertificatesPage";
import AdminAnalyticsPage from "./pages/AdminAnalyticsPage";
import AdminUserDetailsPage from "./pages/AdminUserDetailsPage";
import AdminPaymentDetailsPage from "./pages/AdminPaymentDetailsPage";
import AdminSupportPage from "./pages/AdminSupportPage";
import AdminSupportTicketDetailsPage from "./pages/AdminSupportTicketDetailsPage";
import AdminCompaniesPage from "./pages/AdminCompaniesPage";
import AdminCompanyDetailsPage from "./pages/AdminCompanyDetailsPage";
import AdminMessagingPage from "./pages/AdminMessagingPage";

import DocsPage from "./pages/DocsPage";

const NotFoundPage = () => <h1 className="p-5">404: Page Not Found</h1>;

function App() {
  return (
    <Routes>
      {/* Public routes */}
      <Route path="/" element={<LandingPage />} />
      <Route path="/pricing" element={<PricingPage />} />
      <Route path="/contact" element={<ContactPage />} />
      <Route path="/login" element={<LoginPage />} />
      <Route path="/signup" element={<SignupPage />} />
      <Route path="/verify-email" element={<VerifyEmailPage />} />
      <Route path="/forgot-password" element={<ForgotPasswordPage />} />
      <Route path="/reset-password/:token" element={<ResetPasswordPage />} />
      <Route path="/verify" element={<VerifyCertificatePage />} />
      <Route
        path="/verify/:verificationId"
        element={<VerifyCertificatePage />}
      />
      <Route path="/search" element={<OpenLedgerPage />} />
      <Route path="/docs" element={<DocsPage />} />

      {/* Admin Routes */}
      <Route path="/admin/login" element={<AdminPortalPage />} />
      <Route path="/admin/verify" element={<AdminVerifyPage />} />
      <Route element={<AdminProtectedRoute />}>
        <Route path="/admin" element={<AdminLayout />}>
          <Route path="dashboard" element={<AdminDashboardPage />} />
          <Route path="users" element={<AdminUserManagementPage />} />
          <Route path="users/:userId" element={<AdminUserDetailsPage />} />
          <Route path="payments" element={<AdminPaymentsPage />} />
          <Route
            path="payments/:paymentId"
            element={<AdminPaymentDetailsPage />}
          />
          <Route path="certificates" element={<AdminCertificatesPage />} />
          <Route path="analytics" element={<AdminAnalyticsPage />} />
          <Route path="support" element={<AdminSupportPage />} />
          <Route
            path="support/:ticketId"
            element={<AdminSupportTicketDetailsPage />}
          />
          <Route path="companies" element={<AdminCompaniesPage />} />
          <Route
            path="companies/:companyId"
            element={<AdminCompanyDetailsPage />}
          />
          <Route path="messaging" element={<AdminMessagingPage />} />
        </Route>
      </Route>

      {/* Protected User Routes */}
      <Route element={<ProtectedRoute />}>
        <Route path="/dashboard" element={<DashboardLayout />}>
          <Route index element={<MyCertificatesPage />} />
          <Route path="analytics" element={<AnalyticsPage />} />
          <Route path="templates" element={<TemplatesPage />} />
          <Route path="groups" element={<GroupsPage />} />
          <Route path="create" element={<CreateCertificatePage />} />
          <Route path="edit/:certId" element={<CreateCertificatePage />} />
          <Route path="view/:certId" element={<ViewCertificatePage />} />
          <Route path="bulk-create" element={<BulkCreateCertificatesPage />} />
          <Route path="settings" element={<SettingsPage />} />

          <Route path="support">
            <Route index element={<SupportHubPage />} />
            <Route path="articles/:slug" element={<HelpArticlePage />} />
            <Route path="tickets" element={<ContactSupportPage />} />
            <Route path="tickets/:ticketId" element={<ContactSupportPage />} />
          </Route>

          <Route path="upload-template" element={<UploadTemplatePage />} />
          <Route
            path="upload-template/:templateId"
            element={<UploadTemplatePage />}
          />
        </Route>
      </Route>

      <Route path="*" element={<NotFoundPage />} />
    </Routes>
  );
}

export default App;



==================================================
FILE: config.js
==================================================

export const API_BASE_URL =
  import.meta.env.VITE_API_URL || "http://127.0.0.1:5000/api";

export const SERVER_BASE_URL =
  import.meta.env.VITE_SERVER_URL || "http://127.0.0.1:5000";



==================================================
FILE: index.css
==================================================

/* frontend/src/index.css */
@import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600;700&display=swap");

html {
  scroll-behavior: smooth;
}

body {
  font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
    Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
}



==================================================
FILE: index.jsx
==================================================

import React from "react";
import ReactDOM from "react-dom/client";
import { BrowserRouter } from "react-router-dom";
import App from "./App";

// Import all necessary stylesheets for the entire application
import "bootstrap/dist/css/bootstrap.min.css";
import "./styles/App.css"; // Main stylesheet for dashboard
import "./styles/Auth.css"; // Styles for Login/Signup
import "./styles/LandingPage.css"; // Styles for the new minimal landing page
import "./styles/VerifyPage.css"; // Styles for the new verification page
import "./styles/SupportPage.css"; // Styles for the support page

const root = ReactDOM.createRoot(document.getElementById("root"));
root.render(
  <React.StrictMode>
    <BrowserRouter>
      <App />
    </BrowserRouter>
  </React.StrictMode>
);

// Service Worker registration logic
if ("serviceWorker" in navigator) {
  window.addEventListener("load", () => {
    navigator.serviceWorker
      .register("/sw.js")
      .then((registration) => {
        console.log("Service Worker registered: ", registration);
      })
      .catch((registrationError) => {
        console.log("Service Worker registration failed: ", registrationError);
      });
  });
}



==================================================
FILE: main.jsx
==================================================

import React from "react";
import ReactDOM from "react-dom/client";
import { BrowserRouter } from "react-router-dom";
import App from "./App.jsx";
import "bootstrap/dist/css/bootstrap.min.css";
import "./App.css"; // Import the main App.css for global styles

ReactDOM.createRoot(document.getElementById("root")).render(
  <React.StrictMode>
    <BrowserRouter>
      <App />
    </BrowserRouter>
  </React.StrictMode>
);



==================================================
FILE: sw.js
==================================================

const CACHE_NAME = "certifyme-cache-v1";
const APP_SHELL_URLS = [
  "/",
  "/index.html",
  "/manifest.json",
  "/images/certbadge.png",
];

// On install, cache the app shell
self.addEventListener("install", (event) => {
  event.waitUntil(
    caches.open(CACHE_NAME).then((cache) => {
      console.log("Service Worker: Caching App Shell");
      return cache.addAll(APP_SHELL_URLS);
    })
  );
});

// On activate, clean up old caches
self.addEventListener("activate", (event) => {
  event.waitUntil(
    caches.keys().then((cacheNames) => {
      return Promise.all(
        cacheNames
          .filter((name) => name !== CACHE_NAME)
          .map((name) => caches.delete(name))
      );
    })
  );
});

// On fetch, use stale-while-revalidate strategy
self.addEventListener("fetch", (event) => {
  // Ignore non-GET requests and API calls
  if (event.request.method !== "GET" || event.request.url.includes("/api/")) {
    return;
  }

  event.respondWith(
    caches.open(CACHE_NAME).then((cache) => {
      return cache.match(event.request).then((cachedResponse) => {
        // Fetch from network in the background to update cache
        const fetchPromise = fetch(event.request).then((networkResponse) => {
          cache.put(event.request, networkResponse.clone());
          return networkResponse;
        });

        // Return cached response immediately if available, otherwise wait for network
        return cachedResponse || fetchPromise;
      });
    })
  );
});



==================================================
FILE: components\AdminProtectedRoute.jsx
==================================================

import React, { useEffect, useState } from "react";
import { Navigate, Outlet } from "react-router-dom";
import { getAdminProfile } from "../api";

function AdminProtectedRoute() {
  const [isAdmin, setIsAdmin] = useState(null);
  const [error, setError] = useState("");

  useEffect(() => {
    const verifyAdminStatus = async () => {
      try {
        const response = await getAdminProfile();
        if (response.data.is_admin) {
          setIsAdmin(true);
        } else {
          setIsAdmin(false);
          setError("Administration rights required");
        }
      } catch (err) {
        console.error("Admin verification failed:", err);
        setIsAdmin(false);
        setError(
          err.response?.data?.msg ||
            "Failed to verify admin status. Please try logging in again."
        );
      }
    };

    verifyAdminStatus();
  }, []);

  if (isAdmin === null) {
    return <div>Loading...</div>;
  }

  if (!isAdmin) {
    return (
      <Navigate
        to="/admin/login"
        state={{ error: error || "Please log in as an admin" }}
      />
    );
  }

  return <Outlet />;
}

export default AdminProtectedRoute;



==================================================
FILE: components\AdminSidebar.jsx
==================================================

import React from "react";
import { Nav, Image } from "react-bootstrap";
import { NavLink, Link, useNavigate } from "react-router-dom";
import {
  Speedometer2,
  PeopleFill,
  BoxArrowRight,
  Building,
  CashStack,
  FileEarmarkText,
  BarChartFill,
  ChatDotsFill,
  EnvelopeFill,
} from "react-bootstrap-icons";

function AdminSidebar() {
  const navigate = useNavigate();

  const handleLogout = (e) => {
    e.preventDefault();
    localStorage.removeItem("token");
    navigate("/admin/login");
  };

  return (
    <div className="sidebar">
      <div>
        <Link to="/admin/dashboard" className="sidebar-logo">
          <Image src="/images/certbadge.png" width={32} />
          <span>
            <span className="green">Certify</span>
            <span className="blue">Me</span>
          </span>
        </Link>
        <Nav className="flex-column" as="ul">
          <Nav.Item as="li">
            <NavLink to="/admin/dashboard" className="nav-link" end>
              <Speedometer2 />
              <span>Dashboard</span>
            </NavLink>
          </Nav.Item>
          <Nav.Item as="li">
            <NavLink to="/admin/users" className="nav-link">
              <PeopleFill />
              <span>User Management</span>
            </NavLink>
          </Nav.Item>
          {/* --- NEW: Company Management --- */}
          <Nav.Item as="li">
            <NavLink to="/admin/companies" className="nav-link">
              <Building />
              <span>Companies</span>
            </NavLink>
          </Nav.Item>
          <Nav.Item as="li">
            <NavLink to="/admin/payments" className="nav-link">
              <CashStack />
              <span>Payments</span>
            </NavLink>
          </Nav.Item>
          <Nav.Item as="li">
            <NavLink to="/admin/certificates" className="nav-link">
              <FileEarmarkText />
              <span>Certificates</span>
            </NavLink>
          </Nav.Item>
          <Nav.Item as="li">
            <NavLink to="/admin/analytics" className="nav-link">
              <BarChartFill />
              <span>Analytics</span>
            </NavLink>
          </Nav.Item>
          <Nav.Item as="li">
            <NavLink to="/admin/support" className="nav-link">
              <ChatDotsFill />
              <span>Support Tickets</span>
            </NavLink>
          </Nav.Item>
          {/* --- NEW: Messaging --- */}
          <Nav.Item as="li">
            <NavLink to="/admin/messaging" className="nav-link">
              <EnvelopeFill />
              <span>Messaging</span>
            </NavLink>
          </Nav.Item>
        </Nav>
      </div>
      <Nav className="flex-column" as="ul">
        <Nav.Item as="li">
          <Nav.Link href="#" onClick={handleLogout} className="nav-link">
            <BoxArrowRight />
            <span>Logout</span>
          </Nav.Link>
        </Nav.Item>
      </Nav>
    </div>
  );
}

export default AdminSidebar;



==================================================
FILE: components\BottomNav.jsx
==================================================

import React, { useState } from "react";
import { NavLink } from "react-router-dom";
import {
  LayoutGrid,
  Folder,
  Plus,
  LayoutTemplate,
  Settings,
  FilePlus,
  Users,
} from "lucide-react";
import "../styles/BottomNav.css";

function BottomNav() {
  const [showCreateOptions, setShowCreateOptions] = useState(false);

  const toggleCreateOptions = () => {
    setShowCreateOptions(!showCreateOptions);
  };

  // Close modal when navigating
  const handleNavClick = () => {
    setShowCreateOptions(false);
  };

  return (
    <>
      <nav className="bottom-nav">
        <NavLink to="/dashboard" className="bottom-nav-link" end>
          <LayoutGrid size={24} />
          <span>Dashboard</span>
        </NavLink>
        <NavLink to="/dashboard/groups" className="bottom-nav-link">
          <Folder size={24} />
          <span>Groups</span>
        </NavLink>

        {/* This is now a button to toggle the modal */}
        <div className="bottom-nav-create-btn" onClick={toggleCreateOptions}>
          <Plus size={32} />
        </div>

        <NavLink to="/dashboard/templates" className="bottom-nav-link">
          <LayoutTemplate size={24} />
          <span>Templates</span>
        </NavLink>
        <NavLink to="/dashboard/settings" className="bottom-nav-link">
          <Settings size={24} />
          <span>Settings</span>
        </NavLink>
      </nav>

      {/* Create Options Modal */}
      {showCreateOptions && (
        <>
          <div
            className="create-options-overlay"
            onClick={toggleCreateOptions}
          ></div>
          <div className="create-options-modal">
            <NavLink
              to="/dashboard/bulk-create"
              className="create-option-link"
              onClick={handleNavClick}
            >
              <Users size={22} className="create-option-icon" />
              <div className="create-option-text">
                <strong>Bulk Create</strong>
                <small>Upload a CSV file</small>
              </div>
            </NavLink>
            <NavLink
              to="/dashboard/create"
              className="create-option-link"
              onClick={handleNavClick}
            >
              <FilePlus size={22} className="create-option-icon" />
              <div className="create-option-text">
                <strong>Single Create</strong>
                <small>Generate one certificate</small>
              </div>
            </NavLink>
          </div>
        </>
      )}
    </>
  );
}

export default BottomNav;



==================================================
FILE: components\CodeBlock.jsx
==================================================

import React, { useState } from "react";
import { Copy, Check } from "lucide-react";
import toast from "react-hot-toast";

const CodeBlock = ({ children, language }) => {
  const [isCopied, setIsCopied] = useState(false);

  const handleCopy = () => {
    navigator.clipboard.writeText(children);
    setIsCopied(true);
    toast.success("Copied to clipboard!");
    setTimeout(() => {
      setIsCopied(false);
    }, 2000);
  };

  return (
    <div className="code-block-container">
      {language && <span className="code-block-language">{language}</span>}
      <button onClick={handleCopy} className="code-block-copy-button">
        {isCopied ? <Check size={16} /> : <Copy size={16} />}
      </button>
      <pre>
        <code>{children}</code>
      </pre>
    </div>
  );
};

export default CodeBlock;



==================================================
FILE: components\CustomTemplateEditor.jsx
==================================================

import React, { useRef, useEffect, useState, useCallback } from "react";
import {
  Stage,
  Layer,
  Image,
  Text,
  Transformer,
  Group,
  Rect,
  Line,
} from "react-konva";
import useImage from "use-image";

// --- Sub-components ---

const DraggableText = ({
  shapeProps,
  isSelected,
  onSelect,
  onChange,
  onDragMove,
  onDragEnd,
}) => {
  const shapeRef = useRef();
  const trRef = useRef();

  useEffect(() => {
    if (isSelected) {
      trRef.current.nodes([shapeRef.current]);
      trRef.current.getLayer().batchDraw();
    }
  }, [isSelected]);

  return (
    <>
      <Text
        onClick={onSelect}
        onTap={onSelect}
        ref={shapeRef}
        {...shapeProps}
        draggable
        onDragMove={(e) => onDragMove(e)}
        onDragEnd={(e) => {
          onDragEnd();
          onChange({
            ...shapeProps,
            x: e.target.x(),
            y: e.target.y(),
          });
        }}
        onTransformEnd={() => {
          const node = shapeRef.current;
          const scaleX = node.scaleX();
          const scaleY = node.scaleY();
          node.scaleX(1);
          node.scaleY(1);
          onChange({
            ...shapeProps,
            x: node.x(),
            y: node.y(),
            width: Math.max(5, node.width() * scaleX),
            height: Math.max(5, node.height() * scaleY),
            rotation: node.rotation(),
          });
        }}
      />
      {isSelected && (
        <Transformer
          ref={trRef}
          keepRatio={false}
          boundBoxFunc={(oldBox, newBox) => {
            if (newBox.width < 5 || newBox.height < 5) {
              return oldBox;
            }
            return newBox;
          }}
        />
      )}
    </>
  );
};

const DraggableQR = ({
  shapeProps,
  isSelected,
  onSelect,
  onChange,
  onDragMove,
  onDragEnd,
}) => {
  const groupRef = useRef();
  const trRef = useRef();

  useEffect(() => {
    if (isSelected) {
      trRef.current.nodes([groupRef.current]);
      trRef.current.getLayer().batchDraw();
    }
  }, [isSelected]);

  return (
    <>
      <Group
        onClick={onSelect}
        onTap={onSelect}
        ref={groupRef}
        x={shapeProps.x}
        y={shapeProps.y}
        rotation={shapeProps.rotation}
        draggable
        onDragMove={(e) => onDragMove(e)}
        onDragEnd={(e) => {
          onDragEnd();
          onChange({
            ...shapeProps,
            x: e.target.x(),
            y: e.target.y(),
          });
        }}
        onTransformEnd={() => {
          const node = groupRef.current;
          const scaleX = node.scaleX();
          const scaleY = node.scaleY();
          node.scaleX(1);
          node.scaleY(1);
          onChange({
            ...shapeProps,
            x: node.x(),
            y: node.y(),
            width: Math.max(5, shapeProps.width * scaleX),
            height: Math.max(5, shapeProps.height * scaleY),
            rotation: node.rotation(),
          });
        }}
      >
        <Rect
          width={shapeProps.width}
          height={shapeProps.height}
          fill="white"
          stroke="black"
          strokeWidth={1}
          cornerRadius={2}
        />
        <Text
          text="QR Code"
          width={shapeProps.width}
          height={shapeProps.height}
          align="center"
          verticalAlign="middle"
          fontSize={12}
          fill="black"
          listening={false}
        />
      </Group>
      {isSelected && (
        <Transformer
          ref={trRef}
          keepRatio={true}
          boundBoxFunc={(oldBox, newBox) => {
            if (newBox.width < 5 || newBox.height < 5) {
              return oldBox;
            }
            return newBox;
          }}
        />
      )}
    </>
  );
};

// --- Main Editor Component ---

const CustomTemplateEditor = ({
  stageRef,
  backgroundImageUrl,
  elements,
  setElements,
  selectedId,
  setSelectedId,
  canvasSize,
  showGrid = true,
}) => {
  const [image] = useImage(backgroundImageUrl, "anonymous");
  const [guides, setGuides] = useState([]);

  // --- Keyboard Precision Control ---
  useEffect(() => {
    const handleKeyDown = (e) => {
      if (!selectedId) return;

      const MOVE_STEP = e.shiftKey ? 10 : 1; // Shift + Arrow = 10px, else 1px
      let dx = 0;
      let dy = 0;

      if (e.key === "ArrowUp") dy = -MOVE_STEP;
      else if (e.key === "ArrowDown") dy = MOVE_STEP;
      else if (e.key === "ArrowLeft") dx = -MOVE_STEP;
      else if (e.key === "ArrowRight") dx = MOVE_STEP;
      else return;

      e.preventDefault();

      setElements((prevElements) =>
        prevElements.map((el) => {
          if (el.id === selectedId) {
            return { ...el, x: el.x + dx, y: el.y + dy };
          }
          return el;
        })
      );
    };

    window.addEventListener("keydown", handleKeyDown);
    return () => window.removeEventListener("keydown", handleKeyDown);
  }, [selectedId, setElements]);

  // --- Snapping Logic ---
  const getLineGuideStops = (skipShape) => {
    const vertical = [0, canvasSize.width / 2, canvasSize.width];
    const horizontal = [0, canvasSize.height / 2, canvasSize.height];

    // Optional: Add snapping to other elements
    elements.forEach((guideItem) => {
      if (guideItem.id === skipShape.id()) return;
      // Center snapping only to keep it clean
      vertical.push(guideItem.x + guideItem.width / 2);
      horizontal.push(guideItem.y + guideItem.height / 2);
    });

    return { vertical, horizontal };
  };

  const getObjectSnappingEdges = (node) => {
    const box = node.getClientRect({ relativeTo: stageRef.current });
    const absPos = node.absolutePosition();

    return {
      vertical: [
        {
          guide: Math.round(box.x),
          offset: Math.round(absPos.x - box.x),
          snap: "start",
        },
        {
          guide: Math.round(box.x + box.width / 2),
          offset: Math.round(absPos.x - box.x - box.width / 2),
          snap: "center",
        },
        {
          guide: Math.round(box.x + box.width),
          offset: Math.round(absPos.x - box.x - box.width),
          snap: "end",
        },
      ],
      horizontal: [
        {
          guide: Math.round(box.y),
          offset: Math.round(absPos.y - box.y),
          snap: "start",
        },
        {
          guide: Math.round(box.y + box.height / 2),
          offset: Math.round(absPos.y - box.y - box.height / 2),
          snap: "center",
        },
        {
          guide: Math.round(box.y + box.height),
          offset: Math.round(absPos.y - box.y - box.height),
          snap: "end",
        },
      ],
    };
  };

  const getGuides = (lineGuideStops, itemBounds) => {
    const resultV = [];
    const resultH = [];
    const GUIDELINE_OFFSET = 5;

    lineGuideStops.vertical.forEach((lineGuide) => {
      itemBounds.vertical.forEach((itemBound) => {
        const diff = Math.abs(lineGuide - itemBound.guide);
        if (diff < GUIDELINE_OFFSET) {
          resultV.push({
            lineGuide,
            diff,
            snap: itemBound.snap,
            offset: itemBound.offset,
          });
        }
      });
    });

    lineGuideStops.horizontal.forEach((lineGuide) => {
      itemBounds.horizontal.forEach((itemBound) => {
        const diff = Math.abs(lineGuide - itemBound.guide);
        if (diff < GUIDELINE_OFFSET) {
          resultH.push({
            lineGuide,
            diff,
            snap: itemBound.snap,
            offset: itemBound.offset,
          });
        }
      });
    });

    const minV = resultV.sort((a, b) => a.diff - b.diff)[0];
    const minH = resultH.sort((a, b) => a.diff - b.diff)[0];
    const guides = [];
    if (minV)
      guides.push({
        lineGuide: minV.lineGuide,
        offset: minV.offset,
        orientation: "V",
        snap: minV.snap,
      });
    if (minH)
      guides.push({
        lineGuide: minH.lineGuide,
        offset: minH.offset,
        orientation: "H",
        snap: minH.snap,
      });
    return guides;
  };

  const handleDragMove = (e) => {
    const layer = e.target.getLayer();
    setGuides([]); // Clear previous guides

    const lineGuideStops = getLineGuideStops(e.target);
    const itemBounds = getObjectSnappingEdges(e.target);
    const guides = getGuides(lineGuideStops, itemBounds);

    if (!guides.length) return;

    // Draw Guides
    setGuides(guides);

    // Force Snap
    const absPos = e.target.absolutePosition();
    guides.forEach((lg) => {
      if (lg.orientation === "V") {
        absPos.x = lg.lineGuide + lg.offset;
      } else if (lg.orientation === "H") {
        absPos.y = lg.lineGuide + lg.offset;
      }
    });
    e.target.absolutePosition(absPos);
  };

  const handleDragEnd = () => {
    setGuides([]);
  };

  const checkDeselect = (e) => {
    const clickedOnEmpty =
      e.target === e.target.getStage() || e.target.getClassName() === "Image";
    if (clickedOnEmpty) {
      setSelectedId(null);
    }
  };

  // Grid lines
  const gridSize = 50;
  const gridLines = [];
  if (showGrid) {
    for (let i = 0; i < canvasSize.width / gridSize; i++) {
      gridLines.push(
        <Line
          key={`v${i}`}
          points={[i * gridSize, 0, i * gridSize, canvasSize.height]}
          stroke="#ddd"
          strokeWidth={1}
          dash={[4, 4]}
        />
      );
    }
    for (let j = 0; j < canvasSize.height / gridSize; j++) {
      gridLines.push(
        <Line
          key={`h${j}`}
          points={[0, j * gridSize, canvasSize.width, j * gridSize]}
          stroke="#ddd"
          strokeWidth={1}
          dash={[4, 4]}
        />
      );
    }
  }

  return (
    <div
      style={{
        width: canvasSize.width,
        height: canvasSize.height,
        boxShadow: "0 0 20px rgba(0,0,0,0.1)",
        backgroundColor: "#fff",
      }}
    >
      <Stage
        ref={stageRef}
        width={canvasSize.width}
        height={canvasSize.height}
        onMouseDown={checkDeselect}
        onTouchStart={checkDeselect}
      >
        <Layer>
          {showGrid && gridLines}

          <Image
            image={image}
            width={canvasSize.width}
            height={canvasSize.height}
            listening={false} // Allow clicking through image to deselect
          />

          {elements.map((el) => {
            const props = {
              key: el.id,
              shapeProps: el,
              isSelected: el.id === selectedId,
              onSelect: () => setSelectedId(el.id),
              onChange: (newAttrs) => {
                const updatedElements = elements.map((elem) => {
                  if (elem.id === el.id) return { ...elem, ...newAttrs };
                  return elem;
                });
                setElements(updatedElements);
              },
              onDragMove: handleDragMove,
              onDragEnd: handleDragEnd,
            };

            return el.isQr ? (
              <DraggableQR {...props} />
            ) : (
              <DraggableText {...props} />
            );
          })}

          {/* Guide Lines */}
          {guides.map((guide, i) => {
            if (guide.orientation === "V") {
              return (
                <Line
                  key={i}
                  points={[
                    guide.lineGuide,
                    0,
                    guide.lineGuide,
                    canvasSize.height,
                  ]}
                  stroke="rgb(0, 161, 255)"
                  strokeWidth={1}
                  dash={[4, 6]}
                />
              );
            } else {
              return (
                <Line
                  key={i}
                  points={[
                    0,
                    guide.lineGuide,
                    canvasSize.width,
                    guide.lineGuide,
                  ]}
                  stroke="rgb(0, 161, 255)"
                  strokeWidth={1}
                  dash={[4, 6]}
                />
              );
            }
          })}
        </Layer>
      </Stage>
    </div>
  );
};

export default CustomTemplateEditor;



==================================================
FILE: components\DashboardNav.jsx
==================================================

import React from "react";
import { Navbar, Nav, Container } from "react-bootstrap";
import { Link, useNavigate } from "react-router-dom";

function DashboardNav() {
  const navigate = useNavigate();

  const handleLogout = () => {
    localStorage.removeItem("token");
    navigate("/login");
  };

  return (
    <Navbar bg="dark" variant="dark" expand="lg" className="mb-4">
      <Container>
        <Navbar.Brand as={Link} to="/dashboard" className="fw-bold">
          <span style={{ color: "#22C55E" }}>Certify</span>
          <span style={{ color: "#2563EB" }}>Me</span>
        </Navbar.Brand>
        <Navbar.Toggle aria-controls="dashboard-nav" />
        <Navbar.Collapse id="dashboard-nav">
          <Nav className="me-auto">
            <Nav.Link as={Link} to="/dashboard" className="mx-2">
              My Certificates
            </Nav.Link>
            <Nav.Link as={Link} to="/dashboard/templates" className="mx-2">
              Templates
            </Nav.Link>
            <Nav.Link as={Link} to="/dashboard/bulk-create" className="mx-2">
              Bulk Create
            </Nav.Link>
            <Nav.Link as={Link} to="/dashboard/settings" className="mx-2">
              Settings
            </Nav.Link>
          </Nav>
          <Nav>
            <Nav.Link onClick={handleLogout}>Logout</Nav.Link>
          </Nav>
        </Navbar.Collapse>
      </Container>
    </Navbar>
  );
}

export default DashboardNav;



==================================================
FILE: components\KonvaPreview.jsx
==================================================

import React, { useEffect, useRef, useState } from "react";
import {
  Stage,
  Layer,
  Image as KonvaImage,
  Text,
  Rect,
  Group,
} from "react-konva";
import useImage from "use-image";
import { SERVER_BASE_URL } from "../config";

const BackgroundImage = ({ src, width, height }) => {
  const [image] = useImage(src, "anonymous");
  return image ? (
    <KonvaImage image={image} width={width} height={height} />
  ) : null;
};

const KonvaPreview = ({ layoutData, dynamicData }) => {
  const containerRef = useRef(null);
  const [dimensions, setDimensions] = useState({ width: 800, height: 566 });

  useEffect(() => {
    const updateDimensions = () => {
      if (containerRef.current) {
        const width = containerRef.current.offsetWidth;
        const height = width / 1.414;
        setDimensions({ width, height });
      }
    };
    updateDimensions();
    window.addEventListener("resize", updateDimensions);
    return () => window.removeEventListener("resize", updateDimensions);
  }, []);

  if (!layoutData) {
    return (
      <div className="flex items-center justify-center h-full bg-gray-100 rounded-lg">
        <p className="text-gray-500">No visual template data available.</p>
      </div>
    );
  }

  const baseWidth = layoutData?.canvas?.width || 842;
  const baseHeight = layoutData?.canvas?.height || 595;
  const scaleX = dimensions.width / baseWidth;
  const scaleY = dimensions.height / baseHeight;

  const backgroundImageSrc = layoutData?.background?.image
    ? layoutData.background.image.startsWith("http")
      ? layoutData.background.image
      : `${SERVER_BASE_URL}${layoutData.background.image}`
    : null;

  const textElements = (layoutData?.elements || []).map((el) => {
    let text = el.text || "";
    if (dynamicData) {
      const recipientName = dynamicData.recipient_name || "Recipient Name";
      const issuerName = dynamicData.issuer_name || "Issuer Name";
      const issueDate = dynamicData.issue_date
        ? new Date(dynamicData.issue_date).toLocaleDateString("en-US", {
            year: "numeric",
            month: "long",
            day: "numeric",
          })
        : "Issue Date";
      const signature = dynamicData.signature || issuerName;
      const courseTitle = dynamicData.course_title || "Course Title";
      const verificationId = dynamicData.verification_id || "pending-id";

      // Receipt specific logic
      let amount = "0.00";
      // Try to parse amount from course title if it contains currency symbols, else default
      if (
        courseTitle &&
        (courseTitle.includes("$") || courseTitle.includes("₦"))
      ) {
        amount = courseTitle.match(/[$₦]\s?[\d,]+(\.\d{2})?/)
          ? courseTitle.match(/[$₦]\s?[\d,]+(\.\d{2})?/)[0]
          : "PAID";
      }

      text = text
        .replace(/{{recipient_name}}/gi, recipientName)
        .replace(/{{issuer_name}}/gi, issuerName)
        .replace(/{{issue_date}}/gi, issueDate)
        .replace(/{{signature}}/gi, signature)
        .replace(/{{course_title}}/gi, courseTitle)
        .replace(/{{verification_id}}/gi, verificationId)
        .replace(/{{amount}}/gi, amount);
    }
    return { ...el, text };
  });

  return (
    <div ref={containerRef} className="w-full h-full">
      <Stage width={dimensions.width} height={dimensions.height}>
        <Layer>
          {backgroundImageSrc && (
            <BackgroundImage
              src={backgroundImageSrc}
              width={dimensions.width}
              height={dimensions.height}
            />
          )}

          {textElements.map((el, index) => {
            if (el.isQr) {
              return (
                <Group
                  key={index}
                  x={el.x * scaleX}
                  y={el.y * scaleY}
                  width={el.width * scaleX}
                  height={el.height * scaleY}
                >
                  <Rect
                    width={el.width * scaleX}
                    height={el.height * scaleY}
                    fill="white"
                  />
                  <Text
                    text="QR"
                    width={el.width * scaleX}
                    height={el.height * scaleY}
                    align="center"
                    verticalAlign="middle"
                    fontSize={12 * scaleX}
                  />
                </Group>
              );
            }
            return (
              <Text
                key={index}
                x={el.x * scaleX}
                y={el.y * scaleY}
                text={el.text}
                fontSize={(el.fontSize || 20) * Math.min(scaleX, scaleY)}
                fontFamily={el.fontFamily || "Arial"}
                fill={el.fill || "#000"}
                align={el.align || "left"}
                rotation={el.rotation || 0}
                width={el.width ? el.width * scaleX : undefined}
                fontStyle={el.fontStyle}
              />
            );
          })}
        </Layer>
      </Stage>
    </div>
  );
};

export default KonvaPreview;



==================================================
FILE: components\ProtectedRoute.jsx
==================================================

// --- START OF FILE frontend/src/components/ProtectedRoute.jsx ---
import React from "react";
import { Navigate, Outlet } from "react-router-dom";

const ProtectedRoute = () => {
  // Check for the JWT in local storage
  const token = localStorage.getItem("token");

  // If a token exists, render the child routes (the dashboard).
  // The <Outlet /> component is a placeholder for the nested routes.
  // If no token exists, redirect the user to the /login page.
  return token ? <Outlet /> : <Navigate to="/login" replace />;
};

export default ProtectedRoute;
// --- END OF FILE frontend/src/components/ProtectedRoute.jsx ---



==================================================
FILE: components\PublicFooter.jsx
==================================================

import React from "react";
import { Link } from "react-router-dom";
import { Twitter, Linkedin, Github, Globe, ArrowUpRight } from "lucide-react";

const PublicFooter = () => {
  return (
    <footer className="bg-gray-900 text-gray-300 border-t border-gray-800">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-16 pb-8">
        <div className="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-y-12 gap-x-8 mb-16">
          {/* Brand Column */}
          <div className="col-span-2 lg:col-span-2 pr-8">
            <Link to="/" className="flex items-center gap-2 mb-6 no-underline">
              {/* UPDATED LOGO HERE */}
              <img
                src="/images/certbadge.png"
                alt="CertifyMe"
                className="h-8 w-8"
              />
              <span className="font-bold text-2xl text-white tracking-tight">
                CertifyMe
              </span>
            </Link>
            <p className="text-sm text-gray-400 mb-8 max-w-sm leading-relaxed">
              The modern standard for issuing verifiable digital credentials.
              Built for speed, security, and scale.
            </p>
            <div className="flex space-x-4">
              <SocialLink href="#" icon={Twitter} />
              <SocialLink href="#" icon={Linkedin} />
              <SocialLink href="#" icon={Github} />
            </div>
          </div>

          {/* Product */}
          <div>
            <h4 className="font-bold text-gray-900 mb-6 text-white">Product</h4>
            <ul className="space-y-4">
              <FooterLink to="/pricing">Pricing</FooterLink>
              <FooterLink to="/search">Public Ledger</FooterLink>
              <FooterLink to="/verify">Verification Portal</FooterLink>
              <FooterLink to="/docs">API Documentation</FooterLink>
            </ul>
          </div>

          {/* Company */}
          <div>
            <h4 className="font-bold text-gray-900 mb-6 text-white">Company</h4>
            <ul className="space-y-4">
              <FooterLink href="https://www.bolaji.tech/blog" isExternal>
                Blog
              </FooterLink>
              <FooterLink href="https://www.bolaji.tech/" isExternal>
                Founder's Note
              </FooterLink>
              <FooterLink to="/contact">Contact</FooterLink>
              <FooterLink to="#">Careers</FooterLink>
            </ul>
          </div>

          {/* Legal */}
          <div>
            <h4 className="font-bold text-gray-900 mb-6 text-white">Legal</h4>
            <ul className="space-y-4">
              <FooterLink to="#">Privacy Policy</FooterLink>
              <FooterLink to="#">Terms of Service</FooterLink>
              {/* <FooterLink to="">Security</FooterLink> */}
            </ul>
          </div>
        </div>

        <div className="pt-8 border-t border-gray-800 flex flex-col md:flex-row justify-between items-center gap-4">
          <p className="text-sm text-gray-500">
            &copy; {new Date().getFullYear()} CertifyMe Inc. All rights
            reserved.
          </p>
          <div className="flex items-center gap-2 text-sm font-medium text-gray-500">
            <span>Built by</span>
            <a
              href="https://www.bolaji.tech/"
              target="_blank"
              rel="noopener noreferrer"
              className="flex items-center gap-1 text-indigo-400 hover:text-indigo-300 transition-colors"
            >
              Bolaji <Globe size={14} />
            </a>
          </div>
        </div>
      </div>
    </footer>
  );
};

// Helper Components for Cleaner Code
const FooterLink = ({ to, href, children, isExternal }) => {
  const className =
    "text-gray-400 hover:text-white transition-colors text-[15px] font-medium flex items-center gap-1 group no-underline";

  if (isExternal) {
    return (
      <li>
        <a
          href={href}
          target="_blank"
          rel="noopener noreferrer"
          className={className}
        >
          {children}{" "}
          <ArrowUpRight
            size={12}
            className="opacity-0 group-hover:opacity-100 transition-opacity"
          />
        </a>
      </li>
    );
  }
  return (
    <li>
      <Link to={to} className={className}>
        {children}
      </Link>
    </li>
  );
};

const SocialLink = ({ href, icon: Icon }) => (
  <a
    href={href}
    target="_blank"
    rel="noopener noreferrer"
    className="w-10 h-10 rounded-full bg-gray-800 text-gray-400 flex items-center justify-center hover:bg-indigo-600 hover:text-white transition-all"
  >
    <Icon size={18} />
  </a>
);

export default PublicFooter;



==================================================
FILE: components\PublicHeader.jsx
==================================================

import React, { useState, useEffect } from "react";
import { Link, useLocation } from "react-router-dom";
import { Menu, X, ArrowRight, ChevronRight } from "lucide-react";

const PublicHeader = () => {
  const [isMenuOpen, setIsMenuOpen] = useState(false);
  const location = useLocation();

  useEffect(() => {
    setIsMenuOpen(false);
  }, [location]);

  useEffect(() => {
    if (isMenuOpen) {
      document.body.style.overflow = "hidden";
    } else {
      document.body.style.overflow = "unset";
    }
  }, [isMenuOpen]);

  return (
    <>
      <header className="sticky top-0 z-50 bg-white/90 backdrop-blur-xl border-b border-gray-100 transition-all duration-300">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex justify-between items-center h-20">
            <div className="flex-shrink-0 flex items-center z-50">
              <Link
                to="/"
                className="flex items-center gap-2.5 no-underline group"
              >
                <div className="relative">
                  <div className="absolute inset-0 bg-indigo-600 blur-lg opacity-20 group-hover:opacity-40 transition-opacity"></div>
                  <img
                    src="/images/certbadge.png"
                    alt="CertifyMe"
                    className="h-9 w-9 relative"
                  />
                </div>
                <span className="font-bold text-xl text-gray-900 tracking-tight group-hover:text-indigo-600 transition-colors">
                  CertifyMe
                </span>
              </Link>
            </div>

            <nav className="hidden md:flex items-center gap-8">
              <Link
                to="/pricing"
                className="text-[15px] font-medium text-gray-600 hover:text-indigo-600 transition-colors no-underline"
              >
                Pricing
              </Link>
              <Link
                to="/search"
                className="text-[15px] font-medium text-gray-600 hover:text-indigo-600 transition-colors no-underline"
              >
                Public Ledger
              </Link>
              <Link
                to="/docs"
                className="text-[15px] font-medium text-gray-600 hover:text-indigo-600 transition-colors no-underline"
              >
                Developers
              </Link>

              <div className="h-5 w-px bg-gray-200 mx-2"></div>

              <Link
                to="/login"
                className="text-[15px] font-medium text-gray-900 hover:text-indigo-600 transition-colors no-underline"
              >
                Sign In
              </Link>
              <Link
                to="/signup"
                className="group inline-flex items-center justify-center px-5 py-2.5 rounded-full text-[15px] font-bold text-white bg-gray-900 hover:bg-black transition-all shadow-lg hover:shadow-xl no-underline"
              >
                Get Started
                <ArrowRight
                  size={16}
                  className="ml-2 group-hover:translate-x-1 transition-transform"
                />
              </Link>
            </nav>

            <div className="md:hidden z-50">
              <button
                onClick={() => setIsMenuOpen(!isMenuOpen)}
                className="p-2 -mr-2 rounded-full text-gray-500 hover:bg-gray-100 transition-colors focus:outline-none"
              >
                {isMenuOpen ? <X size={28} /> : <Menu size={28} />}
              </button>
            </div>
          </div>
        </div>
      </header>

      <div
        className={`fixed inset-0 bg-white z-40 transition-all duration-500 ease-in-out md:hidden ${
          isMenuOpen
            ? "opacity-100 translate-y-0"
            : "opacity-0 -translate-y-full pointer-events-none"
        }`}
      >
        <div className="flex flex-col h-full pt-28 px-6 pb-8">
          <nav className="flex-1 flex flex-col space-y-2">
            {[
              { label: "Pricing", path: "/pricing" },
              { label: "Public Ledger", path: "/search" },
              { label: "Verification", path: "/verify" },
              { label: "API Documentation", path: "/docs" },
            ].map((item) => (
              <Link
                key={item.path}
                to={item.path}
                className="flex items-center justify-between py-4 text-2xl font-bold text-gray-900 border-b border-gray-100 no-underline group"
              >
                {item.label}
                <ChevronRight className="text-gray-300 group-hover:text-indigo-600 transition-colors" />
              </Link>
            ))}
          </nav>

          <div className="mt-auto space-y-4">
            <Link
              to="/login"
              className="flex items-center justify-center w-full py-4 text-lg font-bold text-gray-900 bg-gray-100 rounded-xl no-underline"
            >
              Log In
            </Link>
            <Link
              to="/signup"
              className="flex items-center justify-center w-full py-4 text-lg font-bold text-white bg-indigo-600 rounded-xl no-underline"
            >
              Create Free Account
            </Link>
          </div>
        </div>
      </div>
    </>
  );
};

export default PublicHeader;



==================================================
FILE: components\Sidebar.jsx
==================================================

// frontend/src/components/Sidebar.jsx

import React from "react";
import { Link, NavLink, useNavigate } from "react-router-dom";
import { useUser } from "../context/UserContext";
import {
  LayoutDashboard,
  FolderOpen,
  FileBadge,
  PlusCircle,
  UploadCloud,
  BarChart2,
  Settings,
  HelpCircle,
  LogOut,
  Crown,
} from "lucide-react";
import { OverlayTrigger, Tooltip } from "react-bootstrap";

function Sidebar() {
  const navigate = useNavigate();
  const { user } = useUser();

  const handleLogout = (e) => {
    e.preventDefault();
    localStorage.removeItem("token");
    navigate("/login");
  };

  const renderTooltip = (props) => (
    <Tooltip id="button-tooltip" {...props}>
      Upgrade to a paid plan to unlock insights!
    </Tooltip>
  );

  const navItemClass = ({ isActive }) =>
    `flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200 font-medium text-sm ${
      isActive
        ? "bg-indigo-50 text-indigo-700"
        : "text-gray-600 hover:bg-gray-50 hover:text-gray-900"
    }`;

  return (
    <aside className="w-64 bg-white border-r border-gray-200 flex flex-col h-screen sticky top-0 left-0 overflow-y-auto">
      {/* --- LOGO HEADER --- */}
      <div className="p-6 border-b border-gray-100">
        <Link to="/dashboard" className="flex items-center gap-3 no-underline">
          <img
            src="/images/certbadge.png"
            alt="CertifyMe"
            className="w-8 h-8 object-contain"
          />
          <span className="text-xl font-bold text-gray-900 tracking-tight">
            CertifyMe
          </span>
        </Link>
      </div>

      {/* --- NAVIGATION LINKS --- */}
      <div className="flex-1 px-4 py-6 space-y-1">
        <NavLink to="/dashboard" end className={navItemClass}>
          <LayoutDashboard size={20} />
          <span>My Certificates</span>
        </NavLink>

        <NavLink to="/dashboard/groups" className={navItemClass}>
          <FolderOpen size={20} />
          <span>Groups</span>
        </NavLink>

        <NavLink to="/dashboard/templates" className={navItemClass}>
          <FileBadge size={20} />
          <span>Templates</span>
        </NavLink>

        <div className="pt-4 pb-2">
          <p className="px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider">
            Actions
          </p>
        </div>

        <NavLink to="/dashboard/create" className={navItemClass}>
          <PlusCircle size={20} />
          <span>Create Single</span>
        </NavLink>

        <NavLink to="/dashboard/bulk-create" className={navItemClass}>
          <UploadCloud size={20} />
          <span>Bulk Create</span>
        </NavLink>

        {user &&
          (user.role === "free" ? (
            <OverlayTrigger
              placement="right"
              delay={{ show: 250, hide: 400 }}
              overlay={renderTooltip}
            >
              <div
                className={`flex items-center gap-3 px-4 py-3 rounded-lg text-gray-400 cursor-not-allowed`}
              >
                <BarChart2 size={20} />
                <span>Analytics</span>
                <span className="ml-auto bg-green-100 text-green-700 text-[10px] font-bold px-2 py-0.5 rounded-full uppercase">
                  Upgrade
                </span>
              </div>
            </OverlayTrigger>
          ) : (
            <NavLink to="/dashboard/analytics" className={navItemClass}>
              <BarChart2 size={20} />
              <span>Analytics</span>
            </NavLink>
          ))}
      </div>

      {/* --- FOOTER SECTION --- */}
      <div className="p-4 border-t border-gray-100 bg-gray-50/50">
        <div className="space-y-1">
          <NavLink to="/dashboard/settings" className={navItemClass}>
            <Settings size={20} />
            <span>Settings</span>
          </NavLink>

          <NavLink to="/dashboard/support" className={navItemClass}>
            <HelpCircle size={20} />
            <span>Support</span>
          </NavLink>

          <button
            onClick={handleLogout}
            className="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-red-600 hover:bg-red-50 hover:text-red-700 transition-colors font-medium text-sm text-left"
          >
            <LogOut size={20} />
            <span>Logout</span>
          </button>
        </div>

        {/* User Mini Profile */}
        {user && (
          <div className="mt-4 pt-4 border-t border-gray-200 flex items-center gap-3 px-2">
            <div className="w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-700 font-bold text-sm">
              {user.name.charAt(0)}
            </div>
            <div className="flex-1 min-w-0">
              <p className="text-sm font-medium text-gray-900 truncate">
                {user.name}
              </p>
              <p className="text-xs text-gray-500 truncate capitalize">
                {user.role} Plan
              </p>
            </div>
            {user.role !== "free" && (
              <Crown
                size={16}
                className="text-yellow-500"
                fill="currentColor"
              />
            )}
          </div>
        )}
      </div>
    </aside>
  );
}

export default Sidebar;



==================================================
FILE: components\TextElementControls.jsx
==================================================

import React from "react";
import {
  Trash2,
  Bold,
  Italic,
  AlignLeft,
  AlignCenter,
  AlignRight,
  AlignVerticalJustifyStart,
  AlignVerticalJustifyCenter,
  AlignVerticalJustifyEnd,
  Check,
} from "lucide-react";

const FONT_FAMILIES = [
  "Arial",
  "Verdana",
  "Times New Roman",
  "Georgia",
  "Courier New",
  "Lucida Console",
  "Impact",
  "Comic Sans MS",
];

const TextElementControls = ({ element, onUpdate, onDelete, onDone }) => {
  const handleStyleToggle = (style) => {
    const currentStyle = element.fontStyle || "normal";
    if (currentStyle.includes(style)) {
      onUpdate({ fontStyle: currentStyle.replace(style, "").trim() });
    } else {
      onUpdate({ fontStyle: `${currentStyle} ${style}`.trim() });
    }
  };

  if (element.isQr) {
    const handleSizeChange = (e) => {
      const val = parseInt(e.target.value, 10);
      onUpdate({ width: val, height: val });
    };

    return (
      <div className="space-y-4 p-4 border rounded-lg bg-white">
        <div className="flex justify-between items-center">
          <h4 className="font-semibold text-gray-800">QR Code Placeholder</h4>
          <div className="flex gap-2">
            <button
              onClick={onDone}
              className="text-green-500 hover:text-green-700 p-1 rounded-full hover:bg-green-100"
            >
              <Check size={18} />
            </button>
            <button
              onClick={onDelete}
              className="text-red-500 hover:text-red-700 p-1 rounded-full hover:bg-red-100"
            >
              <Trash2 size={18} />
            </button>
          </div>
        </div>
        <div>
          <label className="text-sm font-medium text-gray-600">Size (px)</label>
          <input
            type="number"
            value={element.width}
            onChange={handleSizeChange}
            className="w-full mt-1 p-2 border rounded-md"
            min={5}
          />
        </div>
        <p className="text-sm text-gray-500">
          The QR Code will be generated automatically when issuing the
          certificate.
        </p>
      </div>
    );
  }

  return (
    <div className="space-y-4 p-4 border rounded-lg bg-white">
      <div className="flex justify-between items-center">
        <h4 className="font-semibold text-gray-800">Element Properties</h4>
        <div className="flex gap-2">
          <button
            onClick={onDone}
            className="text-green-500 hover:text-green-700 p-1 rounded-full hover:bg-green-100"
          >
            <Check size={18} />
          </button>
          <button
            onClick={onDelete}
            className="text-red-500 hover:text-red-700 p-1 rounded-full hover:bg-red-100"
          >
            <Trash2 size={18} />
          </button>
        </div>
      </div>

      <div>
        <label className="text-sm font-medium text-gray-600">Font Family</label>
        <select
          value={element.fontFamily}
          onChange={(e) => onUpdate({ fontFamily: e.target.value })}
          className="w-full mt-1 p-2 border rounded-md"
        >
          {FONT_FAMILIES.map((font) => (
            <option key={font} value={font}>
              {font}
            </option>
          ))}
        </select>
      </div>

      <div className="grid grid-cols-2 gap-4">
        <div>
          <label className="text-sm font-medium text-gray-600">Size (px)</label>
          <input
            type="number"
            value={element.fontSize}
            onChange={(e) =>
              onUpdate({ fontSize: parseInt(e.target.value, 10) })
            }
            className="w-full mt-1 p-2 border rounded-md"
          />
        </div>
        <div>
          <label className="text-sm font-medium text-gray-600">Color</label>
          <input
            type="color"
            value={element.fill}
            onChange={(e) => onUpdate({ fill: e.target.value })}
            className="w-full mt-1 h-10 p-1 border rounded-md"
          />
        </div>
      </div>

      <div className="grid grid-cols-2 gap-4">
        <div>
          <label className="text-sm font-medium text-gray-600">Style</label>
          <div className="flex mt-1">
            <button
              onClick={() => handleStyleToggle("bold")}
              className={`p-2 border rounded-l-md ${
                element.fontStyle?.includes("bold")
                  ? "bg-blue-500 text-white"
                  : "bg-gray-200"
              }`}
            >
              <Bold size={16} />
            </button>
            <button
              onClick={() => handleStyleToggle("italic")}
              className={`p-2 border-t border-b border-r rounded-r-md ${
                element.fontStyle?.includes("italic")
                  ? "bg-blue-500 text-white"
                  : "bg-gray-200"
              }`}
            >
              <Italic size={16} />
            </button>
          </div>
        </div>
        <div>
          <label className="text-sm font-medium text-gray-600">
            Horizontal Align
          </label>
          <div className="flex mt-1">
            <button
              onClick={() => onUpdate({ align: "left" })}
              className={`p-2 border rounded-l-md ${
                element.align === "left"
                  ? "bg-blue-500 text-white"
                  : "bg-gray-200"
              }`}
            >
              <AlignLeft size={16} />
            </button>
            <button
              onClick={() => onUpdate({ align: "center" })}
              className={`p-2 border-t border-b ${
                element.align === "center"
                  ? "bg-blue-500 text-white"
                  : "bg-gray-200"
              }`}
            >
              <AlignCenter size={16} />
            </button>
            <button
              onClick={() => onUpdate({ align: "right" })}
              className={`p-2 border rounded-r-md ${
                element.align === "right"
                  ? "bg-blue-500 text-white"
                  : "bg-gray-200"
              }`}
            >
              <AlignRight size={16} />
            </button>
          </div>
        </div>
      </div>

      <div className="grid grid-cols-1 gap-4">
        <div>
          <label className="text-sm font-medium text-gray-600">
            Vertical Align
          </label>
          <div className="flex mt-1">
            <button
              onClick={() => onUpdate({ verticalAlign: "top" })}
              className={`p-2 border rounded-l-md ${
                element.verticalAlign === "top"
                  ? "bg-blue-500 text-white"
                  : "bg-gray-200"
              }`}
            >
              <AlignVerticalJustifyStart size={16} />
            </button>
            <button
              onClick={() => onUpdate({ verticalAlign: "middle" })}
              className={`p-2 border-t border-b ${
                element.verticalAlign === "middle"
                  ? "bg-blue-500 text-white"
                  : "bg-gray-200"
              }`}
            >
              <AlignVerticalJustifyCenter size={16} />
            </button>
            <button
              onClick={() => onUpdate({ verticalAlign: "bottom" })}
              className={`p-2 border rounded-r-md ${
                element.verticalAlign === "bottom"
                  ? "bg-blue-500 text-white"
                  : "bg-gray-200"
              }`}
            >
              <AlignVerticalJustifyEnd size={16} />
            </button>
          </div>
        </div>
      </div>
    </div>
  );
};

export default TextElementControls;



==================================================
FILE: context\ThemeContext.jsx
==================================================

import React, { createContext, useState, useEffect, useContext } from "react";

const defaultState = {
  theme: "light",
  setTheme: () => {
    console.error(
      "Error: setTheme was called, but the component is not wrapped in a <ThemeProvider>. Check your App.jsx routing structure."
    );
  },
};

const ThemeContext = createContext(defaultState);

export const useTheme = () => useContext(ThemeContext);

export function ThemeProvider({ children }) {
  const [theme, setTheme] = useState(
    () => localStorage.getItem("theme") || "light"
  );

  useEffect(() => {
    localStorage.setItem("theme", theme);
  }, [theme]);

  return (
    <ThemeContext.Provider value={{ theme, setTheme }}>
      {children}
    </ThemeContext.Provider>
  );
}



==================================================
FILE: context\UserContext.jsx
==================================================

// frontend/src/context/UserContext.jsx

import React, { createContext, useState, useEffect, useContext } from "react";
import { getCurrentUser } from "../api";

const UserContext = createContext(null);

export const UserProvider = ({ children }) => {
  const [user, setUser] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const fetchUser = async () => {
      const token = localStorage.getItem("token");
      if (token) {
        try {
          const res = await getCurrentUser();
          setUser(res.data);
        } catch (error) {
          console.error("Failed to fetch user", error);
          // Handle token expiration if necessary
          if (error.response && error.response.status === 401) {
            localStorage.removeItem("token");
          }
        }
      }
      setLoading(false);
    };

    fetchUser();
  }, []);

  return (
    <UserContext.Provider value={{ user, loading }}>
      {children}
    </UserContext.Provider>
  );
};

export const useUser = () => useContext(UserContext);



==================================================
FILE: data\helpArticles.jsx
==================================================

// frontend/src/data/helpArticles.jsx

import React from "react";
import {
  Rocket,
  UserCircle,
  LayoutTemplate,
  FolderOpen,
  FileBadge,
  CreditCard,
  Search,
  Code2,
} from "lucide-react";

export const helpArticles = [
  {
    slug: "getting-started",
    title: "Getting Started",
    icon: <Rocket size={24} />,
    theme: "text-indigo-600 bg-indigo-50",
    description: "Start off on the right foot! The core workflow from A to Z.",
    content: (
      <>
        <h2 className="text-xl font-bold mb-4">The Core CertifyMe Workflow</h2>
        <p className="mb-4">
          CertifyMe is built around a simple and powerful four-step process:
        </p>
        <ol className="list-decimal pl-5 space-y-2 mb-6">
          <li>
            <strong>Create a Template:</strong> Design a reusable certificate
            layout. You can use our form-based editor or upload your own visual
            design.
          </li>
          <li>
            <strong>Create a Group:</strong> Organize certificates by batch,
            cohort, or event (e.g., “October 2024 Python Cohort"). Groups are
            essential for bulk actions.
          </li>
          <li>
            <strong>Add Recipients:</strong> Create certificates individually,
            or upload a{" "}
            <code className="bg-gray-100 px-1 rounded">CSV/Excel</code> file for
            bulk issuance.
          </li>
          <li>
            <strong>Deliver & Verify:</strong> Download certificates as PDFs,
            send them via email, or share unique verification links.
          </li>
        </ol>
      </>
    ),
  },
  {
    slug: "account-management",
    title: "Account Management",
    icon: <UserCircle size={24} />,
    theme: "text-green-600 bg-green-50",
    description: "Signing up, logging in, and managing your account type.",
    content: (
      <>
        <h2 className="text-xl font-bold mb-4">Signing Up & Logging In</h2>
        <ul className="list-disc pl-5 space-y-2 mb-6">
          <li>
            <strong>Sign Up:</strong> Choose either an{" "}
            <strong>Individual</strong> or <strong>Company</strong> account.
          </li>
          <li>
            <strong>Log In:</strong> Use your registered email and password to
            access your dashboard.
          </li>
        </ul>
        <h2 className="text-xl font-bold mb-4">Resetting Your Password</h2>
        <p className="mb-2">If you forget your password:</p>
        <ol className="list-decimal pl-5 space-y-2 mb-6">
          <li>
            Click <strong>Forgot Password?</strong> on the login page.
          </li>
          <li>Enter your registered email address.</li>
          <li>You'll receive a secure reset link (valid for 15 minutes).</li>
        </ol>
      </>
    ),
  },
  {
    slug: "managing-templates",
    title: "Managing Templates",
    icon: <LayoutTemplate size={24} />,
    theme: "text-blue-600 bg-blue-50",
    description: "Design beautiful, reusable templates for your certificates.",
    content: (
      <>
        <h2 className="text-xl font-bold mb-4">
          Creating a Form-Based Template
        </h2>
        <p className="mb-2">
          This is the easiest way to design professional certificates quickly.
        </p>
        <ol className="list-decimal pl-5 space-y-2 mb-6">
          <li>
            Go to <strong>Templates → Create Form-Based Template</strong>.
          </li>
          <li>Fill in the fields like Template Name, Title, and Colors.</li>
          <li>Watch the Live Preview update in real time.</li>
          <li>
            Click <strong>Create Template</strong> when done.
          </li>
        </ol>

        <h2 className="text-xl font-bold mb-4">
          Creating a Visual (Custom) Template
        </h2>
        <p className="mb-2">
          Use this when you already have a designed certificate image (JPG or
          PNG).
        </p>
        <ol className="list-decimal pl-5 space-y-2 mb-6">
          <li>
            Click <strong>Upload Your Own Template</strong> on the Templates
            page.
          </li>
          <li>
            <strong>Add Placeholders:</strong> Drag placeholders like{" "}
            <code className="bg-gray-100 px-1 rounded">{`{{recipient_name}}`}</code>{" "}
            onto the design canvas.
          </li>
          <li>
            <strong>Style & Position:</strong> Adjust font size, alignment,
            color, and rotation.
          </li>
          <li>
            Click <strong>Save Template</strong>.
          </li>
        </ol>
      </>
    ),
  },
  {
    slug: "managing-groups",
    title: "Managing Groups",
    icon: <FolderOpen size={24} />,
    theme: "text-yellow-600 bg-yellow-50",
    description: "Organize certificates by project, event, or cohort.",
    content: (
      <>
        <h2 className="text-xl font-bold mb-4">What Are Groups?</h2>
        <p className="mb-4">
          Groups help you organize certificates and are required for bulk
          actions. Examples include "2024 Web Dev Cohort" or "Annual Sales
          Conference".
        </p>
        <h2 className="text-xl font-bold mb-4">Creating and Using Groups</h2>
        <ol className="list-decimal pl-5 space-y-2 mb-6">
          <li>
            Go to the <strong>Groups</strong> page.
          </li>
          <li>
            Click <strong>Create New Group</strong> and give it a name.
          </li>
          <li>
            Inside a group, you can download all certificates as a single{" "}
            <code className="bg-gray-100 px-1 rounded">ZIP</code> file or send
            all unsent emails.
          </li>
        </ol>
      </>
    ),
  },
  {
    slug: "issuing-certificates",
    title: "Issuing Certificates",
    icon: <FileBadge size={24} />,
    theme: "text-red-600 bg-red-50",
    description: "Learn how to create single or bulk certificates with ease.",
    content: (
      <>
        <h2 className="text-xl font-bold mb-4">
          Creating a Single Certificate
        </h2>
        <ol className="list-decimal pl-5 space-y-2 mb-6">
          <li>
            Go to <strong>My Certificates → New</strong>.
          </li>
          <li>Choose a template and fill in the recipient's details.</li>
          <li>
            Click <strong>Publish</strong>. If an email is provided, it's
            automatically sent.
          </li>
        </ol>

        <h2 className="text-xl font-bold mb-4">
          Creating Certificates in Bulk (CSV/Excel Upload)
        </h2>
        <ol className="list-decimal pl-5 space-y-2 mb-6">
          <li>
            Go to <strong>My Certificates → Bulk Create</strong>.
          </li>
          <li>Select a template and assign a group.</li>
          <li>
            Upload your file (
            <code className="bg-gray-100 px-1 rounded">.csv</code>,{" "}
            <code className="bg-gray-100 px-1 rounded">.xlsx</code>,{" "}
            <code className="bg-gray-100 px-1 rounded">.xls</code>).
          </li>
          <li>
            Required columns are:{" "}
            <code className="bg-gray-100 px-1 rounded">recipient_name</code>,{" "}
            <code className="bg-gray-100 px-1 rounded">course_title</code>,{" "}
            <code className="bg-gray-100 px-1 rounded">issue_date</code>.
          </li>
          <li>
            Click <strong>Create Certificates</strong>. The system processes all
            valid rows and reports any errors.
          </li>
        </ol>
      </>
    ),
  },
  {
    slug: "billing-and-plans",
    title: "Billing & Plans",
    icon: <CreditCard size={24} />,
    theme: "text-purple-600 bg-purple-50",
    description: "Understand our credit system and how to upgrade your plan.",
    content: (
      <>
        <h2 className="text-xl font-bold mb-4">
          How Our Credit-Based Model Works
        </h2>
        <p className="mb-4">
          CertifyMe uses a credit-based model. Each issued certificate consumes
          one credit from your account quota.
        </p>
        <h2 className="text-xl font-bold mb-4">Upgrading Your Plan</h2>
        <ol className="list-decimal pl-5 space-y-2 mb-6">
          <li>
            Go to <strong>Settings → Billing</strong>.
          </li>
          <li>
            Choose a plan: <strong>Starter</strong>, <strong>Growth</strong>,{" "}
            <strong>Pro</strong>, or <strong>Enterprise</strong>.
          </li>
          <li>
            Click <strong>Upgrade</strong> to pay securely via Paystack.
          </li>
          <li>Your quota updates instantly upon successful payment.</li>
        </ol>
      </>
    ),
  },
  {
    slug: "public-verification",
    title: "Public Verification",
    icon: <Search size={24} />,
    theme: "text-gray-600 bg-gray-100",
    description: "How certificate verification works on the Open Ledger.",
    content: (
      <>
        <h2 className="text-xl font-bold mb-4">How Verification Works</h2>
        <p className="mb-4">
          Every certificate has a unique <strong>Verification ID</strong> and a
          scannable <strong>QR code</strong> for instant verification.
        </p>
        <h2 className="text-xl font-bold mb-4">
          The Open Ledger (Advanced Search)
        </h2>
        <p className="mb-6">
          Accessible via the <strong>Search</strong> link on our homepage, the
          Open Ledger allows anyone to look up a certificate's details, ensuring
          transparency and trust.
        </p>
      </>
    ),
  },
  {
    slug: "developer-api",
    title: "Developer API",
    icon: <Code2 size={24} />,
    theme: "text-pink-600 bg-pink-50",
    description:
      "Integrate CertifyMe into your own systems. (Pro & Enterprise)",
    content: (
      <>
        <h2 className="text-xl font-bold mb-4">Generating Your API Key</h2>
        <ol className="list-decimal pl-5 space-y-2 mb-6">
          <li>
            Go to <strong>Settings → Developer</strong>.
          </li>
          <li>
            Click <strong>Generate API Key</strong>.
          </li>
          <li>
            <strong>Important:</strong> Copy and store your key securely. It is
            only shown once.
          </li>
          <li>
            Use this key in the{" "}
            <code className="bg-gray-100 px-1 rounded">X-API-Key</code> header
            of your REST API requests.
          </li>
        </ol>
        <p className="mb-6">
          For detailed implementation, refer to the official{" "}
          <strong>CertifyMe API Documentation</strong>.
        </p>
      </>
    ),
  },
];



==================================================
FILE: hooks\useSupportStatus.js
==================================================

// frontend/src/hooks/useSupportStatus.js

import { useState, useEffect } from "react";

/**
 * A custom hook to determine if support is currently online.
 * Support hours are Monday - Friday, 9 AM to 5 PM WAT (UTC+1).
 * This corresponds to 8 AM to 4 PM (16:00) in UTC.
 */
export function useSupportStatus() {
  const [isOnline, setIsOnline] = useState(false);

  useEffect(() => {
    const checkStatus = () => {
      const now = new Date();
      const currentUTCDay = now.getUTCDay(); // Sunday = 0, Monday = 1, etc.
      const currentUTCHour = now.getUTCHours();

      // Check if it's a weekday (Monday to Friday)
      const isWeekday = currentUTCDay >= 1 && currentUTCDay <= 5;

      // Check if the time is within 8:00 AM UTC and 15:59 PM UTC
      const isWithinHours = currentUTCHour >= 8 && currentUTCHour < 16;

      if (isWeekday && isWithinHours) {
        setIsOnline(true);
      } else {
        setIsOnline(false);
      }
    };

    // Check status immediately on component mount
    checkStatus();

    // Set an interval to re-check every 60 seconds
    const intervalId = setInterval(checkStatus, 60000);

    // Cleanup function to clear the interval when the component unmounts
    return () => clearInterval(intervalId);
  }, []); // Empty dependency array ensures this effect runs only once on mount

  return { isOnline };
}



==================================================
FILE: hooks\useWindowSize.js
==================================================

import { useState, useEffect } from "react";

// Hook to get window dimensions
function useWindowSize() {
  const [windowSize, setWindowSize] = useState({
    width: undefined,
    height: undefined,
  });

  useEffect(() => {
    function handleResize() {
      setWindowSize({
        width: window.innerWidth,
        height: window.innerHeight,
      });
    }

    window.addEventListener("resize", handleResize);
    handleResize(); // Call handler right away so state gets updated with initial window size

    return () => window.removeEventListener("resize", handleResize);
  }, []); // Empty array ensures that effect is only run on mount and unmount

  return windowSize;
}

export default useWindowSize;


==================================================
FILE: layouts\AdminLayout.jsx
==================================================

import React from "react";
import { Outlet } from "react-router-dom";
import AdminSidebar from "../components/AdminSidebar";
import "../styles/Admin.css"; // Ensure this exists for styling

function AdminLayout() {
  return (
    <div className="dashboard-layout d-flex">
      <AdminSidebar />
      <main
        className="main-content flex-grow-1 p-4"
        style={{ backgroundColor: "#f8f9fa" }}
      >
        <div className="workspace container-fluid">
          <Outlet />
        </div>
      </main>
    </div>
  );
}

export default AdminLayout;



==================================================
FILE: layouts\DashboardLayout.jsx
==================================================

import React from "react";
import { Outlet } from "react-router-dom";
import Sidebar from "../components/Sidebar";
import BottomNav from "../components/BottomNav";
import useWindowSize from "../hooks/useWindowSize";
import { UserProvider } from "../context/UserContext";

function DashboardLayout() {
  const { width } = useWindowSize();
  const isMobile = width <= 768;

  return (
    <UserProvider>
      <div className="flex h-screen bg-gray-50 overflow-hidden">
        {/* 
          DESKTOP SIDEBAR 
          flex-shrink-0 prevents it from being squashed.
          The width is defined inside the Sidebar component itself (w-64).
        */}
        {!isMobile && (
          <div className="flex-shrink-0 h-full">
            <Sidebar />
          </div>
        )}

        {/* 
          MAIN CONTENT AREA
          flex-1: Takes up all remaining space.
          min-w-0: Prevents flexbox overflow issues.
          flex-col: Stacks content vertically.
        */}
        <div className="flex-1 flex flex-col min-w-0 overflow-hidden">
          {/* 
            SCROLLABLE REGION
            overflow-y-auto: Only this part scrolls, keeping sidebar fixed.
            relative: For positioning modals/toasts relative to view.
          */}
          <main className="flex-1 overflow-y-auto focus:outline-none scroll-smooth relative">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 md:px-8 py-8 pb-24 md:pb-8">
              <Outlet />
            </div>
          </main>
        </div>

        {/* MOBILE BOTTOM NAVIGATION */}
        {isMobile && <BottomNav />}
      </div>
    </UserProvider>
  );
}

export default DashboardLayout;



==================================================
FILE: pages\AdminAnalyticsPage.jsx
==================================================

import React, { useState, useEffect } from "react";
import {
  Card,
  Row,
  Col,
  Spinner,
  Alert,
  ButtonGroup,
  Button,
} from "react-bootstrap";
import { Line, Bar, Doughnut } from "react-chartjs-2";
import {
  Chart as ChartJS,
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
  BarElement,
  ArcElement,
  Title,
  Tooltip,
  Legend,
} from "chart.js";
import { getAdminAnalytics } from "../api";

ChartJS.register(
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
  BarElement,
  ArcElement,
  Title,
  Tooltip,
  Legend
);

// Helper to format numbers with commas
const formatNumber = (num) =>
  num ? num.toLocaleString(undefined, { maximumFractionDigits: 2 }) : "0";

function AdminAnalyticsPage() {
  const [analytics, setAnalytics] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState("");
  const [period, setPeriod] = useState("1y"); // '30d', '90d', '1y', 'all'

  useEffect(() => {
    fetchAnalytics();
  }, [period]);

  const fetchAnalytics = async () => {
    setLoading(true);
    try {
      const res = await getAdminAnalytics(period);
      setAnalytics(res.data);
    } catch (err) {
      setError("Failed to fetch analytics");
    } finally {
      setLoading(false);
    }
  };

  const getChartOptions = (text) => ({
    responsive: true,
    plugins: {
      legend: { position: "top" },
      title: { display: true, text },
    },
  });

  const generateChartData = (label, data, color) => ({
    labels: data?.map((g) => `${g.month}/${g.year}`) || [],
    datasets: [
      {
        label: label,
        data: data?.map((g) => g.count || g.total) || [],
        borderColor: color,
        backgroundColor: `${color}80`, // Add transparency
        tension: 0.1,
        fill: true,
      },
    ],
  });

  if (loading) {
    return (
      <div className="text-center p-5">
        <Spinner animation="border" /> Loading Analytics...
      </div>
    );
  }
  if (error) return <Alert variant="danger">{error}</Alert>;
  if (!analytics) return <Alert variant="info">No analytics data found.</Alert>;

  const { kpi_stats } = analytics;

  return (
    <div>
      <h2 className="fw-bold mb-4">Analytics & Insights</h2>

      {/* --- KPI Cards Section --- */}
      <Row className="mb-4">
        <Col md={3}>
          <Card className="shadow-sm border-0 text-center h-100">
            <Card.Body>
              <h3 className="fw-bold text-primary">
                {formatNumber(kpi_stats.total_users)}
              </h3>
              <p className="text-muted mb-0">Total Users</p>
            </Card.Body>
          </Card>
        </Col>
        <Col md={3}>
          <Card className="shadow-sm border-0 text-center h-100">
            <Card.Body>
              <h3 className="fw-bold text-success">
                ${formatNumber(kpi_stats.total_revenue)}
              </h3>
              <p className="text-muted mb-0">Total Revenue (USD)</p>
            </Card.Body>
          </Card>
        </Col>
        <Col md={3}>
          <Card className="shadow-sm border-0 text-center h-100">
            <Card.Body>
              <h3 className="fw-bold text-info">
                {formatNumber(kpi_stats.total_certificates)}
              </h3>
              <p className="text-muted mb-0">Total Certificates</p>
            </Card.Body>
          </Card>
        </Col>
        <Col md={3}>
          <Card className="shadow-sm border-0 text-center h-100">
            <Card.Body>
              <h3 className="fw-bold text-warning">
                {formatNumber(kpi_stats.avg_certs_per_user)}
              </h3>
              <p className="text-muted mb-0">Avg. Certs Per User</p>
            </Card.Body>
          </Card>
        </Col>
      </Row>

      {/* --- Period Filter --- */}
      <div className="d-flex justify-content-end mb-3">
        <ButtonGroup>
          <Button
            variant={period === "30d" ? "primary" : "outline-primary"}
            onClick={() => setPeriod("30d")}
          >
            30 Days
          </Button>
          <Button
            variant={period === "90d" ? "primary" : "outline-primary"}
            onClick={() => setPeriod("90d")}
          >
            90 Days
          </Button>
          <Button
            variant={period === "1y" ? "primary" : "outline-primary"}
            onClick={() => setPeriod("1y")}
          >
            1 Year
          </Button>
          <Button
            variant={period === "all" ? "primary" : "outline-primary"}
            onClick={() => setPeriod("all")}
          >
            All Time
          </Button>
        </ButtonGroup>
      </div>

      {/* --- Growth Charts Section --- */}
      <Row>
        <Col lg={12} className="mb-4">
          <Card className="shadow-sm border-0">
            <Card.Body>
              <Line
                options={getChartOptions("Revenue Growth (USD)")}
                data={generateChartData(
                  "Revenue",
                  analytics.revenue_growth,
                  "rgb(40, 167, 69)"
                )}
              />
            </Card.Body>
          </Card>
        </Col>
        <Col lg={6} className="mb-4">
          <Card className="shadow-sm border-0">
            <Card.Body>
              <Line
                options={getChartOptions("New User Signups")}
                data={generateChartData(
                  "Users",
                  analytics.user_growth,
                  "rgb(75, 192, 192)"
                )}
              />
            </Card.Body>
          </Card>
        </Col>
        <Col lg={6} className="mb-4">
          <Card className="shadow-sm border-0">
            <Card.Body>
              <Line
                options={getChartOptions("Certificates Issued")}
                data={generateChartData(
                  "Certificates",
                  analytics.cert_growth,
                  "rgb(255, 159, 64)"
                )}
              />
            </Card.Body>
          </Card>
        </Col>
      </Row>

      {/* --- Distribution & Top Users Section --- */}
      <Row>
        <Col md={5}>
          <Card className="shadow-sm border-0 mb-4">
            <Card.Body>
              <Doughnut
                options={getChartOptions("Plan Distribution")}
                data={{
                  labels:
                    analytics.plan_distribution?.map((p) =>
                      p.role.toUpperCase()
                    ) || [],
                  datasets: [
                    {
                      label: "Users",
                      data:
                        analytics.plan_distribution?.map((p) => p.count) || [],
                      backgroundColor: [
                        "#FF6384",
                        "#36A2EB",
                        "#FFCE56",
                        "#4BC0C0",
                        "#9966FF",
                      ],
                    },
                  ],
                }}
              />
            </Card.Body>
          </Card>
        </Col>
        <Col md={7}>
          <Card className="shadow-sm border-0">
            <Card.Body>
              <Bar
                options={getChartOptions("Top 5 Users by Certificates Issued")}
                data={{
                  labels: analytics.top_users?.map((u) => u.name) || [],
                  datasets: [
                    {
                      label: "Certificates",
                      data: analytics.top_users?.map((u) => u.cert_count) || [],
                      backgroundColor: "#36A2EB",
                    },
                  ],
                }}
              />
            </Card.Body>
          </Card>
        </Col>
      </Row>
    </div>
  );
}

export default AdminAnalyticsPage;



==================================================
FILE: pages\AdminCertificatesPage.jsx
==================================================

import React, { useState, useEffect } from "react";
import {
  Card,
  Table,
  Badge,
  Button,
  Row,
  Col,
  Spinner,
  Alert,
  Form,
  InputGroup,
  ListGroup,
} from "react-bootstrap";
import { Search } from "react-bootstrap-icons";
import {
  getAdminCertificatesOverview,
  getAdminCertificates,
  revokeAdminCertificate,
} from "../api";

function AdminCertificatesPage() {
  // State for overview data
  const [overview, setOverview] = useState({
    total: 0,
    by_user: [],
    by_template: [],
  });

  // State for the new detailed certificate list
  const [certificates, setCertificates] = useState([]);
  const [totalPages, setTotalPages] = useState(1);
  const [currentPage, setCurrentPage] = useState(1);

  // Loading and error states
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState("");
  const [listLoading, setListLoading] = useState(false);

  // State for new filter controls
  const [search, setSearch] = useState("");
  const [statusFilter, setStatusFilter] = useState("");
  const [dateFilter, setDateFilter] = useState({
    start_date: "",
    end_date: "",
  });

  // Fetch overview stats on initial load
  useEffect(() => {
    fetchOverview();
  }, []);

  // Fetch the detailed certificate list whenever page or filters change
  useEffect(() => {
    fetchCertificates();
  }, [currentPage, search, statusFilter, dateFilter]);

  const fetchOverview = async () => {
    setLoading(true);
    try {
      const res = await getAdminCertificatesOverview();
      setOverview(res.data);
    } catch (err) {
      setError(
        "Failed to fetch overview data. The certificate list may still work."
      );
    } finally {
      setLoading(false);
    }
  };

  const fetchCertificates = async () => {
    setListLoading(true);
    try {
      const params = {
        page: currentPage,
        search,
        status: statusFilter,
        start_date: dateFilter.start_date || null,
        end_date: dateFilter.end_date || null,
        limit: 10,
      };
      const filteredParams = Object.fromEntries(
        Object.entries(params).filter(([_, v]) => v != null && v !== "")
      );
      const res = await getAdminCertificates(filteredParams);
      setCertificates(res.data.certificates);
      setTotalPages(res.data.pages);
    } catch (err) {
      setError((prev) => prev + "\nFailed to fetch certificate list.");
    } finally {
      setListLoading(false);
    }
  };

  // Handlers to reset to page 1 when filters change
  const handleFilterChange = (setter) => (e) => {
    setCurrentPage(1);
    setter(e.target.value);
  };

  const handleDateChange = (e) => {
    setCurrentPage(1);
    setDateFilter({ ...dateFilter, [e.target.name]: e.target.value });
  };

  const handleRevoke = async (certId) => {
    if (window.confirm("Are you sure you want to revoke this certificate?")) {
      try {
        await revokeAdminCertificate(certId);
        fetchCertificates(); // Refresh list after revoking
      } catch (err) {
        alert("Failed to revoke certificate.");
      }
    }
  };

  if (loading) {
    return (
      <div className="text-center p-5">
        <Spinner animation="border" />
      </div>
    );
  }

  return (
    <div>
      <h2 className="fw-bold mb-4">Certificates Management</h2>
      {error && !loading && <Alert variant="warning">{error}</Alert>}

      {/* --- Overview Section (UI Improved) --- */}
      <Card className="shadow-sm border-0 mb-4">
        <Card.Body className="text-center">
          <h3>Total Certificates Issued: {overview.total.toLocaleString()}</h3>
        </Card.Body>
      </Card>
      <Row className="mb-4">
        <Col md={6}>
          <Card className="shadow-sm border-0">
            <Card.Body>
              <Card.Title>Top Users by Volume</Card.Title>
              <ListGroup variant="flush">
                {overview.by_user.slice(0, 5).map((u) => (
                  <ListGroup.Item
                    key={u.user_id}
                    className="d-flex justify-content-between align-items-center"
                  >
                    {u.user_name}
                    <Badge bg="primary" pill>
                      {u.count}
                    </Badge>
                  </ListGroup.Item>
                ))}
              </ListGroup>
            </Card.Body>
          </Card>
        </Col>
        <Col md={6}>
          <Card className="shadow-sm border-0">
            <Card.Body>
              <Card.Title>Top Templates Used</Card.Title>
              <ListGroup variant="flush">
                {overview.by_template.slice(0, 5).map((t) => (
                  <ListGroup.Item
                    key={t.template_id}
                    className="d-flex justify-content-between align-items-center"
                  >
                    {t.title}
                    <Badge bg="secondary" pill>
                      {t.count}
                    </Badge>
                  </ListGroup.Item>
                ))}
              </ListGroup>
            </Card.Body>
          </Card>
        </Col>
      </Row>

      {/* --- Detailed Certificate List Section (NEW) --- */}
      <Card className="shadow-sm border-0">
        <Card.Header>
          <h5 className="mb-0">All Certificates</h5>
        </Card.Header>
        <Card.Body>
          <Row className="mb-3 g-3">
            <Col lg={4} md={12}>
              <InputGroup>
                <InputGroup.Text>
                  <Search />
                </InputGroup.Text>
                <Form.Control
                  type="text"
                  placeholder="Search recipient, course, issuer..."
                  value={search}
                  onChange={handleFilterChange(setSearch)}
                />
              </InputGroup>
            </Col>
            <Col lg={2} md={4}>
              <Form.Select
                value={statusFilter}
                onChange={handleFilterChange(setStatusFilter)}
              >
                <option value="">All Statuses</option>
                <option value="valid">Valid</option>
                <option value="revoked">Revoked</option>
              </Form.Select>
            </Col>
            <Col lg={3} md={4}>
              <Form.Control
                type="date"
                name="start_date"
                value={dateFilter.start_date}
                onChange={handleDateChange}
              />
              <Form.Text muted>Issue Start Date</Form.Text>
            </Col>
            <Col lg={3} md={4}>
              <Form.Control
                type="date"
                name="end_date"
                value={dateFilter.end_date}
                onChange={handleDateChange}
              />
              <Form.Text muted>Issue End Date</Form.Text>
            </Col>
          </Row>

          {listLoading ? (
            <div className="text-center p-5">
              <Spinner animation="border" />
            </div>
          ) : (
            <>
              <Table striped bordered hover responsive size="sm">
                <thead className="table-dark">
                  <tr>
                    <th>Recipient</th>
                    <th>Course</th>
                    <th>Issuer</th>
                    <th>Status</th>
                    <th>Issue Date</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  {certificates.length > 0 ? (
                    certificates.map((cert) => (
                      <tr key={cert.id}>
                        <td>{cert.recipient_name}</td>
                        <td>{cert.course_title}</td>
                        <td>{cert.issuer_name}</td>
                        <td>
                          <Badge
                            bg={
                              cert.status === "revoked" ? "danger" : "success"
                            }
                          >
                            {cert.status.toUpperCase()}
                          </Badge>
                        </td>
                        <td>
                          {new Date(cert.issue_date).toLocaleDateString()}
                        </td>
                        <td>
                          <Button
                            variant="outline-primary"
                            size="sm"
                            href={`/verify/${cert.verification_id}`}
                            target="_blank"
                            rel="noopener noreferrer"
                          >
                            View
                          </Button>
                          {cert.status !== "revoked" && (
                            <Button
                              variant="outline-danger"
                              size="sm"
                              className="ms-1"
                              onClick={() => handleRevoke(cert.id)}
                            >
                              Revoke
                            </Button>
                          )}
                        </td>
                      </tr>
                    ))
                  ) : (
                    <tr>
                      <td colSpan="6" className="text-center">
                        No certificates found matching your criteria.
                      </td>
                    </tr>
                  )}
                </tbody>
              </Table>
              {totalPages > 1 && (
                <div className="d-flex justify-content-between align-items-center">
                  <Button
                    disabled={currentPage === 1}
                    onClick={() => setCurrentPage(currentPage - 1)}
                  >
                    Previous
                  </Button>
                  <span>
                    Page {currentPage} of {totalPages}
                  </span>
                  <Button
                    disabled={currentPage === totalPages}
                    onClick={() => setCurrentPage(currentPage + 1)}
                  >
                    Next
                  </Button>
                </div>
              )}
            </>
          )}
        </Card.Body>
      </Card>
    </div>
  );
}
export default AdminCertificatesPage;



==================================================
FILE: pages\AdminCompaniesPage.jsx
==================================================

import React, { useState, useEffect } from "react";
import { useNavigate } from "react-router-dom";
import {
  Card,
  Table,
  Button,
  Form,
  Spinner,
  Alert,
  Row,
  Col,
} from "react-bootstrap";
import { getAdminCompanies, deleteAdminCompany } from "../api";

function AdminCompaniesPage() {
  const [companies, setCompanies] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState("");
  const [search, setSearch] = useState("");
  const [page, setPage] = useState(1);
  const [totalPages, setTotalPages] = useState(1);
  const navigate = useNavigate();

  useEffect(() => {
    fetchCompanies();
  }, [search, page]);

  const fetchCompanies = async () => {
    setLoading(true);
    try {
      const params = { search, page, limit: 10 };
      const res = await getAdminCompanies(params);
      setCompanies(res.data.companies);
      setTotalPages(res.data.pages);
    } catch (err) {
      setError("Failed to fetch companies");
    } finally {
      setLoading(false);
    }
  };

  const handleDelete = async (companyId) => {
    if (
      window.confirm(
        "Are you sure you want to delete this company? All members will be converted to individual accounts. This action cannot be undone."
      )
    ) {
      try {
        const res = await deleteAdminCompany(companyId);
        alert(res.data.msg);
        fetchCompanies();
      } catch (err) {
        alert(err.response?.data?.msg || "Failed to delete company.");
      }
    }
  };

  if (loading && companies.length === 0)
    return (
      <div className="text-center p-5">
        <Spinner animation="border" />
      </div>
    );
  if (error) return <Alert variant="danger">{error}</Alert>;

  return (
    <div>
      <h2 className="fw-bold mb-4">Company Management</h2>
      <Card className="shadow-sm border-0 mb-4">
        <Card.Body>
          <Row className="mb-3">
            <Col md={4}>
              <Form.Control
                type="text"
                placeholder="Search by company or owner name"
                value={search}
                onChange={(e) => setSearch(e.target.value)}
              />
            </Col>
          </Row>

          <Table striped bordered hover responsive>
            <thead className="table-dark">
              <tr>
                <th>Company Name</th>
                <th>Owner</th>
                <th>Members</th>
                <th>Date Created</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {companies.map((company) => (
                <tr key={company.id}>
                  <td>{company.name}</td>
                  <td>{company.owner_name}</td>
                  <td>{company.member_count}</td>
                  <td>{new Date(company.created_at).toLocaleDateString()}</td>
                  <td>
                    <Button
                      variant="info"
                      size="sm"
                      onClick={() => navigate(`/admin/companies/${company.id}`)}
                    >
                      View
                    </Button>
                    <Button
                      variant="danger"
                      size="sm"
                      className="ms-2"
                      onClick={() => handleDelete(company.id)}
                    >
                      Delete
                    </Button>
                  </td>
                </tr>
              ))}
            </tbody>
          </Table>

          <div className="d-flex justify-content-between">
            <Button disabled={page === 1} onClick={() => setPage(page - 1)}>
              Previous
            </Button>
            <span>
              Page {page} of {totalPages}
            </span>
            <Button
              disabled={page === totalPages}
              onClick={() => setPage(page + 1)}
            >
              Next
            </Button>
          </div>
        </Card.Body>
      </Card>
    </div>
  );
}

export default AdminCompaniesPage;



==================================================
FILE: pages\AdminCompanyDetailsPage.jsx
==================================================

import React, { useState, useEffect } from "react";
import { useParams, Link } from "react-router-dom";
import {
  Card,
  Row,
  Col,
  Spinner,
  Alert,
  ListGroup,
  Badge,
  Table,
  Button,
} from "react-bootstrap";
import { ArrowLeft } from "react-bootstrap-icons";
import { getAdminCompanyDetails } from "../api";

function AdminCompanyDetailsPage() {
  const { companyId } = useParams();
  const [companyData, setCompanyData] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState("");

  useEffect(() => {
    fetchCompanyDetails();
  }, [companyId]);

  const fetchCompanyDetails = async () => {
    setLoading(true);
    try {
      const res = await getAdminCompanyDetails(companyId);
      setCompanyData(res.data);
    } catch (err) {
      setError("Failed to fetch company details.");
    } finally {
      setLoading(false);
    }
  };

  if (loading)
    return (
      <div className="text-center p-5">
        <Spinner animation="border" />
      </div>
    );
  if (error) return <Alert variant="danger">{error}</Alert>;
  if (!companyData) return <Alert variant="info">No company data found.</Alert>;

  const { name, owner, members, recent_certificates, created_at } = companyData;

  return (
    <div>
      <Link to="/admin/companies" className="btn btn-outline-secondary mb-3">
        <ArrowLeft /> Back to Company List
      </Link>
      <h2 className="fw-bold mb-4">
        Company Details: <span className="text-primary">{name}</span>
      </h2>

      <Row>
        <Col md={4}>
          <Card className="shadow-sm border-0 mb-4">
            <Card.Header>
              <h5 className="mb-0">Company Info</h5>
            </Card.Header>
            <ListGroup variant="flush">
              <ListGroup.Item>
                <strong>Owner:</strong>{" "}
                <Link to={`/admin/users/${owner.id}`}>{owner.name}</Link>
              </ListGroup.Item>
              <ListGroup.Item>
                <strong>Owner Email:</strong> {owner.email}
              </ListGroup.Item>
              <ListGroup.Item>
                <strong>Members:</strong> {members.length}
              </ListGroup.Item>
              <ListGroup.Item>
                <strong>Created:</strong>{" "}
                {new Date(created_at).toLocaleDateString()}
              </ListGroup.Item>
            </ListGroup>
          </Card>
        </Col>

        <Col md={8}>
          <Card className="shadow-sm border-0 mb-4">
            <Card.Header>
              <h5 className="mb-0">Members</h5>
            </Card.Header>
            <Card.Body>
              <Table striped bordered hover responsive size="sm">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Role</th>
                  </tr>
                </thead>
                <tbody>
                  {members.map((member) => (
                    <tr key={member.id}>
                      <td>
                        <Link to={`/admin/users/${member.id}`}>
                          {member.name}
                        </Link>
                      </td>
                      <td>{member.email}</td>
                      <td>
                        <Badge bg="info">{member.role.toUpperCase()}</Badge>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </Table>
            </Card.Body>
          </Card>
        </Col>
      </Row>

      <Row>
        <Col>
          <Card className="shadow-sm border-0">
            <Card.Header>
              <h5 className="mb-0">
                Recent Certificates ({recent_certificates.length})
              </h5>
            </Card.Header>
            <Card.Body>
              <Table striped bordered hover responsive size="sm">
                <thead>
                  <tr>
                    <th>Recipient</th>
                    <th>Course</th>
                    <th>Status</th>
                    <th>Issued</th>
                  </tr>
                </thead>
                <tbody>
                  {recent_certificates.map((cert) => (
                    <tr key={cert.id}>
                      <td>{cert.recipient_name}</td>
                      <td>{cert.course_title}</td>
                      <td>
                        <Badge
                          bg={cert.status === "revoked" ? "danger" : "success"}
                        >
                          {cert.status}
                        </Badge>
                      </td>
                      <td>{new Date(cert.issue_date).toLocaleDateString()}</td>
                    </tr>
                  ))}
                </tbody>
              </Table>
            </Card.Body>
          </Card>
        </Col>
      </Row>
    </div>
  );
}

export default AdminCompanyDetailsPage;



==================================================
FILE: pages\AdminDashboardPage.jsx
==================================================

import React, { useState, useEffect } from "react";
import { Alert, Spinner } from "react-bootstrap";
import {
  Users,
  FileBadge,
  DollarSign,
  ArrowUp,
  BarChart2,
  ListOrdered,
  ShoppingCart,
  ChevronRight,
} from "lucide-react";
import { Line } from "react-chartjs-2";
import {
  Chart as ChartJS,
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
  Title,
  Tooltip,
  Legend,
  Filler,
} from "chart.js";
import { getAdminDashboardStats } from "../api";
import { Link } from "react-router-dom";

ChartJS.register(
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
  Title,
  Tooltip,
  Legend,
  Filler
);

const formatNumber = (num) => (num || 0).toLocaleString();
const formatCurrency = (num) =>
  `$${(num || 0).toLocaleString(undefined, {
    minimumFractionDigits: 2,
    maximumFractionDigits: 2,
  })}`;

const StatCard = ({ title, value, change, icon: Icon, color }) => (
  <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 flex flex-col justify-between">
    <div className="flex justify-between items-center mb-2">
      <h3 className="text-sm font-semibold text-gray-500 uppercase tracking-wide">
        {title}
      </h3>
      <div className={`p-2 rounded-lg ${color.bg} ${color.text}`}>
        <Icon size={20} />
      </div>
    </div>
    <div>
      <p className="text-3xl font-bold text-gray-900">{value}</p>
      <p className="text-sm text-green-600 font-medium flex items-center gap-1">
        <ArrowUp size={14} /> {change} in 30 days
      </p>
    </div>
  </div>
);

function AdminDashboardPage() {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState("");

  useEffect(() => {
    const fetchStats = async () => {
      try {
        const responseData = await getAdminDashboardStats();
        setData(responseData);
      } catch (err) {
        setError("Failed to load dashboard stats. Please refresh.");
        console.error("Dashboard Error:", err);
      } finally {
        setLoading(false);
      }
    };
    fetchStats();
  }, []);

  if (loading) {
    return (
      <div className="flex justify-center items-center h-[60vh]">
        <Spinner animation="border" variant="primary" />
      </div>
    );
  }

  if (error) return <Alert variant="danger">{error}</Alert>;
  if (!data) return <Alert variant="info">No dashboard data found.</Alert>;

  const { kpi, recent_users, recent_payments, revenue_trend_30d } = data;

  const revenueChartData = {
    labels: (revenue_trend_30d || []).map((item) =>
      new Date(item.date).toLocaleDateString("en-US", {
        month: "short",
        day: "numeric",
      })
    ),
    datasets: [
      {
        label: "Daily Revenue (USD)",
        data: (revenue_trend_30d || []).map((item) => item.revenue),
        borderColor: "#4f46e5",
        backgroundColor: "rgba(79, 70, 229, 0.1)",
        tension: 0.4,
        fill: true,
      },
    ],
  };

  const lineOptions = {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: { display: false },
    },
    scales: {
      y: { beginAtZero: true, ticks: { callback: (value) => `$${value}` } },
      x: { grid: { display: false } },
    },
  };

  return (
    <div className="max-w-7xl mx-auto py-8 px-4">
      <h1 className="text-3xl font-bold text-gray-900 mb-8">
        Dashboard Overview
      </h1>

      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
        <StatCard
          title="Total Revenue"
          value={formatCurrency(kpi?.total_revenue)}
          change={`+${formatCurrency(kpi?.revenue_30d)}`}
          icon={DollarSign}
          color={{ bg: "bg-green-100", text: "text-green-600" }}
        />
        <StatCard
          title="Total Users"
          value={formatNumber(kpi?.total_users)}
          change={`+${formatNumber(kpi?.new_users_30d)}`}
          icon={Users}
          color={{ bg: "bg-indigo-100", text: "text-indigo-600" }}
        />
        <StatCard
          title="Certificates Issued"
          value={formatNumber(kpi?.total_certificates)}
          change={`+${formatNumber(kpi?.new_certs_30d)}`}
          icon={FileBadge}
          color={{ bg: "bg-blue-100", text: "text-blue-600" }}
        />
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <div className="lg:col-span-2">
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 h-full">
            <h3 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
              <BarChart2 size={20} className="text-gray-400" /> Revenue Trend
              (30 Days)
            </h3>
            <div className="h-80">
              {revenue_trend_30d && revenue_trend_30d.length > 0 ? (
                <Line data={revenueChartData} options={lineOptions} />
              ) : (
                <div className="flex items-center justify-center h-full text-gray-400">
                  No revenue data yet.
                </div>
              )}
            </div>
          </div>
        </div>

        <div className="lg:col-span-1">
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 h-full flex flex-col">
            <h3 className="text-lg font-bold text-gray-800 p-6 pb-4 border-b border-gray-100 flex items-center gap-2">
              <ListOrdered size={20} className="text-gray-400" /> Recent Signups
            </h3>
            <div className="flex-1 overflow-y-auto">
              {recent_users && recent_users.length > 0 ? (
                <div className="divide-y divide-gray-100">
                  {recent_users.map((user) => (
                    <Link
                      to={`/admin/users/${user.id}`}
                      key={user.id}
                      className="p-4 flex items-center justify-between hover:bg-gray-50 no-underline text-current"
                    >
                      <div>
                        <p className="font-semibold text-gray-800 text-sm mb-0">
                          {user.name}
                        </p>
                        <p className="text-xs text-gray-500 mb-0">
                          {user.email}
                        </p>
                      </div>
                      <span className="text-xs text-gray-400">
                        {new Date(user.date).toLocaleDateString()}
                      </span>
                    </Link>
                  ))}
                </div>
              ) : (
                <p className="text-center text-gray-500 p-8">No new users.</p>
              )}
            </div>
          </div>
        </div>
      </div>

      <div className="mt-8 bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
        <div className="p-6 border-b border-gray-100">
          <h3 className="text-lg font-bold text-gray-800 flex items-center gap-2">
            <ShoppingCart size={20} className="text-gray-400" /> Recent
            Transactions
          </h3>
        </div>
        <div className="overflow-x-auto">
          {recent_payments && recent_payments.length > 0 ? (
            <table className="min-w-full divide-y divide-gray-200 text-sm">
              <thead className="bg-gray-50">
                <tr>
                  <th className="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">
                    User
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">
                    Plan
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">
                    Amount
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">
                    Date
                  </th>
                  <th className="px-6 py-3 text-right text-xs font-bold text-gray-500 uppercase tracking-wider">
                    Action
                  </th>
                </tr>
              </thead>
              <tbody className="bg-white divide-y divide-gray-100">
                {recent_payments.map((p) => (
                  <tr key={p.id} className="hover:bg-gray-50">
                    <td className="px-6 py-4 whitespace-nowrap font-medium text-gray-900">
                      {p.user_name}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap">
                      <span className="px-2 py-1 text-xs font-semibold uppercase rounded-full bg-indigo-100 text-indigo-800">
                        {p.plan}
                      </span>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-gray-700">
                      {formatCurrency(p.amount)}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-gray-500">
                      {new Date(p.date).toLocaleString()}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-right">
                      <Link
                        to={`/admin/payments/${p.id}`}
                        className="text-indigo-600 hover:text-indigo-900 font-medium"
                      >
                        View
                      </Link>
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          ) : (
            <p className="text-center text-gray-500 p-8">
              No recent transactions.
            </p>
          )}
        </div>
      </div>
    </div>
  );
}

export default AdminDashboardPage;



==================================================
FILE: pages\AdminLoginPage.jsx
==================================================

import React, { useState, useEffect } from "react";
import { Link, useNavigate, useLocation } from "react-router-dom";
import { Form, Button, Alert, Spinner } from "react-bootstrap";
import { adminLogin } from "../api";
import "../styles/Auth.css";

function AdminLoginPage() {
  const [formData, setFormData] = useState({ email: "", password: "" });
  const [error, setError] = useState("");
  const [loading, setLoading] = useState(false);
  const [successMessage, setSuccessMessage] = useState("");
  const navigate = useNavigate();
  const location = useLocation();

  useEffect(() => {
    // Check for a success message or error from the verification page or protected route
    if (location.state?.message) {
      setSuccessMessage(location.state.message);
      window.history.replaceState({}, document.title);
    }
    if (location.state?.error) {
      setError(location.state.error);
      window.history.replaceState({}, document.title);
    }
  }, [location]);

  const handleChange = (e) => {
    setFormData({ ...formData, [e.target.name]: e.target.value });
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError("");
    setLoading(true);
    setSuccessMessage("");

    try {
      const response = await adminLogin(formData);
      localStorage.setItem("token", response.data.access_token);
      navigate("/admin/dashboard");
    } catch (err) {
      setError(err.response?.data?.msg || "Login failed. Please try again.");
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="auth-container">
      <div className="auth-wrapper">
        <div className="auth-panel" style={{ backgroundColor: "#dc3545" }}>
          <h2>Administrator Access</h2>
          <p>
            Welcome to the CertifyMe Admin Control Panel. Please authenticate to
            continue.
          </p>
        </div>
        <div className="auth-form-container">
          <img
            src="/images/certbadge.png"
            alt="CertifyMe Logo"
            className="auth-logo mx-auto d-block"
            style={{ maxHeight: "35px" }}
          />
          <h3>Admin Sign In</h3>
          {error && <Alert variant="danger">{error}</Alert>}
          {successMessage && <Alert variant="success">{successMessage}</Alert>}
          <Form onSubmit={handleSubmit}>
            <Form.Group className="mb-3" controlId="email">
              <Form.Label>Admin Email</Form.Label>
              <Form.Control
                type="email"
                name="email"
                value={formData.email}
                onChange={handleChange}
                placeholder="admin@certifyme.com"
                required
              />
            </Form.Group>
            <Form.Group className="mb-4 position-relative" controlId="password">
              <Form.Label>Password</Form.Label>
              <Form.Control
                type="password"
                name="password"
                value={formData.password}
                onChange={handleChange}
                placeholder="Enter your password"
                required
              />
            </Form.Group>
            <Button
              className="btn-auth w-100"
              style={{ backgroundColor: "#dc3545", borderColor: "#dc3545" }}
              type="submit"
              disabled={loading}
            >
              {loading ? <Spinner as="span" size="sm" /> : "Sign In"}
            </Button>
          </Form>
          <p className="text-center mt-4 text-muted">
            <Link to="/" className="auth-switch-link">
              Back to Main Site
            </Link>
          </p>
        </div>
      </div>
    </div>
  );
}

export default AdminLoginPage;



==================================================
FILE: pages\AdminMessagingPage.jsx
==================================================

import React, { useState, useEffect, useRef, useMemo } from "react";
import {
  Card,
  Form,
  Button,
  Spinner,
  Alert,
  Row,
  Col,
  Modal,
} from "react-bootstrap";
import {
  getEmailRecipients,
  sendAdminBulkEmail,
  uploadEditorImage,
} from "../api"; // IMPORT NEW API
import ReactQuill from "react-quill";
import "react-quill/dist/quill.snow.css";
import Select from "react-select";

function AdminMessagingPage() {
  const [recipientOptions, setRecipientOptions] = useState([]);
  const [selectedOptions, setSelectedOptions] = useState(null);
  const [subject, setSubject] = useState("");
  const [body, setBody] = useState("");
  const [headerImageUrl, setHeaderImageUrl] = useState("");
  const [loading, setLoading] = useState(true);
  const [sending, setSending] = useState(false);
  const [error, setError] = useState("");
  const [success, setSuccess] = useState("");
  const [showPreview, setShowPreview] = useState(false);
  const quillRef = useRef(null); // Create a ref for the editor instance

  // --- THIS IS THE FIX: Custom Image Handler ---
  // This function handles image uploads directly to the server,
  // getting a URL back. This ensures images are not base64 encoded
  // and will show up in all email clients.
  const imageHandler = () => {
    const input = document.createElement("input");
    input.setAttribute("type", "file");
    input.setAttribute("accept", "image/*");
    input.click();

    input.onchange = async () => {
      const file = input.files[0];
      if (file) {
        const formData = new FormData();
        formData.append("image", file); // The backend expects an 'image' field

        try {
          const res = await uploadEditorImage(formData);
          const imageUrl = res.data.imageUrl; // The API should return the public URL

          const quill = quillRef.current.getEditor();
          const range = quill.getSelection(true);
          quill.insertEmbed(range.index, "image", imageUrl);
          quill.setSelection(range.index + 1);
        } catch (err) {
          setError(
            err.response?.data?.msg ||
              "Failed to upload image. Please try again."
          );
        }
      }
    };
  };

  // Define a richer toolbar for the editor and wire up the custom image handler
  const quillModules = useMemo(
    () => ({
      toolbar: {
        container: [
          [{ header: [1, 2, 3, 4, false] }],
          ["bold", "italic", "underline", "strike", "blockquote"],
          [{ list: "ordered" }, { list: "bullet" }],
          ["link", "image"], // The 'image' button will now trigger our handler
          [{ align: [] }],
          ["clean"],
        ],
        handlers: {
          image: imageHandler,
        },
      },
    }),
    []
  );
  // --- END OF FIX ---

  useEffect(() => {
    const fetchRecipients = async () => {
      try {
        const res = await getEmailRecipients();
        const options = res.data.map((user) => ({
          value: user.id,
          label: `${user.name} (${user.email})`,
        }));
        setRecipientOptions([
          { value: "all", label: "All Active Users" },
          ...options,
        ]);
      } catch (err) {
        setError("Failed to fetch recipient list.");
      } finally {
        setLoading(false);
      }
    };
    fetchRecipients();
  }, []);

  const handleSelectChange = (selected) => {
    if (selected && selected.some((option) => option.value === "all")) {
      setSelectedOptions([{ value: "all", label: "All Active Users" }]);
    } else {
      setSelectedOptions(selected);
    }
  };

  const handleHeaderImageUpload = async (e) => {
    const file = e.target.files[0];
    if (file) {
      const formData = new FormData();
      formData.append("image", file);
      try {
        const res = await uploadEditorImage(formData);
        setHeaderImageUrl(res.data.imageUrl);
      } catch (err) {
        setError(
          err.response?.data?.msg ||
            "Failed to upload header image. Please try again."
        );
      }
    }
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    if (!subject || !body || !selectedOptions || selectedOptions.length === 0) {
      setError("Please fill in all fields and select recipients.");
      return;
    }
    setSending(true);
    setError("");
    setSuccess("");
    try {
      const payload = {
        subject,
        body,
        recipients:
          selectedOptions[0].value === "all"
            ? "all"
            : selectedOptions.map((opt) => opt.value),
        header_image_url: headerImageUrl,
      };
      const res = await sendAdminBulkEmail(payload);
      setSuccess(res.data.msg);
      setSubject("");
      setBody("");
      setSelectedOptions(null);
      setHeaderImageUrl("");
    } catch (err) {
      setError(err.response?.data?.msg || "Failed to send email.");
    } finally {
      setSending(false);
    }
  };

  const previewBody = body.replace(/{{ user_name }}/g, "John Doe");

  return (
    <div>
      <h2 className="fw-bold mb-4">User Messaging Center</h2>
      <Card className="shadow-sm border-0">
        <Card.Body>
          {error && (
            <Alert variant="danger" onClose={() => setError("")} dismissible>
              {error}
            </Alert>
          )}
          {success && (
            <Alert variant="success" onClose={() => setSuccess("")} dismissible>
              {success}
            </Alert>
          )}

          <Form onSubmit={handleSubmit}>
            <Row>
              <Col md={12} lg={6} className="mb-3">
                <Form.Group controlId="recipients">
                  <Form.Label>Recipients</Form.Label>
                  <Select
                    isMulti
                    options={recipientOptions}
                    isLoading={loading}
                    value={selectedOptions}
                    onChange={handleSelectChange}
                    closeMenuOnSelect={false}
                    placeholder="Select recipients..."
                  />
                  <Form.Text>
                    Select "All Active Users" or choose individuals from the
                    list.
                  </Form.Text>
                </Form.Group>
              </Col>
              <Col md={12} lg={6} className="mb-3">
                <Form.Group controlId="subject">
                  <Form.Label>Subject</Form.Label>
                  <Form.Control
                    type="text"
                    value={subject}
                    onChange={(e) => setSubject(e.target.value)}
                    required
                    placeholder="e.g., Important Platform Update"
                  />
                </Form.Group>
              </Col>
            </Row>

            <Form.Group className="mb-3" controlId="headerImage">
              <Form.Label>Header Image (Optional)</Form.Label>
              <Form.Control
                type="file"
                accept="image/*"
                onChange={handleHeaderImageUpload}
              />
              {headerImageUrl && (
                <img
                  src={headerImageUrl}
                  alt="Header Preview"
                  style={{ maxWidth: "100%", marginTop: "10px" }}
                />
              )}
              <Form.Text>
                Upload a header image to appear at the top of the email.
              </Form.Text>
            </Form.Group>

            <Form.Group className="mb-3" controlId="body">
              <Form.Label>Email Body</Form.Label>
              <ReactQuill
                ref={quillRef} // Assign the ref
                theme="snow"
                value={body}
                onChange={setBody}
                modules={quillModules}
                style={{ height: "250px", marginBottom: "50px" }}
              />
              <Form.Text>
                Use {"{{ user_name }}"} in the body for personalization (e.g.,
                Hello {"{{ user_name }}"}).
              </Form.Text>
            </Form.Group>

            <div className="d-flex gap-2">
              <Button
                variant="primary"
                type="submit"
                disabled={sending || loading}
              >
                {sending ? (
                  <>
                    <Spinner as="span" animation="border" size="sm" />{" "}
                    Sending...
                  </>
                ) : (
                  "Send Email"
                )}
              </Button>
              <Button
                variant="outline-secondary"
                onClick={() => setShowPreview(true)}
                disabled={!body}
              >
                Preview Email
              </Button>
            </div>
          </Form>
        </Card.Body>
      </Card>

      {/* Preview Modal */}
      <Modal show={showPreview} onHide={() => setShowPreview(false)} size="lg">
        <Modal.Header closeButton>
          <Modal.Title>Email Preview</Modal.Title>
        </Modal.Header>
        <Modal.Body>
          <h5>Subject: {subject}</h5>
          <hr />
          {headerImageUrl && (
            <img
              src={headerImageUrl}
              alt="Header"
              style={{ width: "100%", marginBottom: "20px" }}
            />
          )}
          <div dangerouslySetInnerHTML={{ __html: previewBody }} />
        </Modal.Body>
        <Modal.Footer>
          <Button variant="secondary" onClick={() => setShowPreview(false)}>
            Close
          </Button>
        </Modal.Footer>
      </Modal>
    </div>
  );
}

export default AdminMessagingPage;



==================================================
FILE: pages\AdminPaymentDetailsPage.jsx
==================================================

import React, { useState, useEffect } from "react";
import { useParams, Link } from "react-router-dom";
import {
  Card,
  Row,
  Col,
  Spinner,
  Alert,
  ListGroup,
  Badge,
} from "react-bootstrap";
import { ArrowLeft } from "react-bootstrap-icons";
import { getAdminTransactionDetails } from "../api";

function AdminPaymentDetailsPage() {
  const { paymentId } = useParams();
  const [details, setDetails] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState("");

  useEffect(() => {
    const fetchDetails = async () => {
      try {
        const res = await getAdminTransactionDetails(paymentId);
        setDetails(res.data);
      } catch (err) {
        setError("Failed to fetch payment details.");
        console.error(err);
      } finally {
        setLoading(false);
      }
    };
    fetchDetails();
  }, [paymentId]);

  if (loading) {
    return (
      <div className="text-center p-5">
        <Spinner animation="border" />
      </div>
    );
  }

  if (error) {
    return <Alert variant="danger">{error}</Alert>;
  }

  if (!details) {
    return <Alert variant="info">No payment details found.</Alert>;
  }

  const getStatusBadge = (status) => {
    switch (status) {
      case "paid":
        return "success";
      case "failed":
        return "danger";
      default:
        return "warning";
    }
  };

  return (
    <div>
      <Link to="/admin/payments" className="btn btn-outline-secondary mb-3">
        <ArrowLeft /> Back to Payments List
      </Link>
      <h2 className="fw-bold mb-4">
        Transaction Details: <span className="text-primary">#{details.id}</span>
      </h2>

      <Row>
        <Col md={6}>
          <Card className="shadow-sm border-0 mb-4">
            <Card.Header>
              <h5 className="mb-0">Payment Information</h5>
            </Card.Header>
            <ListGroup variant="flush">
              <ListGroup.Item>
                <strong>Status:</strong>{" "}
                <Badge bg={getStatusBadge(details.status)}>
                  {details.status.toUpperCase()}
                </Badge>
              </ListGroup.Item>
              <ListGroup.Item>
                <strong>Amount:</strong> {details.amount} {details.currency}
              </ListGroup.Item>
              <ListGroup.Item>
                <strong>Plan Purchased:</strong> {details.plan.toUpperCase()}
              </ListGroup.Item>
              <ListGroup.Item>
                <strong>Date & Time:</strong>{" "}
                {new Date(details.date).toLocaleString()}
              </ListGroup.Item>
            </ListGroup>
          </Card>
        </Col>
        <Col md={6}>
          <Card className="shadow-sm border-0 mb-4">
            <Card.Header>
              <h5 className="mb-0">User & Provider</h5>
            </Card.Header>
            <ListGroup variant="flush">
              <ListGroup.Item>
                <strong>User:</strong>{" "}
                <Link to={`/admin/users/${details.user_id}`}>
                  {details.user_name}
                </Link>
              </ListGroup.Item>
              <ListGroup.Item>
                <strong>User Email:</strong> {details.user_email}
              </ListGroup.Item>
              <ListGroup.Item>
                <strong>Payment Provider:</strong> {details.provider}
              </ListGroup.Item>
              <ListGroup.Item>
                <strong>Provider Reference:</strong>{" "}
                <code>{details.transaction_ref}</code>
              </ListGroup.Item>
            </ListGroup>
          </Card>
        </Col>
      </Row>
    </div>
  );
}

export default AdminPaymentDetailsPage;



==================================================
FILE: pages\AdminPaymentsPage.jsx
==================================================

import React, { useState, useEffect } from "react";
import { useNavigate } from "react-router-dom"; // Import useNavigate
import {
  Card,
  Table,
  Badge,
  Button,
  Form,
  Col,
  Row,
  Spinner,
  Alert,
} from "react-bootstrap";
import { getAdminTransactions } from "../api";

function AdminPaymentsPage() {
  const [transactions, setTransactions] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState("");
  const [statusFilter, setStatusFilter] = useState("");
  const [page, setPage] = useState(1);
  const [totalPages, setTotalPages] = useState(1);
  const [stats, setStats] = useState({ total_revenue: 0, revenue_by_plan: {} });
  const navigate = useNavigate(); // Initialize navigate

  useEffect(() => {
    fetchTransactions();
  }, [statusFilter, page]);

  const fetchTransactions = async () => {
    setLoading(true);
    try {
      const params = { status: statusFilter, page, limit: 10 };
      const res = await getAdminTransactions(params);
      setTransactions(res.data.transactions);
      setTotalPages(res.data.pages);
      setStats(res.data.stats);
    } catch (err) {
      setError("Failed to fetch transactions");
    } finally {
      setLoading(false);
    }
  };

  if (loading)
    return (
      <div className="text-center p-5">
        <Spinner animation="border" />
      </div>
    );
  if (error) return <Alert variant="danger">{error}</Alert>;

  return (
    <div>
      <h2 className="fw-bold mb-4">Payments & Subscriptions</h2>
      <Row className="mb-4">
        <Col md={3}>
          <Card className="shadow-sm border-0 bg-success text-white">
            <Card.Body className="text-center">
              <h4>${stats.total_revenue.toLocaleString()}</h4>
              <p>Total Revenue</p>
            </Card.Body>
          </Card>
        </Col>
        {Object.entries(stats.revenue_by_plan).map(([plan, amount]) => (
          <Col md={3} key={plan}>
            <Card className="shadow-sm border-0">
              <Card.Body className="text-center">
                <h5>${amount.toLocaleString()}</h5>
                <p>{plan.toUpperCase()} Plan</p>
              </Card.Body>
            </Card>
          </Col>
        ))}
      </Row>
      <Card className="shadow-sm border-0 mb-3">
        <Card.Body>
          <Form.Select
            value={statusFilter}
            onChange={(e) => setStatusFilter(e.target.value)}
            className="mb-3"
            style={{ width: "200px" }}
          >
            <option value="">All Statuses</option>
            <option value="pending">Pending</option>
            <option value="paid">Paid</option>
            <option value="failed">Failed</option>
          </Form.Select>
          <Table striped bordered hover responsive>
            <thead className="table-dark">
              <tr>
                <th>User</th>
                <th>Amount</th>
                <th>Plan</th>
                <th>Status</th>
                <th>Date</th>
                <th>Provider</th>
                {/* --- THIS IS THE FIX --- */}
                <th>Actions</th>
                {/* --- END OF FIX --- */}
              </tr>
            </thead>
            <tbody>
              {transactions.map((t) => (
                <tr
                  key={t.id}
                  className={t.status === "failed" ? "table-danger" : ""}
                >
                  <td>{t.user_name}</td>
                  <td>
                    {t.amount} {t.currency}
                  </td>
                  <td>{t.plan}</td>
                  <td>
                    <Badge
                      bg={
                        t.status === "paid"
                          ? "success"
                          : t.status === "failed"
                          ? "danger"
                          : "warning"
                      }
                    >
                      {t.status}
                    </Badge>
                  </td>
                  <td>{new Date(t.date).toLocaleDateString()}</td>
                  <td>{t.provider}</td>
                  {/* --- THIS IS THE FIX --- */}
                  <td>
                    <Button
                      variant="info"
                      size="sm"
                      onClick={() => navigate(`/admin/payments/${t.id}`)}
                    >
                      View
                    </Button>
                  </td>
                  {/* --- END OF FIX --- */}
                </tr>
              ))}
            </tbody>
          </Table>
          <div className="d-flex justify-content-between">
            <Button disabled={page === 1} onClick={() => setPage(page - 1)}>
              Previous
            </Button>
            <span>
              Page {page} of {totalPages}
            </span>
            <Button
              disabled={page === totalPages}
              onClick={() => setPage(page + 1)}
            >
              Next
            </Button>
          </div>
        </Card.Body>
      </Card>
    </div>
  );
}

export default AdminPaymentsPage;



==================================================
FILE: pages\AdminPortalPage.jsx
==================================================

import React, { useState, useEffect } from "react";
import { getAdminStatus } from "../api";
import AdminLoginPage from "./AdminLoginPage";
import AdminSignupPage from "./AdminSignupPage";
import { Spinner } from "react-bootstrap";

// This component acts as a gatekeeper, showing either the signup or login page.
function AdminPortalPage() {
  const [adminExists, setAdminExists] = useState(true);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const checkAdminStatus = async () => {
      try {
        const response = await getAdminStatus();
        setAdminExists(response.data.admin_exists);
      } catch (error) {
        console.error("Could not verify admin status", error);
        // Fail securely - assume admin exists if API fails
        setAdminExists(true);
      } finally {
        setLoading(false);
      }
    };
    checkAdminStatus();
  }, []);

  if (loading) {
    return (
      <div className="d-flex justify-content-center align-items-center vh-100">
        <Spinner animation="border" />
      </div>
    );
  }

  return adminExists ? <AdminLoginPage /> : <AdminSignupPage />;
}

export default AdminPortalPage;



==================================================
FILE: pages\AdminSignupPage.jsx
==================================================

import React, { useState } from "react";
import { useNavigate } from "react-router-dom";
import { Form, Button, Alert, Spinner } from "react-bootstrap";
import { adminSignup } from "../api";
import "../styles/Auth.css";

function AdminSignupPage() {
  const [formData, setFormData] = useState({
    name: "",
    email: "",
    password: "",
  });
  const [error, setError] = useState("");
  const [loading, setLoading] = useState(false);
  const navigate = useNavigate();

  const handleChange = (e) => {
    setFormData({ ...formData, [e.target.name]: e.target.value });
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError("");
    setLoading(true);

    try {
      await adminSignup(formData);
      // On success, navigate to the verify page and pass the email
      navigate("/admin/verify", { state: { email: formData.email } });
    } catch (err) {
      setError(err.response?.data?.msg || "Signup failed. Please try again.");
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="auth-container">
      <div className="auth-wrapper">
        <div className="auth-panel" style={{ backgroundColor: "#0d6efd" }}>
          <h2>Create Your Admin Account</h2>
          <p>
            This is a one-time setup for the master administrator of CertifyMe.
          </p>
        </div>
        <div className="auth-form-container">
          <img
            src="/images/certbadge.png"
            alt="CertifyMe Logo"
            className="auth-logo mx-auto d-block"
            style={{ maxHeight: "35px" }}
          />
          <h3>Admin Setup</h3>
          {error && <Alert variant="danger">{error}</Alert>}
          <Form onSubmit={handleSubmit}>
            <Form.Group className="mb-3" controlId="name">
              <Form.Label>Full Name</Form.Label>
              <Form.Control
                type="text"
                name="name"
                value={formData.name}
                onChange={handleChange}
                required
              />
            </Form.Group>
            <Form.Group className="mb-3" controlId="email">
              <Form.Label>Email Address</Form.Label>
              <Form.Control
                type="email"
                name="email"
                value={formData.email}
                onChange={handleChange}
                required
              />
            </Form.Group>
            <Form.Group className="mb-4" controlId="password">
              <Form.Label>Password</Form.Label>
              <Form.Control
                type="password"
                name="password"
                value={formData.password}
                onChange={handleChange}
                required
              />
            </Form.Group>
            <Button className="btn-auth w-100" type="submit" disabled={loading}>
              {loading ? (
                <Spinner as="span" size="sm" />
              ) : (
                "Create Admin Account"
              )}
            </Button>
          </Form>
        </div>
      </div>
    </div>
  );
}

export default AdminSignupPage;



==================================================
FILE: pages\AdminSupportPage.jsx
==================================================

import React, { useState, useEffect } from "react";
import { useNavigate } from "react-router-dom";
import {
  Card,
  Table,
  Badge,
  Button,
  Form,
  Spinner,
  Alert,
} from "react-bootstrap";
import { getAdminSupportTickets } from "../api";

function AdminSupportPage() {
  const [tickets, setTickets] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState("");
  const [statusFilter, setStatusFilter] = useState("");
  const [page, setPage] = useState(1);
  const [totalPages, setTotalPages] = useState(1);
  const navigate = useNavigate();

  useEffect(() => {
    fetchTickets();
  }, [statusFilter, page]);

  const fetchTickets = async () => {
    setLoading(true);
    try {
      const params = { status: statusFilter, page, limit: 10 };
      const res = await getAdminSupportTickets(params);
      setTickets(res.data.tickets);
      setTotalPages(res.data.pages);
    } catch (err) {
      setError("Failed to fetch support tickets.");
    } finally {
      setLoading(false);
    }
  };

  const getPriorityBadge = (role) => {
    const priorities = {
      enterprise: { bg: "danger", text: "Highest" },
      pro: { bg: "warning", text: "High" },
      growth: { bg: "info", text: "Medium" },
      starter: { bg: "primary", text: "Normal" },
      free: { bg: "secondary", text: "Low" },
    };
    return priorities[role] || { bg: "light", text: "N/A" };
  };

  const getStatusBadge = (status) => {
    const variants = {
      open: "primary",
      in_progress: "warning",
      closed: "secondary",
    };
    return variants[status] || "info";
  };

  return (
    <div>
      <h2 className="fw-bold mb-4">Support Ticket Management</h2>
      <Card className="shadow-sm border-0">
        <Card.Body>
          <Form.Select
            value={statusFilter}
            onChange={(e) => setStatusFilter(e.target.value)}
            className="mb-3"
            style={{ width: "200px" }}
          >
            <option value="">All Statuses</option>
            <option value="open">Open</option>
            <option value="in_progress">In Progress</option>
            <option value="closed">Closed</option>
          </Form.Select>

          {loading ? (
            <div className="text-center p-5">
              <Spinner animation="border" />
            </div>
          ) : error ? (
            <Alert variant="danger">{error}</Alert>
          ) : (
            <>
              <Table striped bordered hover responsive>
                <thead className="table-dark">
                  <tr>
                    <th>Priority</th>
                    <th>Subject</th>
                    <th>User</th>
                    <th>Status</th>
                    <th>Last Updated</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  {tickets.map((ticket) => (
                    <tr key={ticket.id}>
                      <td>
                        <Badge
                          bg={getPriorityBadge(ticket.user_role).bg}
                          className="p-2"
                        >
                          {getPriorityBadge(ticket.user_role).text}
                        </Badge>
                      </td>
                      <td>{ticket.subject}</td>
                      <td>
                        {ticket.user_name} (
                        <span className="text-capitalize">
                          {ticket.user_role}
                        </span>
                        )
                      </td>
                      <td>
                        <Badge bg={getStatusBadge(ticket.status)}>
                          {ticket.status.replace("_", " ").toUpperCase()}
                        </Badge>
                      </td>
                      <td>{new Date(ticket.updated_at).toLocaleString()}</td>
                      <td>
                        <Button
                          variant="info"
                          size="sm"
                          onClick={() =>
                            navigate(`/admin/support/${ticket.id}`)
                          }
                        >
                          View / Reply
                        </Button>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </Table>
              <div className="d-flex justify-content-between">
                <Button disabled={page === 1} onClick={() => setPage(page - 1)}>
                  Previous
                </Button>
                <span>
                  Page {page} of {totalPages}
                </span>
                <Button
                  disabled={page === totalPages}
                  onClick={() => setPage(page + 1)}
                >
                  Next
                </Button>
              </div>
            </>
          )}
        </Card.Body>
      </Card>
    </div>
  );
}

export default AdminSupportPage;



==================================================
FILE: pages\AdminSupportTicketDetailsPage.jsx
==================================================

import React, { useState, useEffect, useRef } from "react";
import { useParams, Link, useNavigate } from "react-router-dom";
import {
  Card,
  Form,
  Button,
  Spinner,
  Alert,
  Row,
  Col,
  Badge,
  InputGroup,
  Dropdown,
  Modal,
  Image,
} from "react-bootstrap";
import {
  ArrowLeft,
  SendFill,
  PersonCircle,
  Paperclip,
} from "react-bootstrap-icons";
import {
  getAdminTicketDetails,
  adminReplyToTicket,
  updateTicketStatus,
} from "../api";
import toast, { Toaster } from "react-hot-toast";
import "../styles/SupportPage.css"; // Corrected CSS import path

function AdminSupportTicketDetailsPage() {
  const { ticketId } = useParams();
  const [ticket, setTicket] = useState(null);
  const [loading, setLoading] = useState(true);
  const [reply, setReply] = useState("");
  const [file, setFile] = useState(null);
  const [sending, setSending] = useState(false);
  const [showImageModal, setShowImageModal] = useState(false);
  const [modalImageUrl, setModalImageUrl] = useState("");
  const navigate = useNavigate();
  const fileInputRef = useRef(null);

  useEffect(() => {
    fetchTicket();
  }, [ticketId]);

  const fetchTicket = async () => {
    setLoading(true);
    try {
      const res = await getAdminTicketDetails(ticketId);
      setTicket(res.data);
    } catch (err) {
      toast.error("Could not fetch ticket details.");
      navigate("/admin/support");
    } finally {
      setLoading(false);
    }
  };

  const handleReply = async (e) => {
    e.preventDefault();
    setSending(true);
    const promise = adminReplyToTicket(ticketId, reply, file);

    toast.promise(promise, {
      loading: "Sending reply...",
      success: () => {
        setReply("");
        setFile(null);
        if (fileInputRef.current) {
          fileInputRef.current.value = "";
        }
        fetchTicket(); // Refresh messages
        return "Reply sent successfully!";
      },
      error: (err) => err.response?.data?.msg || "Failed to send reply.",
    });

    promise.finally(() => setSending(false));
  };

  const handleFileChange = (e) => {
    if (e.target.files[0]) {
      setFile(e.target.files[0]);
    } else {
      setFile(null);
    }
  };

  const openImageModal = (imageUrl) => {
    setModalImageUrl(imageUrl);
    setShowImageModal(true);
  };

  const handleStatusChange = async (newStatus) => {
    const promise = updateTicketStatus(ticketId, newStatus);
    toast.promise(promise, {
      loading: "Updating status...",
      success: (res) => {
        fetchTicket(); // Refresh ticket details
        return res.data.msg;
      },
      error: (err) => err.response?.data?.msg || "Failed to update status.",
    });
  };

  if (loading) {
    return (
      <div className="text-center p-5">
        <Spinner animation="border" />
      </div>
    );
  }

  if (!ticket) return null;

  return (
    <>
      <Toaster position="top-center" />
      <Link to="/admin/support" className="btn btn-outline-secondary mb-3">
        <ArrowLeft /> Back to All Tickets
      </Link>
      <Row>
        <Col lg={8}>
          <Card className="shadow-sm border-0">
            <Card.Header>
              <h4 className="mb-0">{ticket.subject}</h4>
            </Card.Header>
            <Card.Body
              style={{ height: "55vh", overflowY: "auto" }}
              className="d-flex flex-column"
            >
              {ticket.messages.map((msg) => (
                <div
                  key={msg.id}
                  className={`d-flex mb-3 ${
                    msg.sender_type === "admin" ? "justify-content-end" : ""
                  }`}
                >
                  <div
                    className={`p-3 rounded-3 ${
                      msg.sender_type === "admin"
                        ? "bg-primary text-white"
                        : "bg-light text-dark"
                    }`}
                    style={{ maxWidth: "80%" }}
                  >
                    <div className="fw-bold d-flex align-items-center mb-1">
                      <PersonCircle className="me-2" />
                      {msg.sender_name}
                    </div>
                    <p className="mb-1" style={{ whiteSpace: "pre-wrap" }}>
                      {msg.content}
                    </p>
                    {msg.image_url && (
                      <Image
                        src={msg.image_url}
                        thumbnail
                        className="mt-2 support-thumbnail"
                        onClick={() => openImageModal(msg.image_url)}
                      />
                    )}
                    <small className="opacity-75">
                      {new Date(msg.created_at).toLocaleString()}
                    </small>
                  </div>
                </div>
              ))}
            </Card.Body>
            <Card.Footer>
              <Form onSubmit={handleReply}>
                <InputGroup>
                  <Form.Control
                    as="textarea"
                    rows={2}
                    placeholder="Type your reply..."
                    value={reply}
                    onChange={(e) => setReply(e.target.value)}
                    required
                  />
                  <Button
                    variant="secondary"
                    onClick={() => fileInputRef.current.click()}
                  >
                    <Paperclip />
                  </Button>
                  <Button type="submit" variant="primary" disabled={sending}>
                    {sending ? <Spinner as="span" size="sm" /> : <SendFill />}
                  </Button>
                </InputGroup>
                <Form.Control
                  type="file"
                  ref={fileInputRef}
                  onChange={handleFileChange}
                  accept="image/png, image/jpeg, image/gif"
                  style={{ display: "none" }}
                />
                {file && <Form.Text muted>Attachment: {file.name}</Form.Text>}
              </Form>
            </Card.Footer>
          </Card>
        </Col>
        <Col lg={4}>
          <Card className="shadow-sm border-0">
            <Card.Header>
              <h5 className="mb-0">Ticket Details</h5>
            </Card.Header>
            <Card.Body>
              <h6>User Information</h6>
              <p className="mb-1">
                <strong>Name:</strong>{" "}
                <Link to={`/admin/users/${ticket.user.id}`}>
                  {ticket.user.name}
                </Link>
              </p>
              <p className="mb-1">
                <strong>Email:</strong> {ticket.user.email}
              </p>
              <p>
                <strong>Plan:</strong>{" "}
                <Badge bg="info">{ticket.user.role.toUpperCase()}</Badge>
              </p>
              <hr />
              <h6>Ticket Status</h6>
              <Dropdown>
                <Dropdown.Toggle
                  variant="outline-secondary"
                  id="dropdown-basic"
                  className="w-100"
                >
                  {ticket.status.replace("_", " ").toUpperCase()}
                </Dropdown.Toggle>
                <Dropdown.Menu className="w-100">
                  <Dropdown.Item onClick={() => handleStatusChange("open")}>
                    Open
                  </Dropdown.Item>
                  <Dropdown.Item
                    onClick={() => handleStatusChange("in_progress")}
                  >
                    In Progress
                  </Dropdown.Item>
                  <Dropdown.Item onClick={() => handleStatusChange("closed")}>
                    Close Ticket
                  </Dropdown.Item>
                </Dropdown.Menu>
              </Dropdown>
            </Card.Body>
          </Card>
        </Col>
      </Row>

      <Modal
        show={showImageModal}
        onHide={() => setShowImageModal(false)}
        centered
        size="lg"
      >
        <Modal.Body className="p-0">
          <Image src={modalImageUrl} fluid />
        </Modal.Body>
      </Modal>
    </>
  );
}

export default AdminSupportTicketDetailsPage;



==================================================
FILE: pages\AdminUserDetailsPage.jsx
==================================================

import React, { useState, useEffect } from "react";
import { useParams, Link } from "react-router-dom";
import {
  Card,
  Row,
  Col,
  Spinner,
  Alert,
  ListGroup,
  Badge,
  Table,
  Button,
  Form,
  Modal,
} from "react-bootstrap";
import { ArrowLeft } from "react-bootstrap-icons";
import {
  getAdminUserDetails,
  adjustUserQuota,
  revokeAdminCertificate,
} from "../api";

function AdminUserDetailsPage() {
  const { userId } = useParams();
  const [userData, setUserData] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState("");
  const [quotaAdjustment, setQuotaAdjustment] = useState({
    amount: "",
    reason: "",
  });
  const [showConfirmModal, setShowConfirmModal] = useState(false);

  useEffect(() => {
    fetchUserDetails();
  }, [userId]);

  const fetchUserDetails = async () => {
    setLoading(true);
    try {
      const res = await getAdminUserDetails(userId);
      setUserData(res.data);
    } catch (err) {
      setError("Failed to fetch user details.");
      console.error(err);
    } finally {
      setLoading(false);
    }
  };

  const handleAdjustmentChange = (e) => {
    setQuotaAdjustment({
      ...quotaAdjustment,
      [e.target.name]: e.target.value,
    });
  };

  const handleAdjustmentSubmit = async (e) => {
    e.preventDefault();
    if (!quotaAdjustment.reason) {
      alert("A reason for the adjustment is required.");
      return;
    }
    setShowConfirmModal(true);
  };

  const confirmQuotaAdjustment = async () => {
    setShowConfirmModal(false);
    try {
      const amountInt = parseInt(quotaAdjustment.amount, 10);
      if (isNaN(amountInt)) {
        alert("Please enter a valid number for the adjustment.");
        return;
      }
      await adjustUserQuota(userId, amountInt, quotaAdjustment.reason);
      setQuotaAdjustment({ amount: "", reason: "" }); // Reset form
      fetchUserDetails(); // Refresh data
    } catch (err) {
      alert(
        err.response?.data?.msg || "Failed to adjust quota. Please try again."
      );
    }
  };

  const handleRevoke = async (certId) => {
    if (window.confirm("Are you sure you want to revoke this certificate?")) {
      try {
        await revokeAdminCertificate(certId);
        fetchUserDetails();
      } catch (err) {
        alert("Failed to revoke certificate.");
      }
    }
  };

  if (loading)
    return (
      <div className="text-center p-5">
        <Spinner animation="border" />
      </div>
    );
  if (error) return <Alert variant="danger">{error}</Alert>;
  if (!userData) return <Alert variant="info">No user data found.</Alert>;

  const { user, certificates, payments } = userData;

  return (
    <div>
      <Link to="/admin/users" className="btn btn-outline-secondary mb-3">
        <ArrowLeft /> Back to User List
      </Link>
      <h2 className="fw-bold mb-4">
        User Details: <span className="text-primary">{user.name}</span>
      </h2>

      <Row>
        <Col md={4}>
          <Card className="shadow-sm border-0 mb-4">
            <Card.Header>
              <h5 className="mb-0">User Profile</h5>
            </Card.Header>
            <ListGroup variant="flush">
              <ListGroup.Item>
                <strong>Email:</strong> {user.email}
              </ListGroup.Item>
              <ListGroup.Item>
                <strong>Role:</strong>{" "}
                <Badge bg="info">{user.role.toUpperCase()}</Badge>
              </ListGroup.Item>
              {user.company && (
                <ListGroup.Item>
                  <strong>Company:</strong>{" "}
                  <Link to={`/admin/companies/${user.company.id}`}>
                    {user.company.name}
                  </Link>
                </ListGroup.Item>
              )}
              <ListGroup.Item>
                <strong>Certificate Quota:</strong>{" "}
                <span className="fw-bold">{user.cert_quota}</span>
              </ListGroup.Item>
              <ListGroup.Item>
                <strong>Joined:</strong>{" "}
                {new Date(user.signup_date).toLocaleDateString()}
              </ListGroup.Item>
              <ListGroup.Item>
                <strong>Last Login:</strong>{" "}
                {user.last_login
                  ? new Date(user.last_login).toLocaleString()
                  : "Never"}
              </ListGroup.Item>
              <ListGroup.Item>
                <strong>Subscription Expiry:</strong>{" "}
                {user.subscription_expiry
                  ? new Date(user.subscription_expiry).toLocaleDateString()
                  : "N/A"}
              </ListGroup.Item>
            </ListGroup>
          </Card>
          <Card className="shadow-sm border-0">
            <Card.Header>
              <h5 className="mb-0">Manual Credit Adjustment</h5>
            </Card.Header>
            <Card.Body>
              <Form onSubmit={handleAdjustmentSubmit}>
                <Form.Group className="mb-3">
                  <Form.Label>Adjustment (+/-)</Form.Label>
                  <Form.Control
                    type="number"
                    name="amount"
                    placeholder="e.g., 50 or -10"
                    value={quotaAdjustment.amount}
                    onChange={handleAdjustmentChange}
                    required
                  />
                </Form.Group>
                <Form.Group className="mb-3">
                  <Form.Label>Reason</Form.Label>
                  <Form.Control
                    as="textarea"
                    rows={2}
                    name="reason"
                    placeholder="e.g., Goodwill gesture, promotional credits"
                    value={quotaAdjustment.reason}
                    onChange={handleAdjustmentChange}
                    required
                  />
                </Form.Group>
                <Button type="submit" variant="primary" className="w-100">
                  Adjust Quota
                </Button>
              </Form>
            </Card.Body>
          </Card>
        </Col>

        <Col md={8}>
          <Card className="shadow-sm border-0 mb-4">
            <Card.Header>
              <h5 className="mb-0">
                Certificates Issued ({certificates.length})
              </h5>
            </Card.Header>
            <Card.Body>
              <Table striped bordered hover responsive size="sm">
                <thead>
                  <tr>
                    <th>Recipient</th>
                    <th>Course</th>
                    <th>Status</th>
                    <th>Issued</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  {certificates.map((cert) => (
                    <tr key={cert.id}>
                      <td>{cert.recipient_name}</td>
                      <td>{cert.course_title}</td>
                      <td>
                        <Badge
                          bg={cert.status === "revoked" ? "danger" : "success"}
                        >
                          {cert.status}
                        </Badge>
                      </td>
                      <td>{new Date(cert.issue_date).toLocaleDateString()}</td>
                      <td>
                        <Button
                          variant="outline-primary"
                          size="sm"
                          href={`/verify/${cert.verification_id}`}
                          target="_blank"
                        >
                          View
                        </Button>
                        {cert.status !== "revoked" && (
                          <Button
                            variant="outline-danger"
                            size="sm"
                            className="ms-1"
                            onClick={() => handleRevoke(cert.id)}
                          >
                            Revoke
                          </Button>
                        )}
                      </td>
                    </tr>
                  ))}
                </tbody>
              </Table>
            </Card.Body>
          </Card>
          <Card className="shadow-sm border-0">
            <Card.Header>
              <h5 className="mb-0">Payment History ({payments.length})</h5>
            </Card.Header>
            <Card.Body>
              <Table striped bordered hover responsive size="sm">
                <thead>
                  <tr>
                    <th>Plan</th>
                    <th>Amount</th>
                    <th>Status</th>
                    <th>Date</th>
                    <th>Provider</th>
                  </tr>
                </thead>
                <tbody>
                  {payments.map((p) => (
                    <tr key={p.id}>
                      <td>{p.plan}</td>
                      <td>
                        {p.amount} {p.currency}
                      </td>
                      <td>
                        <Badge
                          bg={
                            p.status === "paid"
                              ? "success"
                              : p.status === "failed"
                              ? "danger"
                              : "warning"
                          }
                        >
                          {p.status}
                        </Badge>
                      </td>
                      <td>{new Date(p.date).toLocaleDateString()}</td>
                      <td>{p.provider}</td>
                    </tr>
                  ))}
                </tbody>
              </Table>
            </Card.Body>
          </Card>
        </Col>
      </Row>

      <Modal show={showConfirmModal} onHide={() => setShowConfirmModal(false)}>
        <Modal.Header closeButton>
          <Modal.Title>Confirm Action</Modal.Title>
        </Modal.Header>
        <Modal.Body>
          Are you sure you want to adjust the quota by{" "}
          <strong>{quotaAdjustment.amount}</strong> credits for the reason: "
          <em>{quotaAdjustment.reason}</em>"?
        </Modal.Body>
        <Modal.Footer>
          <Button
            variant="secondary"
            onClick={() => setShowConfirmModal(false)}
          >
            Cancel
          </Button>
          <Button variant="primary" onClick={confirmQuotaAdjustment}>
            Confirm Adjustment
          </Button>
        </Modal.Footer>
      </Modal>
    </div>
  );
}

export default AdminUserDetailsPage;



==================================================
FILE: pages\AdminUserManagementPage.jsx
==================================================

import React, { useState, useEffect } from "react";
import { useNavigate, Link } from "react-router-dom";
import {
  Card,
  Table,
  Badge,
  Button,
  Form,
  Modal,
  Dropdown,
  Spinner,
  Alert,
  Row,
  Col,
} from "react-bootstrap";
import {
  getAdminUsers,
  suspendAdminUser,
  unsuspendAdminUser,
  updateAdminUserPlan,
  deleteAdminUser,
} from "../api";

function AdminUserManagementPage() {
  const [users, setUsers] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState("");
  const [search, setSearch] = useState("");
  const [roleFilter, setRoleFilter] = useState("");
  const [statusFilter, setStatusFilter] = useState("");
  const [dateFilter, setDateFilter] = useState({
    start_date: "",
    end_date: "",
  });
  const [page, setPage] = useState(1);
  const [totalPages, setTotalPages] = useState(1);
  const navigate = useNavigate();

  useEffect(() => {
    fetchUsers();
  }, [search, roleFilter, statusFilter, page, dateFilter]);

  const fetchUsers = async () => {
    setLoading(true);
    try {
      const params = {
        search,
        role: roleFilter,
        status: statusFilter,
        page,
        limit: 10,
        start_date: dateFilter.start_date || null,
        end_date: dateFilter.end_date || null,
      };
      const filteredParams = Object.fromEntries(
        Object.entries(params).filter(([_, v]) => v != null && v !== "")
      );

      const res = await getAdminUsers(filteredParams);
      setUsers(res.data.users);
      setTotalPages(res.data.pages);
    } catch (err) {
      setError("Failed to fetch users");
    } finally {
      setLoading(false);
    }
  };

  const handleDateChange = (e) => {
    setDateFilter({ ...dateFilter, [e.target.name]: e.target.value });
  };

  const handleSuspend = async (userId) => {
    if (window.confirm("Are you sure you want to suspend this user?")) {
      try {
        await suspendAdminUser(userId);
        fetchUsers();
      } catch (err) {
        alert("Failed to suspend user");
      }
    }
  };

  const handleUnsuspend = async (userId) => {
    try {
      await unsuspendAdminUser(userId);
      fetchUsers();
    } catch (err) {
      alert("Failed to unsuspend user");
    }
  };

  const handlePlanChange = async (userId, newPlan) => {
    try {
      await updateAdminUserPlan(userId, newPlan);
      fetchUsers();
    } catch (err) {
      alert("Failed to update plan");
    }
  };

  const handleDelete = async (userId) => {
    if (
      window.confirm(
        "DANGER: Are you sure you want to permanently delete this user? This action cannot be undone."
      )
    ) {
      try {
        const res = await deleteAdminUser(userId);
        alert(res.data.msg);
        fetchUsers();
      } catch (err) {
        alert(err.response?.data?.msg || "Failed to delete user.");
      }
    }
  };

  if (loading && users.length === 0)
    return (
      <div className="text-center p-5">
        <Spinner animation="border" />
      </div>
    );
  if (error) return <Alert variant="danger">{error}</Alert>;

  return (
    <div>
      <h2 className="fw-bold mb-4">User Management</h2>
      <Card className="shadow-sm border-0 mb-4">
        <Card.Body>
          <Row className="mb-3 g-3">
            <Col md={4} lg={3}>
              <Form.Control
                type="text"
                placeholder="Search by name/email"
                value={search}
                onChange={(e) => setSearch(e.target.value)}
              />
            </Col>
            <Col md={2}>
              <Form.Select
                value={roleFilter}
                onChange={(e) => setRoleFilter(e.target.value)}
              >
                <option value="">All Roles</option>
                <option value="free">Free</option>
                <option value="starter">Starter</option>
                <option value="growth">Growth</option>
                <option value="pro">Pro</option>
                <option value="enterprise">Enterprise</option>
              </Form.Select>
            </Col>
            <Col md={2}>
              <Form.Select
                value={statusFilter}
                onChange={(e) => setStatusFilter(e.target.value)}
              >
                <option value="">All Status</option>
                <option value="active">Active</option>
                <option value="inactive">Suspended</option>
              </Form.Select>
            </Col>
            <Col md={4} lg={2}>
              <Form.Control
                type="date"
                name="start_date"
                value={dateFilter.start_date}
                onChange={handleDateChange}
              />
              <Form.Text muted>Start Date</Form.Text>
            </Col>
            <Col md={4} lg={2}>
              <Form.Control
                type="date"
                name="end_date"
                value={dateFilter.end_date}
                onChange={handleDateChange}
              />
              <Form.Text muted>End Date</Form.Text>
            </Col>
          </Row>

          <Table striped bordered hover responsive>
            <thead className="table-dark">
              <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Role/Plan</th>
                <th>Company</th>
                <th>Signup Date</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {users.map((user) => (
                <tr key={user.id}>
                  <td>{user.name}</td>
                  <td>{user.email}</td>
                  <td>
                    <Badge bg="primary">{user.role.toUpperCase()}</Badge>
                  </td>
                  <td>{user.company_name}</td>
                  <td>{new Date(user.signup_date).toLocaleDateString()}</td>
                  <td>
                    <Badge
                      bg={user.role === "suspended" ? "danger" : "success"}
                    >
                      {user.role === "suspended" ? "Suspended" : "Active"}
                    </Badge>
                  </td>
                  <td>
                    <Button
                      variant="info"
                      size="sm"
                      onClick={() => navigate(`/admin/users/${user.id}`)}
                    >
                      View
                    </Button>
                    <Dropdown className="ms-1 d-inline">
                      <Dropdown.Toggle
                        variant="outline-secondary"
                        size="sm"
                        id={`dropdown-actions-${user.id}`}
                      >
                        Actions
                      </Dropdown.Toggle>
                      <Dropdown.Menu>
                        <Dropdown.Item
                          className="text-danger"
                          onClick={() => handleDelete(user.id)}
                        >
                          Delete User
                        </Dropdown.Item>
                        {user.role !== "suspended" ? (
                          <Dropdown.Item
                            className="text-warning"
                            onClick={() => handleSuspend(user.id)}
                          >
                            Suspend User
                          </Dropdown.Item>
                        ) : (
                          <Dropdown.Item
                            className="text-success"
                            onClick={() => handleUnsuspend(user.id)}
                          >
                            Unsuspend User
                          </Dropdown.Item>
                        )}
                        <Dropdown.Divider />
                        <Dropdown.Header>Change Plan</Dropdown.Header>
                        {["free", "starter", "growth", "pro", "enterprise"].map(
                          (plan) => (
                            <Dropdown.Item
                              key={plan}
                              onClick={() => handlePlanChange(user.id, plan)}
                            >
                              {plan.toUpperCase()}
                            </Dropdown.Item>
                          )
                        )}
                      </Dropdown.Menu>
                    </Dropdown>
                  </td>
                </tr>
              ))}
            </tbody>
          </Table>

          <div className="d-flex justify-content-between">
            <Button disabled={page === 1} onClick={() => setPage(page - 1)}>
              Previous
            </Button>
            <span>
              Page {page} of {totalPages}
            </span>
            <Button
              disabled={page === totalPages}
              onClick={() => setPage(page + 1)}
            >
              Next
            </Button>
          </div>
        </Card.Body>
      </Card>
    </div>
  );
}

export default AdminUserManagementPage;



==================================================
FILE: pages\AdminVerifyPage.jsx
==================================================

import React, { useState } from "react";
import { useLocation, useNavigate } from "react-router-dom";
import { Form, Button, Alert, Spinner } from "react-bootstrap";
import { verifyAdmin } from "../api";
import "../styles/Auth.css";

function AdminVerifyPage() {
  const [code, setCode] = useState("");
  const [error, setError] = useState("");
  const [loading, setLoading] = useState(false);
  const navigate = useNavigate();
  const location = useLocation();

  // Get email from the navigation state passed from the signup page
  const email = location.state?.email;

  if (!email) {
    // If user lands here directly, redirect them
    navigate("/admin/login");
    return null;
  }

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError("");
    setLoading(true);

    try {
      await verifyAdmin({ email, code });
      // On success, redirect to login with a success message
      navigate("/admin/login", {
        state: { message: "Verification successful! Please log in." },
      });
    } catch (err) {
      setError(err.response?.data?.msg || "Verification failed.");
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="auth-container">
      <div className="auth-wrapper">
        <div className="auth-panel" style={{ backgroundColor: "#198754" }}>
          <h2>Verify Your Admin Account</h2>
          <p>
            An email with a 6-digit verification code has been sent to{" "}
            <strong>{email}</strong>.
          </p>
        </div>
        <div className="auth-form-container">
          <img
            src="/images/certbadge.png"
            alt="CertifyMe Logo"
            className="auth-logo mx-auto d-block"
            style={{ maxHeight: "35px" }}
          />
          <h3>Enter Verification Code</h3>
          {error && <Alert variant="danger">{error}</Alert>}
          <Form onSubmit={handleSubmit}>
            <Form.Group className="mb-4" controlId="code">
              <Form.Label>6-Digit Code</Form.Label>
              <Form.Control
                type="text"
                value={code}
                onChange={(e) => setCode(e.target.value)}
                placeholder="123456"
                required
                maxLength="6"
              />
            </Form.Group>
            <Button
              className="btn-auth w-100"
              style={{ backgroundColor: "#198754", borderColor: "#198754" }}
              type="submit"
              disabled={loading}
            >
              {loading ? <Spinner as="span" size="sm" /> : "Verify Account"}
            </Button>
          </Form>
        </div>
      </div>
    </div>
  );
}

export default AdminVerifyPage;



==================================================
FILE: pages\AnalyticsPage.jsx
==================================================

import React, { useState, useEffect } from "react";
import { Row, Col, Spinner, Alert } from "react-bootstrap";
import { Link } from "react-router-dom";
import { Radar, Doughnut, Line, Bar } from "react-chartjs-2";
import {
  Chart as ChartJS,
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
  BarElement,
  Title,
  Tooltip,
  Legend,
  Filler,
  RadialLinearScale,
  ArcElement,
} from "chart.js";
import { getUserAnalytics } from "../api";
import {
  Target,
  Award,
  BarChart2,
  Users,
  TrendingUp,
  Mail,
  FolderOpen,
  Clock,
  PieChart,
  Lock,
  ArrowUpRight,
  ArrowDownRight,
} from "lucide-react";

ChartJS.register(
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
  BarElement,
  Title,
  Tooltip,
  Legend,
  Filler,
  RadialLinearScale,
  ArcElement
);

const formatNumber = (num) => num?.toLocaleString() ?? "0";

// --- COMPONENTS ---

const StatCard = ({ title, value, icon: Icon, color, subtext, trend }) => (
  <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 h-100 transition-all hover:shadow-md">
    <div className="flex items-start justify-between mb-4">
      <div className={`p-3 rounded-lg ${color}`}>
        <Icon size={24} />
      </div>
      {trend && (
        <span
          className={`flex items-center text-sm font-medium ${
            trend > 0 ? "text-green-600" : "text-red-600"
          }`}
        >
          {trend > 0 ? (
            <ArrowUpRight size={16} className="mr-1" />
          ) : (
            <ArrowDownRight size={16} className="mr-1" />
          )}
          {Math.abs(trend)}%
        </span>
      )}
    </div>
    <h3 className="text-2xl font-bold text-gray-900 mb-1">{value}</h3>
    <p className="text-gray-500 text-sm font-medium mb-0">{title}</p>
    {subtext && <p className="text-xs text-gray-400 mt-2">{subtext}</p>}
  </div>
);

const ChartCard = ({ title, children, emptyMessage }) => (
  <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 h-100">
    <h4 className="text-lg font-bold text-gray-800 mb-6">{title}</h4>
    {children ? (
      <div className="w-100">{children}</div>
    ) : (
      <div className="h-64 flex flex-col items-center justify-center text-center bg-gray-50 rounded-lg border border-dashed border-gray-200">
        <BarChart2 className="text-gray-300 mb-3" size={48} />
        <p className="text-gray-500 font-medium">{emptyMessage}</p>
      </div>
    )}
  </div>
);

const UpgradePrompt = () => (
  <div className="flex flex-col items-center justify-center py-20 px-4 text-center bg-white rounded-xl shadow-sm border border-gray-200 relative overflow-hidden">
    <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-green-400 to-blue-500"></div>
    <div className="bg-green-50 p-4 rounded-full mb-6">
      <TrendingUp size={48} className="text-green-600" />
    </div>
    <h2 className="text-3xl font-bold text-gray-900 mb-4">
      Unlock Professional Insights
    </h2>
    <p className="text-gray-600 max-w-2xl text-lg mb-8">
      Gain a competitive edge with peer benchmarking, performance scores, and
      detailed issuance trends. See how you stack up against others and identify
      your top-performing programs.
    </p>
    <Link
      to="/dashboard/settings"
      state={{ defaultTab: "billing" }}
      className="inline-flex items-center px-8 py-3 bg-green-600 text-white rounded-lg font-bold text-lg hover:bg-green-700 transition-colors shadow-lg hover:shadow-xl transform hover:-translate-y-1"
    >
      <Lock size={20} className="mr-2" /> Upgrade to Pro
    </Link>
  </div>
);

const FullDashboard = ({ insights }) => {
  const {
    kpis,
    benchmarking,
    charts,
    status_breakdown,
    top_recipient,
    template_usage,
    group_stats,
    email_metrics,
    recent_activity,
  } = insights;

  // Calculate MoM Growth
  const momData = charts.certs_over_time.data;
  const currentMonth = momData[momData.length - 1];
  const prevMonth = momData[momData.length - 2];
  const momGrowth =
    prevMonth > 0
      ? (((currentMonth - prevMonth) / prevMonth) * 100).toFixed(1)
      : "0";

  // Chart Options
  const commonOptions = {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: {
        position: "bottom",
        labels: { usePointStyle: true, padding: 20 },
      },
    },
  };

  const radarData = {
    labels: benchmarking.labels,
    datasets: [
      {
        label: "You",
        data: benchmarking.user_data,
        backgroundColor: "rgba(79, 70, 229, 0.2)",
        borderColor: "#4F46E5",
        borderWidth: 2,
      },
      {
        label: "Peer Avg",
        data: benchmarking.peer_average_data,
        backgroundColor: "rgba(107, 114, 128, 0.2)",
        borderColor: "#6B7280",
        borderWidth: 2,
      },
    ],
  };

  const lineData = {
    labels: charts.certs_over_time.labels,
    datasets: [
      {
        label: "Issued",
        data: charts.certs_over_time.data,
        borderColor: "#0ea5e9",
        backgroundColor: "rgba(14, 165, 233, 0.1)",
        tension: 0.4,
        fill: true,
      },
    ],
  };

  return (
    <>
      <div className="mb-8">
        <h3 className="text-xl font-bold text-gray-900 mb-4 flex items-center gap-2">
          <div className="w-1 h-6 bg-indigo-600 rounded-full"></div>
          Core Performance
        </h3>
        <Row className="g-4">
          <Col md={3}>
            <StatCard
              title="Performance Score"
              value={kpis.performance_score}
              icon={Target}
              color="bg-indigo-50 text-indigo-600"
              subtext="Based on volume & consistency"
            />
          </Col>
          <Col md={3}>
            <StatCard
              title="Issuer Rank"
              value={`Top ${100 - kpis.percentile_rank}%`}
              icon={Award}
              color="bg-green-50 text-green-600"
              subtext="Compared to similar issuers"
            />
          </Col>
          <Col md={3}>
            <StatCard
              title="Total Certificates"
              value={formatNumber(kpis.total_certificates)}
              icon={BarChart2}
              color="bg-blue-50 text-blue-600"
              trend={momGrowth}
            />
          </Col>
          <Col md={3}>
            <StatCard
              title="Distinct Programs"
              value={formatNumber(kpis.total_programs)}
              icon={Users}
              color="bg-purple-50 text-purple-600"
            />
          </Col>
        </Row>
      </div>

      <div className="mb-8">
        <h3 className="text-xl font-bold text-gray-900 mb-4 flex items-center gap-2">
          <div className="w-1 h-6 bg-blue-600 rounded-full"></div>
          Operational Metrics
        </h3>
        <Row className="g-4">
          <Col md={3}>
            <StatCard
              title="Last 7 Days"
              value={formatNumber(recent_activity.last_7_days)}
              icon={Clock}
              color="bg-orange-50 text-orange-600"
            />
          </Col>
          <Col md={3}>
            <StatCard
              title="Email Delivery"
              value={`${email_metrics.send_rate}%`}
              icon={Mail}
              color="bg-teal-50 text-teal-600"
            />
          </Col>
          <Col md={3}>
            <StatCard
              title="Groups Created"
              value={formatNumber(group_stats.num_groups)}
              icon={FolderOpen}
              color="bg-gray-100 text-gray-600"
            />
          </Col>
          <Col md={3}>
            <StatCard
              title="Avg Certs / Group"
              value={group_stats.avg_certs_per_group}
              icon={PieChart}
              color="bg-pink-50 text-pink-600"
            />
          </Col>
        </Row>
      </div>

      <Row className="g-4 mb-8">
        <Col lg={4}>
          <ChartCard title="Performance Benchmarking">
            <div className="h-64">
              <Radar
                data={radarData}
                options={{
                  ...commonOptions,
                  scales: { r: { suggestedMin: 0, ticks: { display: false } } },
                }}
              />
            </div>
          </ChartCard>
        </Col>
        <Col lg={8}>
          <ChartCard title="Issuance Trends (12 Months)">
            <div className="h-64">
              <Line data={lineData} options={commonOptions} />
            </div>
          </ChartCard>
        </Col>
      </Row>

      <Row className="g-4 mb-8">
        <Col lg={6}>
          <ChartCard
            title="Top 5 Programs"
            emptyMessage="No program data available yet."
          >
            {charts.top_programs.data.length > 0 && (
              <div className="h-64">
                <Bar
                  data={{
                    labels: charts.top_programs.labels,
                    datasets: [
                      {
                        label: "Certificates",
                        data: charts.top_programs.data,
                        backgroundColor: "#3b82f6",
                        borderRadius: 4,
                      },
                    ],
                  }}
                  options={{ ...commonOptions, indexAxis: "y" }}
                />
              </div>
            )}
          </ChartCard>
        </Col>
        <Col lg={6}>
          <ChartCard
            title="Top Recipients"
            emptyMessage="No recipient data available yet."
          >
            {top_recipient.data.length > 0 && (
              <div className="h-64">
                <Bar
                  data={{
                    labels: top_recipient.labels,
                    datasets: [
                      {
                        label: "Certificates",
                        data: top_recipient.data,
                        backgroundColor: "#f59e0b",
                        borderRadius: 4,
                      },
                    ],
                  }}
                  options={{ ...commonOptions, indexAxis: "y" }}
                />
              </div>
            )}
          </ChartCard>
        </Col>
      </Row>

      <Row className="g-4 mb-8">
        <Col md={6}>
          <ChartCard
            title="Status Breakdown"
            emptyMessage="No status data yet."
          >
            {status_breakdown.data.length > 0 && (
              <div className="h-64">
                <Doughnut
                  data={{
                    labels: status_breakdown.labels,
                    datasets: [
                      {
                        data: status_breakdown.data,
                        backgroundColor: ["#22c55e", "#eab308", "#ef4444"],
                      },
                    ],
                  }}
                  options={commonOptions}
                />
              </div>
            )}
          </ChartCard>
        </Col>
        <Col md={6}>
          <ChartCard
            title="Template Usage"
            emptyMessage="No template data yet."
          >
            {template_usage.data.length > 0 && (
              <div className="h-64">
                <Doughnut
                  data={{
                    labels: template_usage.labels,
                    datasets: [
                      {
                        data: template_usage.data,
                        backgroundColor: [
                          "#6366f1",
                          "#ec4899",
                          "#8b5cf6",
                          "#14b8a6",
                          "#f97316",
                        ],
                      },
                    ],
                  }}
                  options={commonOptions}
                />
              </div>
            )}
          </ChartCard>
        </Col>
      </Row>
    </>
  );
};

function AnalyticsPage() {
  const [analyticsData, setAnalyticsData] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState("");

  useEffect(() => {
    const fetchAnalytics = async () => {
      setLoading(true);
      try {
        const res = await getUserAnalytics();
        setAnalyticsData(res.data);
      } catch (err) {
        setError(err.response?.data?.msg || "Failed to fetch analytics data.");
      } finally {
        setLoading(false);
      }
    };
    fetchAnalytics();
  }, []);

  if (loading)
    return (
      <div className="flex flex-col items-center justify-center min-h-[60vh]">
        <Spinner animation="border" variant="primary" className="mb-3" />
        <p className="text-gray-500 font-medium">Crunching the numbers...</p>
      </div>
    );
  if (error) return <Alert variant="danger">{error}</Alert>;
  if (!analyticsData)
    return <Alert variant="info">No analytics data found.</Alert>;

  return (
    <div className="max-w-7xl mx-auto pb-12">
      <div className="flex items-center gap-4 mb-8">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">Analytics</h1>
          <p className="text-gray-500 text-sm">
            Visualize your issuance data and performance.
          </p>
        </div>
      </div>

      {analyticsData.upgrade_required ? (
        <UpgradePrompt />
      ) : (
        <FullDashboard insights={analyticsData} />
      )}
    </div>
  );
}

export default AnalyticsPage;



==================================================
FILE: pages\BulkCreateCertificatesPage.jsx
==================================================

import React, { useState, useEffect } from "react";
import { Form, Button, Alert, Spinner, Table, Modal } from "react-bootstrap";
import { useNavigate, Link } from "react-router-dom";
import Papa from "papaparse";
import QRCode from "react-qr-code";
import {
  Maximize2,
  X,
  Info,
  CheckCircle,
  UploadCloud,
  Download,
  FileSpreadsheet,
  ArrowLeft,
  LayoutTemplate,
  Users,
  Eye,
  AlertCircle,
} from "lucide-react";
import { SERVER_BASE_URL } from "../config";
import {
  getTemplates,
  bulkCreateCertificates,
  getGroups,
  createGroup,
  downloadBulkTemplate,
} from "../api";
import toast, { Toaster } from "react-hot-toast";
import KonvaPreview from "../components/KonvaPreview";

const CertificatePreview = ({ template, formData }) => {
  if (!template) {
    return (
      <div className="flex flex-col items-center justify-center h-full bg-gray-50/50 rounded-xl border-2 border-dashed border-gray-200 p-12 text-center text-gray-400">
        <LayoutTemplate className="w-12 h-12 mb-3 opacity-20" />
        <p className="font-medium">Select a template to generate preview</p>
      </div>
    );
  }

  const data =
    formData && formData.recipient_name
      ? formData
      : {
          recipient_name: "Recipient Name",
          course_title: "Course Title",
          issue_date: new Date().toLocaleDateString(),
          issuer_name: "Issuer Name",
          signature: "Signature",
          verification_id: "pending-id",
        };

  if (template.layout_style === "visual") {
    return (
      <div className="shadow-lg rounded-lg overflow-hidden h-full bg-white">
        <KonvaPreview layoutData={template.layout_data} dynamicData={data} />
      </div>
    );
  }

  const {
    layout_style,
    primary_color = "#2563EB",
    secondary_color = "#64748B",
    body_font_color = "#333333",
    font_family = "Georgia",
    background_url,
    logo_url,
    custom_text,
  } = template;

  const certificateTitle = custom_text?.title || "Certificate of Completion";
  const certificateBody =
    custom_text?.body || "has successfully completed the course";

  const textStyle = { color: body_font_color, fontFamily: font_family };
  const backgroundStyle = {
    backgroundImage: background_url
      ? `url(${SERVER_BASE_URL}${background_url})`
      : "none",
    backgroundSize: "cover",
    backgroundPosition: "center",
  };

  const renderClassic = () => (
    <div
      className="h-full w-full bg-white relative flex flex-col shadow-xl overflow-hidden"
      style={{
        border: `8px double ${primary_color}`,
        ...backgroundStyle,
        fontFamily: font_family,
      }}
    >
      <div
        style={{
          height: "12px",
          borderBottom: `4px solid ${primary_color}`,
          background: `linear-gradient(to right, ${primary_color}, ${secondary_color})`,
        }}
      />
      <div className="flex-grow flex flex-col justify-center items-center text-center p-6">
        {logo_url && (
          <img
            src={`${SERVER_BASE_URL}${logo_url}`}
            alt="Logo"
            className="mb-4 object-contain h-20 w-20"
          />
        )}
        <h1
          className="font-bold uppercase tracking-wider text-2xl mb-1"
          style={{ color: primary_color }}
        >
          {certificateTitle}
        </h1>
        <p className="italic text-sm mb-2" style={{ color: "#4B5EAA" }}>
          This is to certify that
        </p>
        <h2
          className="font-extrabold text-3xl mb-2"
          style={{ fontFamily: "'Georgia', serif", ...textStyle }}
        >
          {data.recipient_name}
        </h2>
        <p className="italic text-sm mb-2" style={{ color: "#4B5EAA" }}>
          {certificateBody}
        </p>
        <p
          className="font-bold uppercase text-xl mb-4"
          style={{ color: secondary_color }}
        >
          {data.course_title}
        </p>
        <p className="text-sm mb-6" style={{ color: body_font_color }}>
          Awarded on {data.issue_date}
        </p>
        <div className="flex justify-between w-full mt-auto pt-4 px-8 border-t border-gray-100">
          <div className="text-center w-1/3">
            <p className="font-semibold text-sm" style={textStyle}>
              {data.signature}
            </p>
            <span className="text-gray-400 text-xs uppercase tracking-wide">
              Signature
            </span>
          </div>
          <div className="text-center w-1/3">
            <p className="font-semibold text-sm" style={textStyle}>
              {data.issuer_name}
            </p>
            <span className="text-gray-400 text-xs uppercase tracking-wide">
              Issuer
            </span>
          </div>
        </div>
      </div>
    </div>
  );

  const renderModern = () => (
    <div
      className="flex h-full w-full shadow-lg rounded-xl overflow-hidden bg-white"
      style={{
        border: `6px solid ${primary_color}`,
        ...backgroundStyle,
        fontFamily: font_family,
      }}
    >
      <div
        className="w-[35%] flex flex-col justify-between items-center p-4 text-white"
        style={{
          background: `linear-gradient(135deg, ${primary_color}, ${secondary_color})`,
        }}
      >
        <div className="text-center">
          {logo_url && (
            <img
              src={`${SERVER_BASE_URL}${logo_url}`}
              className="w-16 h-16 rounded-full border-4 border-white shadow mb-2 object-cover bg-white"
              alt="Logo"
            />
          )}
          <p className="font-bold uppercase text-xs tracking-wider opacity-90">
            {data.issuer_name}
          </p>
        </div>
        <div className="bg-white p-1 rounded shadow">
          <QRCode
            value={`${window.location.origin}/verify/${data.verification_id}`}
            size={64}
            viewBox="0 0 64 64"
          />
        </div>
      </div>
      <div className="flex-grow p-6 flex flex-col justify-center relative bg-white/95">
        <h1
          className="font-light uppercase tracking-widest text-lg mb-4"
          style={{ color: primary_color }}
        >
          {certificateTitle}
        </h1>
        <h2
          className="font-bold text-3xl mb-3 leading-tight"
          style={{ fontFamily: "'Georgia', serif", ...textStyle }}
        >
          {data.recipient_name}
        </h2>
        <p className="italic text-sm text-gray-600 mb-4">{certificateBody}</p>
        <p
          className="font-bold uppercase text-lg tracking-wide mb-6"
          style={{ color: secondary_color }}
        >
          {data.course_title}
        </p>
        <div
          className="flex justify-between mt-auto pt-4 border-t-2"
          style={{ borderColor: primary_color }}
        >
          <div>
            <p className="font-bold text-sm" style={textStyle}>
              {data.signature}
            </p>
            <p className="text-gray-500 text-xs uppercase tracking-wide">
              Signature
            </p>
          </div>
          <div className="text-right">
            <p className="font-bold text-sm" style={textStyle}>
              {data.issuer_name}
            </p>
            <p className="text-gray-500 text-xs uppercase tracking-wide">
              Issuer
            </p>
          </div>
        </div>
      </div>
    </div>
  );

  const renderReceipt = () => (
    <div
      className="h-full w-full bg-white relative flex flex-col shadow-xl overflow-hidden text-sm"
      style={{ fontFamily: "sans-serif" }}
    >
      <div className="p-8 h-full flex flex-col">
        <div className="flex justify-between items-start mb-6">
          <div>
            {logo_url ? (
              <img
                src={`${SERVER_BASE_URL}${logo_url}`}
                className="h-12 object-contain mb-2"
                alt="Logo"
              />
            ) : (
              <h2
                className="text-xl font-bold"
                style={{ color: primary_color }}
              >
                {data.issuer_name}
              </h2>
            )}
          </div>
          <div className="text-right text-gray-500 text-xs">
            <p className="font-bold text-base text-gray-800">
              {data.issuer_name}
            </p>
            <p>Receipt</p>
            <p>{data.issue_date}</p>
          </div>
        </div>
        <div
          className="flex justify-between items-center p-3 rounded mb-6"
          style={{ background: primary_color, color: "white" }}
        >
          <span className="font-bold text-lg tracking-wider">
            {certificateTitle}
          </span>
          <span className="font-mono opacity-80">
            #{data.verification_id.substring(0, 8).toUpperCase()}
          </span>
        </div>
        <div className="flex justify-between mb-6">
          <div>
            <p className="text-xs font-bold text-gray-400 uppercase">Bill To</p>
            <p className="font-bold text-lg text-gray-800">
              {data.recipient_name}
            </p>
          </div>
          <div className="text-right">
            <p className="text-xs font-bold text-gray-400 uppercase">Status</p>
            <p className="font-bold text-green-600">PAID</p>
          </div>
        </div>
        <div className="border-b border-gray-200 mb-2">
          <div className="flex justify-between py-2 bg-gray-50 px-2 font-bold text-gray-500 text-xs uppercase">
            <span>Description</span>
            <span>Amount</span>
          </div>
          <div className="flex justify-between py-4 px-2">
            <span className="font-medium text-gray-800">
              {data.course_title}
            </span>
            <span className="font-bold" style={{ color: primary_color }}>
              {data.amount || "PAID"}
            </span>
          </div>
        </div>
        <div className="flex justify-end mt-4 mb-auto">
          <div className="w-1/2 flex justify-between border-t-2 border-gray-800 pt-2">
            <span className="font-bold text-lg">Total</span>
            <span
              className="font-bold text-lg"
              style={{ color: primary_color }}
            >
              {data.amount || "PAID"}
            </span>
          </div>
        </div>
        <div className="border-t border-gray-200 pt-4 mt-4 flex justify-between items-end">
          <div className="text-xs text-gray-400">
            <p>Auth Signature: {data.signature}</p>
            <p className="font-mono mt-1">ID: {data.verification_id}</p>
          </div>
          <QRCode
            value={`${window.location.origin}/verify/${data.verification_id}`}
            size={48}
          />
        </div>
      </div>
    </div>
  );

  // Correct switching logic
  if (layout_style === "receipt") return renderReceipt();
  if (layout_style === "modern") return renderModern();
  return renderClassic();
};

const BulkCreateCertificatesPage = () => {
  const [templates, setTemplates] = useState([]);
  const [selectedTemplateId, setSelectedTemplateId] = useState("");
  const [selectedTemplate, setSelectedTemplate] = useState(null);
  const [file, setFile] = useState(null);
  const [previewData, setPreviewData] = useState([]);
  const [loading, setLoading] = useState(true);
  const [submitting, setSubmitting] = useState(false);
  const [error, setError] = useState("");
  const [success, setSuccess] = useState("");
  const [showFullscreen, setShowFullscreen] = useState(false);
  const [groups, setGroups] = useState([]);
  const [selectedGroupId, setSelectedGroupId] = useState("");
  const [newGroupName, setNewGroupName] = useState("");
  const navigate = useNavigate();

  useEffect(() => {
    const fetchData = async () => {
      setLoading(true);
      try {
        const [templateRes, groupRes] = await Promise.all([
          getTemplates(),
          getGroups(),
        ]);
        setTemplates(templateRes.data.templates);
        setGroups(groupRes.data.groups);
      } catch (err) {
        setError("Failed to load initial data.");
      } finally {
        setLoading(false);
      }
    };
    fetchData();
  }, []);

  const handleTemplateChange = (e) => {
    const templateId = e.target.value;
    setSelectedTemplateId(templateId);
    setSelectedTemplate(
      templates.find((t) => String(t.id) === String(templateId))
    );
  };

  const handleFileChange = (e) => {
    const selectedFile = e.target.files[0];
    setError("");
    setSuccess("");
    setPreviewData([]);

    if (selectedFile) {
      setFile(selectedFile);
      if (selectedFile.name.toLowerCase().endsWith(".csv")) {
        Papa.parse(selectedFile, {
          header: true,
          skipEmptyLines: true,
          complete: (result) => {
            if (result.errors.length > 0) {
              setError("Could not parse CSV for preview.");
              return;
            }
            // Normalize for preview
            const normalizedData = result.data.map((row) => {
              const newRow = {};
              Object.keys(row).forEach((key) => {
                let newKey = key.trim().toLowerCase().replace(/ /g, "_");
                if (["name", "student", "full_name"].includes(newKey))
                  newKey = "recipient_name";
                if (["course", "program", "event"].includes(newKey))
                  newKey = "course_title";
                if (["date", "issued_on"].includes(newKey))
                  newKey = "issue_date";
                newRow[newKey] = row[key];
              });
              return newRow;
            });
            setPreviewData(normalizedData);
          },
          error: () => setError("Failed to parse CSV file."),
        });
      }
    }
  };

  const handleCreateGroup = async () => {
    if (!newGroupName.trim()) return toast.error("Please enter a group name.");
    const promise = createGroup(newGroupName);
    toast.promise(promise, {
      loading: "Creating group...",
      success: (res) => {
        const newGroup = res.data.group;
        setGroups((prev) => [newGroup, ...prev]);
        setSelectedGroupId(newGroup.id);
        setNewGroupName("");
        return "Group created!";
      },
      error: "Failed to create group.",
    });
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    if (!selectedTemplateId || !file || !selectedGroupId) {
      setError("Please fill all required fields.");
      return;
    }
    setSubmitting(true);
    setError("");

    const formData = new FormData();
    formData.append("template_id", selectedTemplateId);
    formData.append("group_id", selectedGroupId);
    formData.append("file", file);

    try {
      const response = await bulkCreateCertificates(formData);
      if (response.status === 207) {
        const { msg, created, errors } = response.data;
        const errorDetails = errors
          .map((err) => `Row ${err.row}: ${err.msg}`)
          .join("\n");
        setError(
          <>
            <strong>{msg}</strong> (Created: {created})
            <pre className="mt-2 bg-red-50 p-2 rounded text-xs text-red-600 max-h-32 overflow-y-auto">
              {errorDetails}
            </pre>
          </>
        );
      } else {
        toast.success(`${response.data.created} certificates created!`);
        setTimeout(() => navigate("/dashboard"), 2000);
      }
    } catch (err) {
      setError(err.response?.data?.msg || "An unexpected error occurred.");
    } finally {
      setSubmitting(false);
    }
  };

  const handleDownloadTemplate = async () => {
    toast.promise(downloadBulkTemplate(), {
      loading: "Downloading template...",
      success: (response) => {
        const url = window.URL.createObjectURL(new Blob([response.data]));
        const link = document.createElement("a");
        link.href = url;
        link.setAttribute("download", "bulk_upload_template.csv");
        document.body.appendChild(link);
        link.click();
        link.parentNode.removeChild(link);
        return "Download started!";
      },
      error: "Download failed.",
    });
  };

  if (loading)
    return (
      <div className="min-h-[60vh] flex items-center justify-center">
        <Spinner animation="border" variant="primary" />
      </div>
    );

  return (
    <div className="max-w-7xl mx-auto pb-12">
      <Toaster position="top-right" />

      {/* Header */}
      <div className="flex items-center gap-4 mb-8">
        <Link
          to="/dashboard"
          className="p-2 rounded-full hover:bg-gray-100 text-gray-500 transition-colors"
        >
          <ArrowLeft size={24} />
        </Link>
        <div>
          <h1 className="text-2xl font-bold text-gray-900">
            Bulk Create Certificates
          </h1>
          <p className="text-gray-500 text-sm">
            Upload a spreadsheet to generate hundreds of certificates at once.
          </p>
        </div>
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">
        {/* LEFT COLUMN: FORM */}
        <div className="lg:col-span-4 space-y-6">
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <Form onSubmit={handleSubmit} className="space-y-6">
              {/* Step 1: Template */}
              <div>
                <label className="flex items-center gap-2 text-sm font-semibold text-gray-900 mb-2">
                  <span className="bg-indigo-100 text-indigo-700 w-6 h-6 rounded-full flex items-center justify-center text-xs">
                    1
                  </span>
                  Select Template
                </label>
                <div className="relative">
                  <LayoutTemplate
                    className="absolute left-3 top-3 text-gray-400"
                    size={18}
                  />
                  <select
                    className="w-full pl-10 pr-4 py-2.5 bg-white border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none text-sm appearance-none"
                    value={selectedTemplateId}
                    onChange={handleTemplateChange}
                    required
                  >
                    <option value="">Choose a template...</option>
                    {templates.map((t) => (
                      <option key={t.id} value={t.id}>
                        {t.title} {t.is_public ? "(System)" : ""}
                      </option>
                    ))}
                  </select>
                </div>
              </div>

              {/* Step 2: Group */}
              <div>
                <label className="flex items-center gap-2 text-sm font-semibold text-gray-900 mb-2">
                  <span className="bg-indigo-100 text-indigo-700 w-6 h-6 rounded-full flex items-center justify-center text-xs">
                    2
                  </span>
                  Assign Group
                </label>
                <div className="space-y-3">
                  <div className="relative">
                    <Users
                      className="absolute left-3 top-3 text-gray-400"
                      size={18}
                    />
                    <select
                      className="w-full pl-10 pr-4 py-2.5 bg-white border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none text-sm appearance-none"
                      value={selectedGroupId}
                      onChange={(e) => setSelectedGroupId(e.target.value)}
                      required
                    >
                      <option value="">Choose existing group...</option>
                      {groups.map((g) => (
                        <option key={g.id} value={g.id}>
                          {g.name}
                        </option>
                      ))}
                    </select>
                  </div>
                  <div className="flex gap-2">
                    <input
                      type="text"
                      placeholder="Or create new..."
                      value={newGroupName}
                      onChange={(e) => setNewGroupName(e.target.value)}
                      className="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 outline-none"
                    />
                    <button
                      type="button"
                      onClick={handleCreateGroup}
                      className="px-3 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors"
                    >
                      Create
                    </button>
                  </div>
                </div>
              </div>

              {/* Step 3: File */}
              <div>
                <label className="flex items-center gap-2 text-sm font-semibold text-gray-900 mb-2">
                  <span className="bg-indigo-100 text-indigo-700 w-6 h-6 rounded-full flex items-center justify-center text-xs">
                    3
                  </span>
                  Upload Data
                </label>
                <div className="border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-indigo-500 hover:bg-indigo-50 transition-all cursor-pointer relative">
                  <input
                    type="file"
                    accept=".csv,.xlsx,.xls"
                    onChange={handleFileChange}
                    className="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
                    required
                  />
                  <FileSpreadsheet
                    className="mx-auto text-gray-400 mb-2"
                    size={32}
                  />
                  <p className="text-sm font-medium text-gray-700">
                    {file ? file.name : "Click to upload spreadsheet"}
                  </p>
                  <p className="text-xs text-gray-500 mt-1">CSV, Excel</p>
                </div>
                <button
                  type="button"
                  onClick={handleDownloadTemplate}
                  className="text-indigo-600 hover:text-indigo-700 text-xs font-medium flex items-center gap-1 mt-2 ml-1"
                >
                  <Download size={12} /> Download sample template
                </button>
              </div>

              {/* Status Messages */}
              {error && (
                <div className="bg-red-50 p-4 rounded-lg flex items-start gap-3 text-sm text-red-700 border border-red-100">
                  <AlertCircle size={18} className="mt-0.5 shrink-0" />
                  <div className="flex-1">{error}</div>
                </div>
              )}

              <button
                type="submit"
                disabled={submitting}
                className="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-lg flex items-center justify-center gap-2 transition-all shadow-sm hover:shadow disabled:opacity-70 disabled:cursor-not-allowed"
              >
                {submitting ? <Spinner size="sm" /> : <UploadCloud size={20} />}
                <span>Start Bulk Process</span>
              </button>
            </Form>
          </div>
        </div>

        {/* RIGHT COLUMN: PREVIEW */}
        <div className="lg:col-span-8 space-y-6">
          {/* Certificate Preview */}
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 sticky top-6">
            <div className="flex justify-between items-center mb-6">
              <h3 className="font-bold text-gray-800 flex items-center gap-2">
                <Eye size={18} className="text-indigo-600" />
                Live Preview
                <span className="text-xs font-normal text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full">
                  Row 1 Data
                </span>
              </h3>
              {selectedTemplate && (
                <button
                  onClick={() => setShowFullscreen(true)}
                  className="text-gray-500 hover:text-indigo-600 p-2 rounded-lg hover:bg-indigo-50 transition-colors"
                >
                  <Maximize2 size={18} />
                </button>
              )}
            </div>

            <div className="bg-gray-100 rounded-lg border border-gray-200 p-4 flex items-center justify-center min-h-[300px]">
              <div className="w-full shadow-lg max-w-2xl transition-all duration-300">
                <CertificatePreview
                  template={selectedTemplate}
                  formData={previewData[0]}
                />
              </div>
            </div>
          </div>

          {/* Data Table Preview */}
          {previewData.length > 0 && (
            <div className="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
              <div className="px-6 py-4 border-b border-gray-200 bg-gray-50 flex justify-between items-center">
                <h4 className="font-bold text-gray-700 text-sm uppercase tracking-wide">
                  Data Snapshot
                </h4>
                <span className="text-xs text-gray-500">
                  Showing first 5 rows
                </span>
              </div>
              <div className="overflow-x-auto">
                <Table hover responsive className="mb-0 text-sm">
                  <thead className="bg-gray-50 text-gray-500">
                    <tr>
                      {Object.keys(previewData[0]).map((key) => (
                        <th
                          key={key}
                          className="font-medium px-6 py-3 uppercase text-xs tracking-wider whitespace-nowrap"
                        >
                          {key.replace(/_/g, " ")}
                        </th>
                      ))}
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-100">
                    {previewData.slice(0, 5).map((row, index) => (
                      <tr key={index}>
                        {Object.values(row).map((val, i) => (
                          <td
                            key={i}
                            className="px-6 py-3 text-gray-600 whitespace-nowrap"
                          >
                            {val}
                          </td>
                        ))}
                      </tr>
                    ))}
                  </tbody>
                </Table>
              </div>
            </div>
          )}
        </div>
      </div>

      {/* Fullscreen Modal */}
      <Modal
        show={showFullscreen}
        onHide={() => setShowFullscreen(false)}
        size="xl"
        centered
        contentClassName="bg-transparent border-0"
      >
        <div className="relative w-full max-w-5xl mx-auto">
          <button
            onClick={() => setShowFullscreen(false)}
            className="absolute -top-12 right-0 text-white hover:text-gray-300 p-2"
          >
            <X size={32} />
          </button>
          <div className="shadow-2xl rounded-lg overflow-hidden bg-white">
            <CertificatePreview
              template={selectedTemplate}
              formData={previewData[0]}
            />
          </div>
        </div>
      </Modal>
    </div>
  );
};

export default BulkCreateCertificatesPage;



==================================================
FILE: pages\ContactPage.jsx
==================================================

import React, { useState } from "react";
import { Link } from "react-router-dom";
import PublicHeader from "../components/PublicHeader";
import PublicFooter from "../components/PublicFooter";
import toast, { Toaster } from "react-hot-toast";
import { sendContactMessage } from "../api";
import {
  Mail,
  User,
  MessageSquare,
  Send,
  Loader2,
  CheckCircle,
  AlertTriangle,
} from "lucide-react";

const ContactPage = () => {
  const [formData, setFormData] = useState({
    name: "",
    email: "",
    message: "",
  });
  const [loading, setLoading] = useState(false);
  const [submitted, setSubmitted] = useState(false);

  const handleChange = (e) => {
    setFormData({ ...formData, [e.target.name]: e.target.value });
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    setLoading(true);
    try {
      await sendContactMessage(formData);
      setSubmitted(true);
    } catch (error) {
      toast.error(error.response?.data?.msg || "Something went wrong.");
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="bg-gray-50 min-h-screen flex flex-col font-sans">
      <Toaster position="top-right" />
      <PublicHeader />

      <main className="flex-grow flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
        <div className="max-w-4xl w-full mx-auto grid lg:grid-cols-2 gap-12 items-center">
          {/* Left Side: Info */}
          <div className="text-center lg:text-left">
            <h1 className="text-4xl md:text-5xl font-extrabold text-gray-900 tracking-tight">
              Get in touch
            </h1>
            <p className="mt-4 text-lg text-gray-600">
              Have a question, a feature request, or need help with a
              large-scale deployment? Our team is ready to help.
            </p>
            <div className="mt-8 border-t border-gray-200 pt-8 space-y-6">
              <div className="flex items-start gap-4">
                <div className="bg-indigo-50 text-indigo-600 p-3 rounded-xl">
                  <Mail size={24} />
                </div>
                <div>
                  <h3 className="font-bold text-gray-900">Email Us</h3>
                  <p className="text-gray-500">
                    For direct inquiries, reach out to our support inbox.
                  </p>
                  <a
                    href="mailto:hello.certifyme@gmail.com"
                    className="font-medium text-indigo-600 hover:text-indigo-800"
                  >
                    hello.certifyme@gmail.com
                  </a>
                </div>
              </div>
            </div>
          </div>

          {/* Right Side: Form */}
          <div className="bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden">
            {submitted ? (
              <div className="p-8 md:p-12 text-center">
                <CheckCircle
                  size={56}
                  className="text-green-500 mx-auto mb-6"
                />
                <h2 className="text-2xl font-bold text-gray-900 mb-2">
                  Message Sent!
                </h2>
                <p className="text-gray-600">
                  Thank you for reaching out. We've received your message and
                  will get back to you as soon as possible.
                </p>
              </div>
            ) : (
              <form onSubmit={handleSubmit} className="p-8 md:p-10 space-y-6">
                <h2 className="text-2xl font-bold text-gray-900 mb-1">
                  Send a Message
                </h2>
                <p className="text-sm text-gray-500 -mt-2">
                  We typically reply within 24 hours.
                </p>

                <FormInput
                  label="Full Name"
                  name="name"
                  icon={User}
                  value={formData.name}
                  onChange={handleChange}
                  required
                />
                <FormInput
                  label="Email Address"
                  name="email"
                  type="email"
                  icon={Mail}
                  value={formData.email}
                  onChange={handleChange}
                  required
                />

                <div>
                  <label
                    htmlFor="message"
                    className="block text-sm font-medium text-gray-700 mb-1.5 flex items-center gap-2"
                  >
                    <MessageSquare size={18} className="text-gray-400" /> Your
                    Message
                  </label>
                  <textarea
                    id="message"
                    name="message"
                    rows="5"
                    required
                    value={formData.message}
                    onChange={handleChange}
                    className="block w-full rounded-lg border border-gray-300 bg-white py-2.5 px-3 text-gray-900 placeholder-gray-400 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 focus:outline-none transition-all duration-200 sm:text-sm"
                    placeholder="How can we help you today?"
                  ></textarea>
                </div>

                <button
                  type="submit"
                  disabled={loading}
                  className="w-full flex justify-center items-center gap-2 py-3 px-4 border border-transparent rounded-lg shadow-sm text-base font-bold text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-70"
                >
                  {loading ? (
                    <Loader2 className="animate-spin" />
                  ) : (
                    <Send size={18} />
                  )}
                  {loading ? "Sending..." : "Send Message"}
                </button>
              </form>
            )}
          </div>
        </div>
      </main>

      <PublicFooter />
    </div>
  );
};

const FormInput = ({ label, icon: Icon, required, ...props }) => (
  <div>
    <label
      htmlFor={props.name}
      className="block text-sm font-medium text-gray-700 mb-1.5 flex items-center gap-2"
    >
      <Icon size={18} className="text-gray-400" /> {label}
    </label>
    <input
      id={props.name}
      required={required}
      {...props}
      className="block w-full rounded-lg border border-gray-300 bg-white py-2.5 px-3 text-gray-900 placeholder-gray-400 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 focus:outline-none transition-all duration-200 sm:text-sm"
    />
  </div>
);

export default ContactPage;



==================================================
FILE: pages\ContactSupportPage.jsx
==================================================

import React, { useState, useEffect, useRef } from "react";
import { useParams, useNavigate, Link } from "react-router-dom";
import {
  Card,
  Form,
  Button,
  Spinner,
  Row,
  Col,
  InputGroup,
  Image,
  Container,
} from "react-bootstrap";
import {
  PlusCircle,
  ArrowLeft,
  Send,
  User,
  Paperclip,
  Trash2,
  MessageCircle,
  Clock,
  CheckCircle,
  AlertCircle,
  FileText,
  CornerDownRight,
  Shield,
} from "lucide-react";
import {
  createUserTicket,
  getUserTickets,
  getUserTicketDetails,
  replyToTicket,
  deleteUserTicket,
} from "../api";
import toast, { Toaster } from "react-hot-toast";

// Main component that decides whether to show the list or details
function ContactSupportPage() {
  const { ticketId } = useParams();
  if (ticketId) {
    return <TicketDetails />;
  }
  return <TicketList />;
}

// Component to show the list of tickets and the creation form
function TicketList() {
  const [tickets, setTickets] = useState([]);
  const [loading, setLoading] = useState(true);
  const [subject, setSubject] = useState("");
  const [message, setMessage] = useState("");
  const [file, setFile] = useState(null);
  const [submitting, setSubmitting] = useState(false);

  useEffect(() => {
    fetchTickets();
  }, []);

  const fetchTickets = async () => {
    setLoading(true);
    try {
      const res = await getUserTickets();
      setTickets(res.data);
    } catch (err) {
      toast.error("Failed to fetch support tickets.");
    } finally {
      setLoading(false);
    }
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    if (!subject.trim() || !message.trim()) {
      toast.error("Subject and message cannot be empty.");
      return;
    }
    setSubmitting(true);
    const formData = new FormData();
    formData.append("subject", subject);
    formData.append("message", message);
    if (file) {
      formData.append("file", file);
    }

    try {
      await createUserTicket(formData);
      toast.success("Support ticket created!");
      setSubject("");
      setMessage("");
      setFile(null);
      fetchTickets();
    } catch (err) {
      toast.error(
        err.response?.data?.msg || "Failed to create ticket. Please try again."
      );
    } finally {
      setSubmitting(false);
    }
  };

  const handleFileChange = (e) => {
    const selectedFile = e.target.files[0];
    if (selectedFile) {
      setFile(selectedFile);
    } else {
      setFile(null);
    }
    e.target.value = null;
  };

  const handleDelete = async (e, ticketId) => {
    e.stopPropagation();
    e.preventDefault();

    if (
      window.confirm(
        "Are you sure you want to delete this ticket? This action cannot be undone."
      )
    ) {
      try {
        await deleteUserTicket(ticketId);
        toast.success("Ticket deleted successfully!");
        setTickets((prevTickets) =>
          prevTickets.filter((ticket) => ticket.id !== ticketId)
        );
      } catch (err) {
        toast.error("Failed to delete the ticket.");
      }
    }
  };

  const getStatusBadge = (status) => {
    switch (status) {
      case "open":
        return "bg-blue-100 text-blue-700";
      case "in_progress":
        return "bg-yellow-100 text-yellow-700";
      case "closed":
        return "bg-gray-100 text-gray-600";
      default:
        return "bg-gray-100 text-gray-600";
    }
  };

  const getStatusIcon = (status) => {
    switch (status) {
      case "open":
        return <AlertCircle size={14} className="mr-1" />;
      case "in_progress":
        return <Clock size={14} className="mr-1" />;
      case "closed":
        return <CheckCircle size={14} className="mr-1" />;
      default:
        return null;
    }
  };

  return (
    <div className="max-w-7xl mx-auto px-4 py-8">
      <Toaster position="top-right" />

      {/* Header */}
      <div className="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">Support Tickets</h1>
          <p className="text-gray-500 text-sm mt-1">
            Track your inquiries and communicate with our team.
          </p>
        </div>
        <Link
          to="/dashboard/support"
          className="flex items-center text-gray-600 hover:text-indigo-600 transition-colors font-medium text-sm bg-white px-4 py-2 rounded-lg border border-gray-200 shadow-sm"
        >
          <ArrowLeft size={16} className="mr-2" /> Back to Help Center
        </Link>
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-12 gap-8">
        {/* CREATE TICKET FORM */}
        <div className="lg:col-span-5 order-2 lg:order-1">
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 sticky top-6">
            <div className="flex items-center gap-2 mb-6 border-b border-gray-100 pb-4">
              <div className="bg-indigo-50 p-2 rounded-lg text-indigo-600">
                <PlusCircle size={20} />
              </div>
              <h2 className="text-lg font-bold text-gray-900">
                Create New Ticket
              </h2>
            </div>

            <Form onSubmit={handleSubmit} className="space-y-4">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  Subject
                </label>
                <input
                  type="text"
                  placeholder="e.g., Issue with bulk upload"
                  value={subject}
                  onChange={(e) => setSubject(e.target.value)}
                  className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all text-sm"
                  required
                />
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  Message
                </label>
                <textarea
                  rows={5}
                  placeholder="Please describe your issue in detail..."
                  value={message}
                  onChange={(e) => setMessage(e.target.value)}
                  className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all text-sm"
                  required
                />
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  Attachment (Optional)
                </label>
                <div className="flex items-center gap-2">
                  <label className="cursor-pointer flex items-center justify-center px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 hover:bg-gray-100 text-sm font-medium text-gray-700 transition-colors w-full">
                    <Paperclip size={16} className="mr-2" />
                    {file ? "Change File" : "Choose File"}
                    <input
                      type="file"
                      onChange={handleFileChange}
                      accept="image/png, image/jpeg, image/gif"
                      className="hidden"
                    />
                  </label>
                </div>
                {file && (
                  <p className="mt-2 text-xs text-green-600 flex items-center">
                    <CheckCircle size={12} className="mr-1" /> {file.name}
                  </p>
                )}
              </div>

              <button
                type="submit"
                className="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2.5 px-4 rounded-lg transition-all shadow-sm flex items-center justify-center disabled:opacity-70 disabled:cursor-not-allowed mt-2"
                disabled={submitting}
              >
                {submitting ? <Spinner size="sm" /> : "Submit Ticket"}
              </button>
            </Form>
          </div>
        </div>

        {/* TICKET LIST */}
        <div className="lg:col-span-7 order-1 lg:order-2">
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <div className="p-4 bg-gray-50 border-b border-gray-200 flex justify-between items-center">
              <h2 className="font-bold text-gray-700 flex items-center gap-2">
                <FileText size={18} /> Ticket History
              </h2>
              <span className="bg-gray-200 text-gray-600 text-xs font-bold px-2 py-1 rounded-full">
                {tickets.length}
              </span>
            </div>

            {loading ? (
              <div className="text-center py-12">
                <Spinner animation="border" variant="primary" />
              </div>
            ) : tickets.length > 0 ? (
              <div className="divide-y divide-gray-100">
                {tickets.map((ticket) => (
                  <Link
                    key={ticket.id}
                    to={`/dashboard/support/tickets/${ticket.id}`}
                    className="block p-4 hover:bg-indigo-50/30 transition-colors group text-decoration-none"
                  >
                    <div className="flex justify-between items-start mb-2">
                      <h3 className="font-semibold text-gray-900 group-hover:text-indigo-600 transition-colors">
                        {ticket.subject}
                      </h3>
                      <div className="flex items-center gap-2">
                        <span
                          className={`flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium uppercase tracking-wide ${getStatusBadge(
                            ticket.status
                          )}`}
                        >
                          {getStatusIcon(ticket.status)}
                          {ticket.status.replace("_", " ")}
                        </span>
                        <button
                          onClick={(e) => handleDelete(e, ticket.id)}
                          className="text-gray-400 hover:text-red-500 p-1 rounded-md transition-colors opacity-0 group-hover:opacity-100"
                          title="Delete Ticket"
                        >
                          <Trash2 size={16} />
                        </button>
                      </div>
                    </div>

                    <div className="flex justify-between items-center text-xs text-gray-500">
                      <span className="flex items-center">
                        <Clock size={12} className="mr-1" />
                        Last updated:{" "}
                        {new Date(ticket.updated_at).toLocaleDateString()}
                      </span>
                      <span className="flex items-center text-indigo-500 font-medium opacity-0 group-hover:opacity-100 transition-opacity transform translate-x-2 group-hover:translate-x-0 duration-200">
                        View Details{" "}
                        <CornerDownRight size={12} className="ml-1" />
                      </span>
                    </div>
                  </Link>
                ))}
              </div>
            ) : (
              <div className="text-center py-16 px-4">
                <div className="bg-gray-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4">
                  <MessageCircle size={32} className="text-gray-400" />
                </div>
                <h3 className="text-gray-900 font-medium">No tickets yet</h3>
                <p className="text-gray-500 text-sm mt-1">
                  Create a ticket if you need help with anything.
                </p>
              </div>
            )}
          </div>
        </div>
      </div>
    </div>
  );
}

function TicketDetails() {
  const { ticketId } = useParams();
  const [ticket, setTicket] = useState(null);
  const [loading, setLoading] = useState(true);
  const [reply, setReply] = useState("");
  const [file, setFile] = useState(null);
  const [sending, setSending] = useState(false);
  const navigate = useNavigate();
  const fileInputRef = useRef(null);
  const messagesEndRef = useRef(null);

  const scrollToBottom = () => {
    messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
  };

  useEffect(() => {
    fetchTicket();
  }, [ticketId]);

  useEffect(scrollToBottom, [ticket]);

  const fetchTicket = async () => {
    setLoading(true);
    try {
      const res = await getUserTicketDetails(ticketId);
      setTicket(res.data);
    } catch (err) {
      toast.error("Could not fetch ticket details.");
      navigate("/dashboard/support/tickets");
    } finally {
      setLoading(false);
    }
  };

  const handleReply = async (e) => {
    e.preventDefault();
    if (!reply.trim() && !file) {
      toast.error("Reply cannot be empty.");
      return;
    }
    setSending(true);

    const formData = new FormData();
    formData.append("message", reply);
    if (file) {
      formData.append("file", file);
    }

    try {
      await replyToTicket(ticketId, formData);
      setReply("");
      setFile(null);
      if (fileInputRef.current) fileInputRef.current.value = "";
      fetchTicket();
    } catch (err) {
      toast.error(err.response?.data?.msg || "Failed to send reply.");
    } finally {
      setSending(false);
    }
  };

  const handleFileChange = (e) => {
    const selectedFile = e.target.files[0];
    if (selectedFile) {
      setFile(selectedFile);
      toast.success(`Attached: ${selectedFile.name}`);
    } else {
      setFile(null);
    }
    e.target.value = null;
  };

  if (loading) {
    return (
      <div className="min-h-[80vh] flex items-center justify-center">
        <Spinner animation="border" variant="primary" />
      </div>
    );
  }

  if (!ticket) return null;

  const isClosed = ticket.status === "closed";

  return (
    <div className="max-w-4xl mx-auto px-4 py-8 h-[calc(100vh-64px)] flex flex-col">
      <Toaster position="top-right" />

      {/* HEADER */}
      <div className="bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between shadow-sm z-10 rounded-t-xl border-x border-t">
        <div className="flex items-center gap-4">
          <Link
            to="/dashboard/support/tickets"
            className="text-gray-500 hover:text-gray-900 transition-colors"
          >
            <ArrowLeft size={20} />
          </Link>
          <div>
            <h1 className="text-lg font-bold text-gray-900 line-clamp-1">
              {ticket.subject}
            </h1>
            <span
              className={`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium uppercase tracking-wide mt-1 ${
                ticket.status === "open"
                  ? "bg-blue-100 text-blue-700"
                  : ticket.status === "in_progress"
                  ? "bg-yellow-100 text-yellow-700"
                  : "bg-gray-100 text-gray-600"
              }`}
            >
              {ticket.status.replace("_", " ")}
            </span>
          </div>
        </div>
      </div>

      {/* CHAT AREA */}
      <div className="flex-1 overflow-y-auto p-6 bg-gray-50 border-x border-gray-200 space-y-6">
        {ticket.messages.map((msg) => {
          const isUser = msg.sender_type === "user";
          return (
            <div
              key={msg.id}
              className={`flex ${isUser ? "justify-end" : "justify-start"}`}
            >
              <div
                className={`max-w-[80%] ${
                  isUser ? "items-end" : "items-start"
                } flex flex-col`}
              >
                <div className="flex items-center gap-2 mb-1 px-1">
                  {isUser ? (
                    <>
                      <span className="text-xs font-bold text-gray-600">
                        {msg.sender_name}
                      </span>
                      <User size={12} className="text-gray-400" />
                    </>
                  ) : (
                    <>
                      <Shield size={12} className="text-indigo-600" />
                      <span className="text-xs font-bold text-indigo-600">
                        Support Team
                      </span>
                    </>
                  )}
                </div>

                <div
                  className={`p-4 rounded-2xl text-sm leading-relaxed shadow-sm ${
                    isUser
                      ? "bg-indigo-600 text-white rounded-tr-none"
                      : "bg-white text-gray-800 border border-gray-200 rounded-tl-none"
                  }`}
                >
                  <p className="whitespace-pre-wrap">{msg.content}</p>
                  {msg.image_url && (
                    <a
                      href={msg.image_url}
                      target="_blank"
                      rel="noreferrer"
                      className="block mt-3"
                    >
                      <Image
                        src={msg.image_url}
                        thumbnail
                        className="max-w-full rounded-lg border-2 border-white/20"
                        style={{ maxHeight: "200px" }}
                      />
                    </a>
                  )}
                </div>

                <span className="text-[10px] text-gray-400 mt-1 px-1">
                  {new Date(msg.created_at).toLocaleTimeString([], {
                    hour: "2-digit",
                    minute: "2-digit",
                  })}
                </span>
              </div>
            </div>
          );
        })}
        <div ref={messagesEndRef} />
      </div>

      {/* INPUT AREA */}
      <div className="bg-white p-4 border border-gray-200 rounded-b-xl shadow-sm">
        {isClosed ? (
          <div className="text-center py-4 bg-gray-50 rounded-lg border border-dashed border-gray-300 text-gray-500">
            <Lock size={20} className="mx-auto mb-2 opacity-50" />
            <p className="text-sm font-medium">This ticket has been closed.</p>
          </div>
        ) : (
          <Form onSubmit={handleReply} className="relative">
            {file && (
              <div className="absolute -top-12 left-0 bg-indigo-50 text-indigo-700 px-3 py-1.5 rounded-lg text-xs font-medium flex items-center border border-indigo-100 shadow-sm animate-in fade-in slide-in-from-bottom-2">
                <Paperclip size={12} className="mr-1.5" />
                {file.name}
                <button
                  type="button"
                  onClick={() => setFile(null)}
                  className="ml-2 hover:bg-indigo-100 rounded-full p-0.5"
                >
                  <X size={12} />
                </button>
              </div>
            )}

            <div className="flex gap-2 items-end">
              <div className="flex-1 relative">
                <textarea
                  placeholder="Type your reply here..."
                  value={reply}
                  onChange={(e) => setReply(e.target.value)}
                  className="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all resize-none text-sm min-h-[50px] max-h-[120px]"
                  rows={2}
                  required={!file}
                />
                <button
                  type="button"
                  onClick={() => fileInputRef.current.click()}
                  className="absolute right-3 bottom-3 text-gray-400 hover:text-indigo-600 transition-colors p-1 rounded-md hover:bg-gray-100"
                  title="Attach File"
                >
                  <Paperclip size={18} />
                </button>
              </div>

              <button
                type="submit"
                disabled={sending}
                className="bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl w-12 h-12 flex items-center justify-center transition-colors shadow-sm disabled:opacity-70 disabled:cursor-not-allowed flex-shrink-0"
              >
                {sending ? (
                  <Spinner size="sm" />
                ) : (
                  <Send size={20} className="ml-0.5" />
                )}
              </button>
            </div>

            <input
              type="file"
              ref={fileInputRef}
              onChange={handleFileChange}
              accept="image/png, image/jpeg, image/gif"
              className="hidden"
            />
          </Form>
        )}
      </div>
    </div>
  );
}

// Helper components for missing imports if needed
const Lock = ({ size, className }) => (
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width={size}
    height={size}
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    strokeWidth="2"
    strokeLinecap="round"
    strokeLinejoin="round"
    className={className}
  >
    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
    <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
  </svg>
);

const X = ({ size, className }) => (
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width={size}
    height={size}
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    strokeWidth="2"
    strokeLinecap="round"
    strokeLinejoin="round"
    className={className}
  >
    <line x1="18" y1="6" x2="6" y2="18"></line>
    <line x1="6" y1="6" x2="18" y2="18"></line>
  </svg>
);

export default ContactSupportPage;



==================================================
FILE: pages\CreateCertificatePage.jsx
==================================================

import React, { useState, useEffect } from "react";
import { useNavigate, useParams, Link } from "react-router-dom";
import {
  getTemplates,
  createCertificate,
  getCertificate,
  updateCertificate,
} from "../api";
import QRCode from "react-qr-code";
import { SERVER_BASE_URL } from "../config";
import {
  Calendar,
  Maximize2,
  X,
  ArrowLeft,
  Save,
  User,
  Type,
  FileText,
  PenTool,
  LayoutTemplate,
  Loader2,
  Info,
  DollarSign,
  Plus,
  Trash2,
} from "lucide-react";
import { Spinner } from "react-bootstrap";
import toast, { Toaster } from "react-hot-toast";
import KonvaPreview from "../components/KonvaPreview";

// --- REUSABLE UI COMPONENTS ---
const FormInput = ({ label, icon: Icon, required, ...props }) => (
  <div className="space-y-1.5">
    <label className="block text-sm font-medium text-gray-700">
      {label} {required && <span className="text-red-500">*</span>}
    </label>
    <div className="relative group">
      {Icon && (
        <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-gray-400 group-focus-within:text-indigo-500 transition-colors">
          <Icon size={18} />
        </div>
      )}
      <input
        {...props}
        className={`block w-full rounded-lg border border-gray-300 bg-white py-2.5 text-gray-900 placeholder-gray-400 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 focus:outline-none transition-all duration-200 sm:text-sm ${
          Icon ? "pl-10" : "px-3"
        }`}
      />
    </div>
  </div>
);

const FormSelect = ({ label, icon: Icon, required, children, ...props }) => (
  <div className="space-y-1.5">
    <label className="block text-sm font-medium text-gray-700">
      {label} {required && <span className="text-red-500">*</span>}
    </label>
    <div className="relative group">
      {Icon && (
        <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-gray-400 group-focus-within:text-indigo-500 transition-colors">
          <Icon size={18} />
        </div>
      )}
      <select
        {...props}
        className={`block w-full rounded-lg border border-gray-300 bg-white py-2.5 text-gray-900 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 focus:outline-none transition-all duration-200 sm:text-sm ${
          Icon ? "pl-10" : "px-3"
        }`}
      >
        {children}
      </select>
    </div>
  </div>
);

const CertificatePreview = ({ template, formData }) => {
  if (!template) {
    return (
      <div className="flex flex-col items-center justify-center h-full bg-gray-50/50 rounded-xl border-2 border-dashed border-gray-200 p-12 text-center">
        <LayoutTemplate className="w-12 h-12 text-gray-300 mb-3" />
        <p className="text-gray-500 font-medium">
          Select a template to generate preview
        </p>
      </div>
    );
  }

  const dynamicData = { ...formData };
  if (formData.extra_fields?.amount) {
    dynamicData.amount = formData.extra_fields.amount;
  }

  if (template.layout_style === "visual") {
    return (
      <div className="shadow-lg rounded-lg overflow-hidden h-full">
        <KonvaPreview
          layoutData={template.layout_data}
          dynamicData={dynamicData}
        />
      </div>
    );
  }

  const {
    layout_style,
    primary_color = "#0284C7",
    secondary_color = "#3B82F6",
    body_font_color = "#1F2937",
    font_family = "serif",
    background_url,
    logo_url,
    custom_text,
  } = template;

  const certificateTitle = custom_text?.title || "Certificate of Completion";
  const certificateBody =
    custom_text?.body || "has successfully completed the course";

  const {
    recipient_name = "Recipient Name",
    course_title = "Course Title",
    issue_date = new Date().toLocaleDateString("en-CA"),
    signature = "Signature",
    issuer_name = "Issuer Name",
    verification_id = "pending",
  } = formData;

  const textStyle = { color: body_font_color, fontFamily: font_family };
  const backgroundStyle = {
    backgroundImage: background_url
      ? `url(${SERVER_BASE_URL}${background_url})`
      : "none",
    backgroundSize: "cover",
    backgroundPosition: "center",
  };

  const issueDateFormatted = new Date(issue_date).toLocaleDateString("en-US", {
    month: "long",
    day: "numeric",
    year: "numeric",
  });

  const renderReceipt = () => (
    <div
      className="h-full w-full bg-white relative flex flex-col shadow-xl overflow-hidden text-sm"
      style={{ fontFamily: "sans-serif" }}
    >
      <div className="p-8 h-full flex flex-col">
        <div className="flex justify-between items-start mb-6">
          <div>
            {logo_url ? (
              <img
                src={`${SERVER_BASE_URL}${logo_url}`}
                className="h-12 object-contain mb-2"
                alt="Logo"
              />
            ) : (
              <h2
                className="text-xl font-bold"
                style={{ color: primary_color }}
              >
                {issuer_name}
              </h2>
            )}
          </div>
          <div className="text-right text-gray-500 text-xs">
            <p className="font-bold text-base text-gray-800">{issuer_name}</p>
            <p>Receipt</p>
            <p>{issueDateFormatted}</p>
          </div>
        </div>
        <div
          className="flex justify-between items-center p-3 rounded mb-6"
          style={{ background: primary_color, color: "white" }}
        >
          <span className="font-bold text-lg tracking-wider">
            {certificateTitle}
          </span>
          <span className="font-mono opacity-80">
            #{verification_id.substring(0, 8).toUpperCase()}
          </span>
        </div>
        <div className="flex justify-between mb-6">
          <div>
            <p className="text-xs font-bold text-gray-400 uppercase">Bill To</p>
            <p className="font-bold text-lg text-gray-800">{recipient_name}</p>
          </div>
          <div className="text-right">
            <p className="text-xs font-bold text-gray-400 uppercase">Status</p>
            <p className="font-bold text-green-600">PAID</p>
          </div>
        </div>
        <div className="border-b border-gray-200 mb-2">
          <div className="flex justify-between py-2 bg-gray-50 px-2 font-bold text-gray-500 text-xs uppercase">
            <span>Description</span>
            <span>Amount</span>
          </div>
          <div className="flex justify-between py-4 px-2">
            <span className="font-medium text-gray-800">{course_title}</span>
            <span className="font-bold" style={{ color: primary_color }}>
              {formData.extra_fields?.amount || "PAID"}
            </span>
          </div>
        </div>
        <div className="flex justify-end mt-4 mb-auto">
          <div className="w-1/2 flex justify-between border-t-2 border-gray-800 pt-2">
            <span className="font-bold text-lg">Total</span>
            <span
              className="font-bold text-lg"
              style={{ color: primary_color }}
            >
              {formData.extra_fields?.amount || "PAID"}
            </span>
          </div>
        </div>
        <div className="border-t border-gray-200 pt-4 mt-4 flex justify-between items-end">
          <div className="text-xs text-gray-400">
            <p>Auth Signature: {signature}</p>
            <p className="font-mono mt-1">ID: {verification_id}</p>
          </div>
          <QRCode
            value={`${window.location.origin}/verify/${verification_id}`}
            size={48}
          />
        </div>
      </div>
    </div>
  );

  const renderClassic = () => (
    <div
      className="h-full w-full bg-white relative flex flex-col shadow-xl overflow-hidden"
      style={{
        border: `8px double ${primary_color}`,
        ...backgroundStyle,
        fontFamily: font_family,
      }}
    >
      <div
        style={{
          height: "12px",
          borderBottom: `4px solid ${primary_color}`,
          background: `linear-gradient(to right, ${primary_color}, ${secondary_color})`,
        }}
      />
      <div className="flex-grow flex flex-col justify-center items-center text-center p-8">
        {logo_url && (
          <img
            src={`${SERVER_BASE_URL}${logo_url}`}
            alt="Logo"
            className="mb-4 object-contain h-24 w-24"
          />
        )}
        <h1
          className="font-bold uppercase tracking-wider text-3xl md:text-4xl mb-2"
          style={{ color: primary_color }}
        >
          {certificateTitle}
        </h1>
        <p className="italic text-lg mb-4" style={{ color: "#4B5EAA" }}>
          This is to certify that
        </p>
        <h2
          className="font-extrabold text-4xl md:text-5xl mb-4"
          style={{ fontFamily: "'Georgia', serif", ...textStyle }}
        >
          {recipient_name}
        </h2>
        <p className="italic text-xl mb-4" style={{ color: "#4B5EAA" }}>
          {certificateBody}
        </p>
        <p
          className="font-bold uppercase text-2xl md:text-3xl mb-6"
          style={{ color: secondary_color }}
        >
          {course_title}
        </p>
        <p className="text-lg mb-8" style={{ color: body_font_color }}>
          Awarded on {issueDateFormatted}
        </p>
        <div className="flex justify-between w-full max-w-2xl mt-auto pt-8 px-8">
          <div className="text-center w-40">
            <p className="font-semibold text-lg" style={textStyle}>
              {signature || issuer_name}
            </p>
            <div className="h-px w-full bg-gray-400 my-1"></div>
            <span className="text-gray-500 text-sm">Authorized Signature</span>
          </div>
          <div className="text-center w-40">
            <p className="font-semibold text-lg" style={textStyle}>
              {issuer_name}
            </p>
            <div className="h-px w-full bg-gray-400 my-1"></div>
            <span className="text-gray-500 text-sm">Issuer</span>
          </div>
        </div>
        <div className="absolute bottom-4 right-4 bg-white p-1 rounded shadow-sm">
          <QRCode
            value={`${window.location.origin}/verify/${verification_id}`}
            size={60}
          />
        </div>
      </div>
    </div>
  );

  const renderModern = () => (
    <div
      className="flex h-full w-full shadow-xl overflow-hidden bg-white"
      style={{
        border: `6px solid ${primary_color}`,
        ...backgroundStyle,
        fontFamily: font_family,
      }}
    >
      <div
        className="w-[35%] flex flex-col justify-between items-center p-8 text-white"
        style={{
          background: `linear-gradient(135deg, ${primary_color}, ${secondary_color})`,
        }}
      >
        <div className="text-center">
          {logo_url && (
            <img
              src={`${SERVER_BASE_URL}${logo_url}`}
              className="w-24 h-24 rounded-full border-4 border-white shadow-md mb-4 object-cover bg-white"
              alt="Logo"
            />
          )}
          <p className="font-bold uppercase tracking-widest text-sm opacity-90">
            {issuer_name}
          </p>
        </div>
        <div className="bg-white p-2 rounded-lg shadow-lg">
          <QRCode
            value={`${window.location.origin}/verify/${verification_id}`}
            size={80}
          />
        </div>
      </div>
      <div className="w-[65%] flex flex-col justify-center p-12 relative bg-white/95">
        <h1
          className="font-light uppercase tracking-[0.2em] text-2xl mb-6"
          style={{ color: primary_color }}
        >
          {certificateTitle}
        </h1>
        <h2
          className="font-bold text-5xl mb-4 leading-tight"
          style={{ fontFamily: "'Georgia', serif", ...textStyle }}
        >
          {recipient_name}
        </h2>
        <p className="italic text-xl text-gray-600 mb-6">{certificateBody}</p>
        <p
          className="font-bold uppercase text-2xl tracking-wide mb-8"
          style={{ color: secondary_color }}
        >
          {course_title}
        </p>
        <p className="text-lg mb-8" style={textStyle}>
          Awarded on {issueDateFormatted}
        </p>
        <div
          className="flex justify-between mt-auto pt-6 border-t-2"
          style={{ borderColor: primary_color }}
        >
          <div>
            <p className="font-bold text-lg" style={textStyle}>
              {signature || issuer_name}
            </p>
            <p className="text-gray-500 text-sm uppercase tracking-wide">
              Signature
            </p>
          </div>
          <div className="text-right">
            <p className="font-bold text-lg" style={textStyle}>
              {issuer_name}
            </p>
            <p className="text-gray-500 text-sm uppercase tracking-wide">
              Issuer
            </p>
          </div>
        </div>
      </div>
    </div>
  );

  if (layout_style === "receipt") return renderReceipt();
  if (layout_style === "modern") return renderModern();
  return renderClassic();
};

const CreateCertificatePage = () => {
  const { certId } = useParams();
  const navigate = useNavigate();
  const isEditMode = !!certId;
  const [formData, setFormData] = useState({
    template_id: "",
    recipient_name: "",
    recipient_email: "",
    course_title: "",
    issuer_name: "",
    issue_date: new Date().toLocaleDateString("en-CA"),
    signature: "",
    extra_fields: {},
  });
  const [customFields, setCustomFields] = useState([]);
  const [amount, setAmount] = useState("");

  const [templates, setTemplates] = useState([]);
  const [selectedTemplate, setSelectedTemplate] = useState(null);
  const [error, setError] = useState("");
  const [submitting, setSubmitting] = useState(false);
  const [loading, setLoading] = useState(true);
  const [showFullscreen, setShowFullscreen] = useState(false);

  useEffect(() => {
    const fetchData = async () => {
      try {
        const templateResponse = await getTemplates();
        setTemplates(templateResponse.data.templates);
        if (isEditMode) {
          const certResponse = await getCertificate(certId);
          const cert = certResponse.data.certificate;
          setFormData({
            template_id: certResponse.data.template.id,
            recipient_name: cert.recipient_name,
            recipient_email: cert.recipient_email,
            course_title: cert.course_title,
            issuer_name: cert.issuer_name,
            issue_date: new Date(cert.issue_date).toLocaleDateString("en-CA"),
            signature: cert.signature,
            extra_fields: cert.extra_fields || {},
          });
          setSelectedTemplate(certResponse.data.template);

          if (cert.extra_fields?.amount) setAmount(cert.extra_fields.amount);

          const fields = Object.entries(cert.extra_fields || {})
            .filter(([key]) => key !== "amount")
            .map(([key, value]) => ({ key, value }));
          setCustomFields(fields);
        }
      } catch (err) {
        setError("Could not fetch data.");
      } finally {
        setLoading(false);
      }
    };
    fetchData();
  }, [certId, isEditMode]);

  const handleChange = (e) => {
    setFormData({ ...formData, [e.target.name]: e.target.value });
    setError("");
  };

  const handleTemplateChange = (e) => {
    const templateId = e.target.value;
    setFormData({ ...formData, template_id: templateId });
    const template = templates.find((t) => String(t.id) === String(templateId));
    setSelectedTemplate(template || null);
  };

  // Custom Fields Logic
  const addCustomField = () => {
    setCustomFields([...customFields, { key: "", value: "" }]);
  };

  const removeCustomField = (index) => {
    const newFields = [...customFields];
    newFields.splice(index, 1);
    setCustomFields(newFields);
  };

  const handleCustomFieldChange = (index, field, value) => {
    const newFields = [...customFields];
    newFields[index][field] = value;
    setCustomFields(newFields);
  };

  // Sync custom fields & amount
  useEffect(() => {
    const extras = {};
    if (amount) extras.amount = amount;

    customFields.forEach((field) => {
      if (field.key.trim()) {
        extras[field.key.trim()] = field.value;
      }
    });

    setFormData((prev) => ({ ...prev, extra_fields: extras }));
  }, [amount, customFields]);

  const handleSubmit = async (e) => {
    e.preventDefault();
    setSubmitting(true);
    setError("");

    const promise = isEditMode
      ? updateCertificate(certId, formData)
      : createCertificate(formData);

    toast.promise(promise, {
      loading: isEditMode ? "Updating..." : "Issuing...",
      success: (response) => {
        setTimeout(() => navigate("/dashboard"), 1500);
        return response.data.msg;
      },
      error: (err) => {
        setSubmitting(false);
        return err.response?.data?.msg || "An error occurred.";
      },
    });
  };

  const isReceipt = selectedTemplate?.layout_style === "receipt";

  if (loading) {
    return (
      <div className="min-h-[60vh] flex items-center justify-center">
        <Spinner animation="border" variant="primary" />
      </div>
    );
  }

  return (
    <div className="max-w-7xl mx-auto pb-12">
      <Toaster position="top-right" />

      {/* Header */}
      <div className="flex items-center gap-4 mb-8">
        <Link
          to="/dashboard"
          className="p-2 rounded-full hover:bg-gray-100 text-gray-500 transition-colors"
        >
          <ArrowLeft size={24} />
        </Link>
        <div>
          <h1 className="text-2xl font-bold text-gray-900">
            {isEditMode ? "Edit Document" : "Issue New Document"}
          </h1>
          <p className="text-gray-500 text-sm">
            Fill in the details below. Custom fields are supported.
          </p>
        </div>
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">
        {/* LEFT COLUMN: FORM */}
        <div className="lg:col-span-4 space-y-6">
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h2 className="text-lg font-bold text-gray-900 mb-6 flex items-center gap-2">
              <FileText className="text-indigo-600" size={20} />
              Details
            </h2>

            <form onSubmit={handleSubmit} className="space-y-5">
              <FormSelect
                label="Select Template"
                icon={LayoutTemplate}
                name="template_id"
                onChange={handleTemplateChange}
                value={formData.template_id}
                required
              >
                <option value="">Choose a template...</option>
                {templates.map((t) => (
                  <option key={t.id} value={t.id}>
                    {t.title}{" "}
                    {t.is_public
                      ? "(System)"
                      : t.layout_style === "visual"
                      ? "(Visual)"
                      : ""}
                  </option>
                ))}
              </FormSelect>

              <div className="border-t border-gray-100 my-4"></div>

              <FormInput
                name="recipient_name"
                label={isReceipt ? "Payer Name" : "Recipient Name"}
                icon={User}
                placeholder="e.g., Jane Doe"
                required
                value={formData.recipient_name}
                onChange={handleChange}
              />

              <FormInput
                name="recipient_email"
                label="Email (Optional)"
                icon={Type}
                type="email"
                placeholder="jane@example.com"
                value={formData.recipient_email}
                onChange={handleChange}
              />

              <FormInput
                name="course_title"
                label={
                  isReceipt ? "Payment Description" : "Course / Event Title"
                }
                icon={FileText}
                placeholder={
                  isReceipt
                    ? "e.g. Web Dev Course"
                    : "e.g., Advanced React Workshop"
                }
                required
                value={formData.course_title}
                onChange={handleChange}
              />

              {isReceipt && (
                <FormInput
                  name="amount"
                  label="Amount (Total)"
                  icon={DollarSign}
                  placeholder="e.g. $500.00"
                  value={amount}
                  onChange={(e) => setAmount(e.target.value)}
                />
              )}

              <div className="grid grid-cols-2 gap-4">
                <FormInput
                  name="issue_date"
                  label={isReceipt ? "Payment Date" : "Issue Date"}
                  icon={Calendar}
                  type="date"
                  required
                  value={formData.issue_date}
                  onChange={handleChange}
                />
                <FormInput
                  name="issuer_name"
                  label="Issuer Name"
                  icon={User}
                  placeholder="e.g. Acme Inc"
                  value={formData.issuer_name}
                  onChange={handleChange}
                />
              </div>

              <FormInput
                name="signature"
                label="Signature Text (Optional)"
                icon={PenTool}
                placeholder="e.g., Dr. John Smith"
                value={formData.signature}
                onChange={handleChange}
              />

              {/* DYNAMIC FIELDS SECTION */}
              <div className="pt-4 border-t border-gray-100">
                <div className="flex justify-between items-center mb-3">
                  <label className="block text-sm font-medium text-gray-700">
                    Additional Fields
                  </label>
                  <button
                    type="button"
                    onClick={addCustomField}
                    className="text-xs flex items-center gap-1 text-indigo-600 font-bold hover:text-indigo-800"
                  >
                    <Plus size={14} /> Add Field
                  </button>
                </div>

                {customFields.length > 0 ? (
                  <div className="space-y-3">
                    {customFields.map((field, index) => (
                      <div key={index} className="flex gap-2 items-center">
                        <input
                          placeholder="Label"
                          className="w-1/3 px-2 py-1.5 border rounded text-sm"
                          value={field.key}
                          onChange={(e) =>
                            handleCustomFieldChange(
                              index,
                              "key",
                              e.target.value
                            )
                          }
                        />
                        <input
                          placeholder="Value"
                          className="flex-1 px-2 py-1.5 border rounded text-sm"
                          value={field.value}
                          onChange={(e) =>
                            handleCustomFieldChange(
                              index,
                              "value",
                              e.target.value
                            )
                          }
                        />
                        <button
                          type="button"
                          onClick={() => removeCustomField(index)}
                          className="text-red-500 hover:text-red-700"
                        >
                          <Trash2 size={16} />
                        </button>
                      </div>
                    ))}
                  </div>
                ) : (
                  <p className="text-xs text-gray-400 italic">
                    No custom fields added.
                  </p>
                )}
              </div>

              {error && (
                <div className="bg-red-50 text-red-600 p-3 rounded-lg text-sm flex items-start gap-2">
                  <Info size={16} className="mt-0.5 flex-shrink-0" />
                  {error}
                </div>
              )}

              <button
                type="submit"
                disabled={submitting}
                className="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-lg flex items-center justify-center gap-2 transition-all shadow-sm hover:shadow disabled:opacity-70 disabled:cursor-not-allowed mt-4"
              >
                {submitting ? (
                  <Loader2 className="animate-spin" size={20} />
                ) : (
                  <Save size={20} />
                )}
                <span>{isEditMode ? "Update" : "Generate Document"}</span>
              </button>
            </form>
          </div>
        </div>

        {/* RIGHT COLUMN: PREVIEW */}
        <div className="lg:col-span-8">
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 sticky top-6">
            <div className="flex justify-between items-center mb-6">
              <h3 className="font-bold text-gray-800 flex items-center gap-2">
                <div className="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                Live Preview
              </h3>
              {selectedTemplate && (
                <button
                  className="text-gray-500 hover:text-indigo-600 hover:bg-indigo-50 p-2 rounded-lg transition-colors flex items-center gap-2 text-sm font-medium"
                  onClick={() => setShowFullscreen(true)}
                >
                  <Maximize2 size={18} />
                  <span>Expand</span>
                </button>
              )}
            </div>

            <div className="w-full bg-gray-100 rounded-lg border border-gray-200 overflow-hidden flex items-center justify-center p-4 min-h-[400px]">
              <div className="w-full shadow-xl transition-all duration-300">
                <CertificatePreview
                  template={selectedTemplate}
                  formData={formData}
                />
              </div>
            </div>

            <p className="text-center text-gray-400 text-sm mt-4 flex items-center justify-center gap-2">
              <Info size={14} />
              Preview updates in real-time as you type
            </p>
          </div>
        </div>
      </div>

      {/* Fullscreen Modal */}
      {showFullscreen && (
        <div
          className="fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center z-[9999] p-4 md:p-8"
          onClick={() => setShowFullscreen(false)}
        >
          <button
            onClick={() => setShowFullscreen(false)}
            className="absolute top-6 right-6 text-white/80 hover:text-white bg-white/10 hover:bg-white/20 p-2 rounded-full transition-all"
          >
            <X size={32} />
          </button>

          <div
            className="w-full max-w-6xl max-h-[90vh] flex items-center justify-center"
            onClick={(e) => e.stopPropagation()}
          >
            <CertificatePreview
              template={selectedTemplate}
              formData={formData}
            />
          </div>
        </div>
      )}
    </div>
  );
};

export default CreateCertificatePage;



==================================================
FILE: pages\DocsPage.jsx
==================================================

import React, { useState } from "react";
import { Toaster } from "react-hot-toast";
import PublicHeader from "../components/PublicHeader";
import PublicFooter from "../components/PublicFooter";
import {
  Book,
  Key,
  Send,
  Code2,
  AlertOctagon,
  Menu,
  X,
  ChevronRight,
  Copy,
  CheckCircle2,
} from "lucide-react";

// --- Styled Code Block Component ---
const CodeSnippet = ({ lang, code }) => {
  const [copied, setCopied] = useState(false);

  const handleCopy = () => {
    navigator.clipboard.writeText(code);
    setCopied(true);
    setTimeout(() => setCopied(false), 2000);
  };

  return (
    <div className="relative rounded-xl overflow-hidden bg-[#1e1e1e] border border-gray-800 my-6 shadow-2xl">
      <div className="flex justify-between items-center px-4 py-2 bg-[#2d2d2d] border-b border-gray-700">
        <span className="text-xs font-mono text-gray-400 uppercase">
          {lang}
        </span>
        <button
          onClick={handleCopy}
          className="text-xs text-gray-400 hover:text-white flex items-center gap-1 transition-colors"
        >
          {copied ? (
            <CheckCircle2 size={14} className="text-green-500" />
          ) : (
            <Copy size={14} />
          )}
          {copied ? "Copied" : "Copy"}
        </button>
      </div>
      <div className="p-4 overflow-x-auto">
        <pre className="text-sm font-mono leading-relaxed text-gray-300">
          <code>{code}</code>
        </pre>
      </div>
    </div>
  );
};

function DocsPage() {
  const [isSidebarOpen, setIsSidebarOpen] = useState(false);

  const toggleSidebar = () => setIsSidebarOpen(!isSidebarOpen);
  const closeSidebar = () => setIsSidebarOpen(false);

  // --- Examples ---
  const curlExample = `curl -X POST 'https://certifyme.pythonanywhere.com/api/v1/certificates' \\
  -H 'Content-Type: application/json' \\
  -H 'X-API-Key: sk_live_xxxxxxxx' \\
  -d '{
    "template_id": 1,
    "recipient_name": "Bolaji Ayodele",
    "recipient_email": "bolaji@example.com",
    "course_title": "React Mastery",
    "issue_date": "2025-01-15",
    "extra_fields": {
      "Grade": "A+"
    }
  }'`;

  const jsExample = `const issueCert = async () => {
  const res = await fetch('https://certifyme.pythonanywhere.com/api/v1/certificates', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-API-Key': 'sk_live_xxxxxxxx'
    },
    body: JSON.stringify({
      template_id: 1,
      recipient_name: "Bolaji Ayodele",
      course_title: "React Mastery",
      issue_date: "2025-01-15"
    })
  });
  
  const data = await res.json();
  console.log(data);
};`;

  const pythonExample = `import requests

url = "https://certifyme.pythonanywhere.com/api/v1/certificates"
headers = {
    "Content-Type": "application/json",
    "X-API-Key": "sk_live_xxxxxxxx"
}
payload = {
    "template_id": 1,
    "recipient_name": "Bolaji Ayodele",
    "recipient_email": "bolaji@example.com",
    "course_title": "Python for Data Science",
    "issue_date": "2025-01-15"
}

response = requests.post(url, json=payload, headers=headers)
print(response.json())`;

  const javaExample = `import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;

public class IssueCertificate {
    public static void main(String[] args) {
        String json = """
            {
                "template_id": 1,
                "recipient_name": "Bolaji Ayodele",
                "recipient_email": "bolaji@example.com",
                "course_title": "Java Enterprise",
                "issue_date": "2025-01-15"
            }
        """;

        HttpClient client = HttpClient.newHttpClient();
        HttpRequest request = HttpRequest.newBuilder()
            .uri(URI.create("https://certifyme.pythonanywhere.com/api/v1/certificates"))
            .header("Content-Type", "application/json")
            .header("X-API-Key", "sk_live_xxxxxxxx")
            .POST(HttpRequest.BodyPublishers.ofString(json))
            .build();

        client.sendAsync(request, HttpResponse.BodyHandlers.ofString())
            .thenApply(HttpResponse::body)
            .thenAccept(System.out::println)
            .join();
    }
}`;

  const successResponse = `{
  "msg": "Certificate created and dispatched successfully.",
  "certificate_id": 842,
  "verification_id": "a1b2c3d4-e5f6-7890"
}`;

  return (
    <div className="font-sans text-gray-900 bg-white min-h-screen flex flex-col">
      <Toaster position="top-center" />
      <PublicHeader />

      <div className="flex-grow max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-10 flex items-start gap-12 relative">
        {/* Mobile Menu Toggle */}
        <button
          onClick={toggleSidebar}
          className="lg:hidden fixed bottom-6 right-6 bg-black text-white p-4 rounded-full shadow-2xl z-50 hover:scale-105 transition-transform"
        >
          {isSidebarOpen ? <X /> : <Menu />}
        </button>

        {/* Sidebar Navigation */}
        <aside
          className={`
          fixed inset-y-0 left-0 z-40 w-72 bg-gray-50/95 backdrop-blur-xl border-r border-gray-200 transform transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:h-[calc(100vh-120px)] lg:sticky lg:top-24 lg:border-0 lg:bg-transparent overflow-y-auto p-6 lg:p-0
          ${
            isSidebarOpen
              ? "translate-x-0 shadow-2xl lg:shadow-none"
              : "-translate-x-full"
          }
        `}
        >
          <div className="mb-8">
            <h4 className="text-sm font-bold text-gray-400 uppercase tracking-wider mb-4">
              Documentation
            </h4>
            <nav className="space-y-1">
              <NavItem
                href="#intro"
                icon={Book}
                label="Introduction"
                active
                onClick={closeSidebar}
              />
              <NavItem
                href="#auth"
                icon={Key}
                label="Authentication"
                onClick={closeSidebar}
              />
              <NavItem
                href="#create"
                icon={Send}
                label="Create Certificate"
                onClick={closeSidebar}
              />
              <NavItem
                href="#errors"
                icon={AlertOctagon}
                label="Error Handling"
                onClick={closeSidebar}
              />
            </nav>
          </div>

          <div className="p-4 bg-indigo-50 rounded-xl border border-indigo-100">
            <h5 className="font-bold text-indigo-900 text-sm mb-2">
              Need help?
            </h5>
            <p className="text-xs text-indigo-700 mb-3">
              Join our developer slack or contact support.
            </p>
            <a
              href="/contact"
              className="text-xs font-bold text-indigo-600 hover:text-indigo-800 flex items-center no-underline"
            >
              Contact Support <ChevronRight size={12} />
            </a>
          </div>
        </aside>

        {/* Overlay */}
        {isSidebarOpen && (
          <div
            className="fixed inset-0 bg-black/40 backdrop-blur-sm z-30 lg:hidden"
            onClick={closeSidebar}
          />
        )}

        {/* Main Content */}
        <main className="flex-1 min-w-0 pb-20">
          {/* Header */}
          <div className="mb-12 border-b border-gray-100 pb-8">
            <h1 className="text-4xl font-extrabold text-gray-900 mb-4 tracking-tight">
              API Reference
            </h1>
            <p className="text-xl text-gray-500 leading-relaxed">
              Programmatically generate and send certificates using the
              CertifyMe REST API.
            </p>
          </div>

          {/* Intro */}
          <section id="intro" className="mb-16 scroll-mt-28">
            <h2 className="text-2xl font-bold text-gray-900 mb-4">
              Introduction
            </h2>
            <p className="text-gray-600 mb-6 leading-relaxed">
              The CertifyMe API is organized around REST. Our API has
              predictable resource-oriented URLs, accepts JSON-encoded request
              bodies, returns JSON-encoded responses, and uses standard HTTP
              response codes.
            </p>
          </section>

          {/* Auth */}
          <section id="auth" className="mb-16 scroll-mt-28">
            <h2 className="text-2xl font-bold text-gray-900 mb-4">
              Authentication
            </h2>
            <p className="text-gray-600 mb-6">
              Authenticate requests by including your secret API key in the{" "}
              <code>X-API-Key</code> header.
            </p>
            <CodeSnippet lang="HTTP Header" code="X-API-Key: sk_live_..." />
          </section>

          {/* Create Certificate */}
          <section id="create" className="mb-16 scroll-mt-28">
            <div className="flex items-center gap-3 mb-6">
              <span className="bg-green-100 text-green-700 px-3 py-1 rounded-lg text-sm font-bold font-mono">
                POST
              </span>
              <h2 className="text-2xl font-bold text-gray-900 m-0">
                Create Certificate
              </h2>
            </div>

            <h3 className="text-lg font-bold text-gray-900 mb-4">
              Code Examples
            </h3>
            <div className="grid lg:grid-cols-1 gap-6">
              <div>
                <h4 className="text-sm font-semibold text-gray-500 mb-2">
                  cURL
                </h4>
                <CodeSnippet lang="bash" code={curlExample} />
              </div>
              <div>
                <h4 className="text-sm font-semibold text-gray-500 mb-2">
                  JavaScript (Fetch)
                </h4>
                <CodeSnippet lang="javascript" code={jsExample} />
              </div>
              <div>
                <h4 className="text-sm font-semibold text-gray-500 mb-2">
                  Python (Requests)
                </h4>
                <CodeSnippet lang="python" code={pythonExample} />
              </div>
              <div>
                <h4 className="text-sm font-semibold text-gray-500 mb-2">
                  Java (HttpClient)
                </h4>
                <CodeSnippet lang="java" code={javaExample} />
              </div>
            </div>

            <h3 className="text-lg font-bold text-gray-900 mt-8 mb-4">
              Success Response
            </h3>
            <CodeSnippet lang="json" code={successResponse} />
          </section>

          {/* Errors */}
          <section id="errors" className="mb-16 scroll-mt-28">
            <h2 className="text-2xl font-bold text-gray-900 mb-6">
              Error Handling
            </h2>
            <div className="grid gap-4">
              <ErrorRow
                code="400"
                title="Bad Request"
                desc="Invalid parameters or missing fields."
              />
              <ErrorRow
                code="401"
                title="Unauthorized"
                desc="Invalid API Key."
              />
              <ErrorRow
                code="403"
                title="Forbidden"
                desc="Quota exceeded or insufficient permissions."
              />
              <ErrorRow
                code="404"
                title="Not Found"
                desc="Template ID does not exist."
              />
            </div>
          </section>
        </main>
      </div>
      <PublicFooter />
    </div>
  );
}

// --- Local Helpers ---
const NavItem = ({ href, icon: Icon, label, active, onClick }) => (
  <a
    href={href}
    onClick={onClick}
    className={`flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-lg transition-colors no-underline ${
      active
        ? "text-indigo-600 bg-indigo-50"
        : "text-gray-600 hover:text-gray-900 hover:bg-gray-100"
    }`}
  >
    <Icon size={18} />
    {label}
  </a>
);

const ErrorRow = ({ code, title, desc }) => (
  <div className="flex items-center p-4 bg-white border border-gray-200 rounded-lg shadow-sm">
    <span className="font-mono font-bold text-red-600 w-16">{code}</span>
    <div className="flex-1">
      <span className="font-bold text-gray-900 mr-2">{title}</span>
      <span className="text-gray-500 text-sm">{desc}</span>
    </div>
  </div>
);

export default DocsPage;



==================================================
FILE: pages\ForgotPasswordPage.jsx
==================================================

import React, { useState } from "react";
import { Link } from "react-router-dom";
import { Form, Button, Alert, Spinner } from "react-bootstrap";
import { requestPasswordReset } from "../api";
import "../styles/Auth.css";

function ForgotPasswordPage() {
  const [email, setEmail] = useState("");
  const [message, setMessage] = useState("");
  const [error, setError] = useState("");
  const [loading, setLoading] = useState(false);

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError("");
    setMessage("");
    setLoading(true);

    try {
      const response = await requestPasswordReset(email);
      setMessage(response.data.msg);
    } catch (err) {
      setError(
        err.response?.data?.msg || "An error occurred. Please try again."
      );
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="auth-container">
      <div className="auth-wrapper">
        <div className="auth-panel">
          <h2>Forgot Your Password?</h2>
          <p>
            No problem. Enter your email address and we'll send you a link to
            reset it.
          </p>
        </div>
        <div className="auth-form-container">
          <img
            src="/images/certbadge.png"
            alt="CertifyMe Logo"
            className="auth-logo mx-auto d-block"
            style={{ maxHeight: "35px" }}
          />
          <h3>Reset Password</h3>
          {error && <Alert variant="danger">{error}</Alert>}
          {message && <Alert variant="success">{message}</Alert>}
          <Form onSubmit={handleSubmit}>
            <Form.Group className="mb-3" controlId="email">
              <Form.Label>Email Address</Form.Label>
              <Form.Control
                type="email"
                name="email"
                value={email}
                onChange={(e) => setEmail(e.target.value)}
                placeholder="you@example.com"
                required
                disabled={!!message} // Disable form after success
              />
            </Form.Group>
            <Button
              className="btn-auth w-100"
              type="submit"
              disabled={loading || !!message}
            >
              {loading ? (
                <Spinner
                  as="span"
                  animation="border"
                  size="sm"
                  role="status"
                  aria-hidden="true"
                />
              ) : (
                "Send Reset Link"
              )}
            </Button>
          </Form>
          <p className="text-center mt-4 text-muted">
            Remember your password?{" "}
            <Link to="/login" className="auth-switch-link">
              Sign In
            </Link>
          </p>
        </div>
      </div>
    </div>
  );
}

export default ForgotPasswordPage;



==================================================
FILE: pages\GroupsPage.jsx
==================================================

import React, { useState, useEffect } from "react";
import {
  getGroups,
  createGroup,
  getGroupDetails,
  deleteGroup,
  sendGroupBulkEmail,
  downloadGroupBulkPDF,
} from "../api";
import toast, { Toaster } from "react-hot-toast";
import {
  Container,
  Button,
  Modal,
  Form,
  Spinner,
  OverlayTrigger,
  Tooltip,
} from "react-bootstrap";
import {
  Folder,
  Plus,
  Trash2,
  Send,
  ChevronLeft,
  Mail,
  CheckCircle,
  Download,
  Lock,
  MoreVertical,
  Users,
  Search,
} from "lucide-react";
import { useUser } from "../context/UserContext";

function GroupsPage() {
  const { user } = useUser();
  const [groups, setGroups] = useState([]);
  const [loading, setLoading] = useState(true);
  const [showCreateModal, setShowCreateModal] = useState(false);
  const [newGroupName, setNewGroupName] = useState("");
  const [viewingGroup, setViewingGroup] = useState(null);
  const [groupDetails, setGroupDetails] = useState(null);
  const [loadingDetails, setLoadingDetails] = useState(false);
  const [currentPage, setCurrentPage] = useState(1);
  const [totalPages, setTotalPages] = useState(1);
  const [isBulkDownloading, setIsBulkDownloading] = useState(false);

  const isFreeUser = user && user.role === "free";

  const fetchGroups = async (page = 1) => {
    setLoading(true);
    try {
      const res = await getGroups(page);
      setGroups(res.data.groups);
      setCurrentPage(res.data.current_page);
      setTotalPages(res.data.pages);
    } catch (error) {
      toast.error("Could not fetch groups.");
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    if (!viewingGroup) {
      fetchGroups(currentPage);
    }
  }, [currentPage, viewingGroup]);

  const handleCreateGroup = async () => {
    if (!newGroupName.trim()) {
      return toast.error("Group name cannot be empty.");
    }
    const promise = createGroup(newGroupName);
    toast.promise(promise, {
      loading: "Creating group...",
      success: (res) => {
        setShowCreateModal(false);
        setNewGroupName("");
        fetchGroups(1);
        return res.data.msg;
      },
      error: (err) => err.response?.data?.msg || "Failed to create group.",
    });
  };

  const handleViewGroup = async (group) => {
    setViewingGroup(group);
    setLoadingDetails(true);
    try {
      const res = await getGroupDetails(group.id);
      setGroupDetails(res.data);
    } catch (error) {
      toast.error("Could not fetch group details.");
    } finally {
      setLoadingDetails(false);
    }
  };

  const handleDeleteGroup = async (groupId, groupName, certCount) => {
    if (
      window.confirm(
        `Are you sure you want to delete "${groupName}"? This will delete all ${certCount} certificates inside it.`
      )
    ) {
      const promise = deleteGroup(groupId);
      toast.promise(promise, {
        loading: "Deleting group...",
        success: (res) => {
          setViewingGroup(null);
          setGroupDetails(null);
          fetchGroups(1);
          return res.data.msg;
        },
        error: (err) => err.response?.data?.msg || "Failed to delete group.",
      });
    }
  };

  const handleSendBulkEmail = async (groupId) => {
    const promise = sendGroupBulkEmail(groupId);
    toast.promise(promise, {
      loading: "Sending emails...",
      success: (res) => {
        handleViewGroup(viewingGroup);
        return res.data.msg;
      },
      error: (err) => err.response?.data?.msg || "Failed to send emails.",
    });
  };

  const handleBulkDownload = () => {
    setIsBulkDownloading(true);
    const promise = downloadGroupBulkPDF(viewingGroup.id);
    toast.promise(promise, {
      loading: "Generating zip file... This may take a moment.",
      success: (response) => {
        const url = window.URL.createObjectURL(new Blob([response.data]));
        const link = document.createElement("a");
        link.href = url;
        const filename = `${viewingGroup.name
          .replace(/[^a-z0-9]/gi, "_")
          .toLowerCase()}_certificates.zip`;
        link.setAttribute("download", filename);
        document.body.appendChild(link);
        link.click();
        link.parentNode.removeChild(link);
        window.URL.revokeObjectURL(url);
        return "Download started!";
      },
      error: (err) => err.response?.data?.msg || "Failed to download zip file.",
    });
    promise.finally(() => setIsBulkDownloading(false));
  };

  const renderDownloadTooltip = (props) => (
    <Tooltip id="download-tooltip" {...props}>
      <div className="flex items-center gap-1">
        <Lock size={12} />
        <span>Upgrade to download all as ZIP</span>
      </div>
    </Tooltip>
  );

  const DownloadButton = () => {
    const buttonContent = (
      <>
        {isBulkDownloading ? (
          <Spinner size="sm" className="me-2" />
        ) : (
          <Download size={16} className="me-2" />
        )}
        Download All
      </>
    );

    if (isFreeUser) {
      return (
        <OverlayTrigger placement="top" overlay={renderDownloadTooltip}>
          <span className="d-inline-block">
            <Button
              variant="outline-secondary"
              className="d-flex align-items-center opacity-75"
              disabled
              style={{ pointerEvents: "none" }}
            >
              {buttonContent}
            </Button>
          </span>
        </OverlayTrigger>
      );
    }

    return (
      <Button
        variant="outline-secondary"
        className="d-flex align-items-center"
        onClick={handleBulkDownload}
        disabled={isBulkDownloading}
      >
        {buttonContent}
      </Button>
    );
  };

  if (loading) {
    return (
      <div className="flex justify-center items-center h-[50vh]">
        <Spinner animation="border" variant="primary" />
      </div>
    );
  }

  // --- SINGLE GROUP VIEW ---
  if (viewingGroup) {
    return (
      <Container fluid className="px-4 py-4">
        <Toaster position="top-right" />
        <button
          onClick={() => setViewingGroup(null)}
          className="mb-6 flex items-center text-gray-500 hover:text-gray-900 transition-colors font-medium bg-transparent border-0 p-0"
        >
          <ChevronLeft size={20} className="mr-1" /> Back to All Groups
        </button>

        <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6">
          <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
            <div>
              <h1 className="text-2xl font-bold text-gray-900 mb-1">
                {viewingGroup.name}
              </h1>
              <div className="flex items-center text-gray-500 text-sm">
                <Folder size={14} className="mr-2" />
                <span>
                  {viewingGroup.certificate_count} certificate
                  {viewingGroup.certificate_count !== 1 ? "s" : ""}
                </span>
                <span className="mx-2">•</span>
                <span>
                  Created on{" "}
                  {new Date(viewingGroup.created_at).toLocaleDateString()}
                </span>
              </div>
            </div>
            <div className="flex flex-wrap gap-3">
              <DownloadButton />
              <Button
                variant="primary"
                className="d-flex align-items-center"
                onClick={() => handleSendBulkEmail(viewingGroup.id)}
              >
                <Send size={16} className="me-2" /> Send to Unsent
              </Button>
              <Button
                variant="outline-danger"
                className="d-flex align-items-center"
                onClick={() =>
                  handleDeleteGroup(
                    viewingGroup.id,
                    viewingGroup.name,
                    viewingGroup.certificate_count
                  )
                }
              >
                <Trash2 size={16} className="me-2" /> Delete
              </Button>
            </div>
          </div>
        </div>

        {loadingDetails ? (
          <div className="text-center py-12">
            <Spinner animation="border" variant="primary" />
            <p className="mt-3 text-gray-500">Loading certificates...</p>
          </div>
        ) : (
          <>
            {groupDetails?.certificates.length > 0 ? (
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                {groupDetails.certificates.map((cert) => (
                  <div
                    key={cert.id}
                    className="bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow p-4 flex flex-col justify-between"
                  >
                    <div>
                      <div className="flex justify-between items-start mb-2">
                        <h5 className="font-bold text-gray-900 mb-0 truncate pr-2">
                          {cert.recipient_name}
                        </h5>
                        {cert.sent_at ? (
                          <div className="bg-green-100 text-green-700 p-1 rounded-full">
                            <CheckCircle size={14} />
                          </div>
                        ) : (
                          <div className="bg-gray-100 text-gray-500 p-1 rounded-full">
                            <Mail size={14} />
                          </div>
                        )}
                      </div>
                      <p className="text-sm text-gray-600 mb-1 truncate">
                        {cert.recipient_email}
                      </p>
                      <p className="text-xs text-gray-400 uppercase tracking-wide font-semibold mb-3">
                        {cert.course_title}
                      </p>
                    </div>
                    <div className="pt-3 border-t border-gray-100 flex justify-between items-center text-xs text-gray-500">
                      <span>
                        Issued: {new Date(cert.issue_date).toLocaleDateString()}
                      </span>
                      <span
                        className={
                          cert.sent_at
                            ? "text-green-600 font-medium"
                            : "text-gray-400"
                        }
                      >
                        {cert.sent_at ? "Emailed" : "Pending"}
                      </span>
                    </div>
                  </div>
                ))}
              </div>
            ) : (
              <div className="text-center py-16 bg-gray-50 rounded-xl border border-dashed border-gray-300">
                <Folder size={48} className="text-gray-300 mx-auto mb-3" />
                <h4 className="text-gray-600 font-medium">Empty Group</h4>
                <p className="text-gray-400 text-sm">
                  This group doesn't have any certificates yet.
                </p>
              </div>
            )}
          </>
        )}
      </Container>
    );
  }

  // --- GROUPS LIST VIEW ---
  return (
    <Container fluid className="px-4 py-4">
      <Toaster position="top-right" />
      <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4">
        <div>
          <h2 className="text-2xl font-bold text-gray-900">
            Certificate Groups
          </h2>
          <p className="text-gray-500 mt-1">
            Organize your certificates into batches.
          </p>
        </div>
        <Button
          variant="primary"
          onClick={() => setShowCreateModal(true)}
          className="d-flex align-items-center shadow-sm"
        >
          <Plus size={20} className="me-2" /> New Group
        </Button>
      </div>

      {groups.length > 0 ? (
        <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
          {groups.map((group) => (
            <div
              key={group.id}
              onClick={() => handleViewGroup(group)}
              className="bg-white rounded-xl border border-gray-200 p-6 cursor-pointer hover:shadow-lg hover:border-indigo-300 transition-all group relative overflow-hidden"
            >
              <div className="absolute top-0 right-0 p-4 opacity-0 group-hover:opacity-100 transition-opacity">
                <ChevronLeft size={16} className="rotate-180 text-indigo-500" />
              </div>

              <div className="w-12 h-12 bg-indigo-50 rounded-lg flex items-center justify-center text-indigo-600 mb-4 group-hover:bg-indigo-600 group-hover:text-white transition-colors">
                <Folder size={24} />
              </div>

              <h3 className="text-lg font-bold text-gray-900 mb-1 truncate">
                {group.name}
              </h3>

              <p className="text-gray-500 text-sm mb-4">
                {group.certificate_count} certificate
                {group.certificate_count !== 1 ? "s" : ""}
              </p>

              <div className="pt-4 border-t border-gray-100 text-xs text-gray-400 flex items-center">
                Created {new Date(group.created_at).toLocaleDateString()}
              </div>
            </div>
          ))}
        </div>
      ) : (
        <div className="text-center py-20 bg-white rounded-xl border border-dashed border-gray-300">
          <div className="w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4">
            <Folder size={32} className="text-gray-400" />
          </div>
          <h3 className="text-lg font-bold text-gray-900">No groups yet</h3>
          <p className="text-gray-500 max-w-sm mx-auto mt-2 mb-6">
            Groups help you organize certificates for specific events, cohorts,
            or courses.
          </p>
          <Button
            variant="outline-primary"
            onClick={() => setShowCreateModal(true)}
          >
            Create your first group
          </Button>
        </div>
      )}

      {totalPages > 1 && (
        <div className="flex justify-center mt-8">
          <div className="flex gap-2">
            {[...Array(totalPages).keys()].map((num) => (
              <button
                key={num + 1}
                onClick={() => setCurrentPage(num + 1)}
                className={`w-8 h-8 rounded-md text-sm font-medium transition-colors ${
                  currentPage === num + 1
                    ? "bg-indigo-600 text-white"
                    : "bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"
                }`}
              >
                {num + 1}
              </button>
            ))}
          </div>
        </div>
      )}

      {/* CREATE GROUP MODAL */}
      <Modal
        show={showCreateModal}
        onHide={() => setShowCreateModal(false)}
        centered
        backdrop="static"
      >
        <Modal.Header closeButton className="border-0 pb-0">
          <Modal.Title className="font-bold text-gray-900">
            Create New Group
          </Modal.Title>
        </Modal.Header>
        <Modal.Body className="pt-4">
          <Form.Group>
            <Form.Label className="font-medium text-gray-700">
              Group Name
            </Form.Label>
            <Form.Control
              type="text"
              placeholder="e.g., Summer 2025 Bootcamp"
              value={newGroupName}
              onChange={(e) => setNewGroupName(e.target.value)}
              className="py-2.5"
              autoFocus
            />
            <Form.Text className="text-muted">
              Use a descriptive name to easily find this batch later.
            </Form.Text>
          </Form.Group>
        </Modal.Body>
        <Modal.Footer className="border-0 pt-0">
          <Button
            variant="light"
            onClick={() => setShowCreateModal(false)}
            className="text-gray-600"
          >
            Cancel
          </Button>
          <Button
            variant="primary"
            onClick={handleCreateGroup}
            className="px-4"
          >
            Create Group
          </Button>
        </Modal.Footer>
      </Modal>
    </Container>
  );
}

export default GroupsPage;



==================================================
FILE: pages\HelpArticlePage.jsx
==================================================

// frontend/src/pages/HelpArticlePage.jsx

import React from "react";
import { useParams, Link, Navigate } from "react-router-dom";
import { Container, Row, Col, Card, Button } from "react-bootstrap";
import { ArrowLeft, ChatDots } from "react-bootstrap-icons";
import { helpArticles } from "../data/helpArticles.jsx";
import "../styles/HelpCenter.css"; // --- IMPORT THE NEW STYLESHEET

function HelpArticlePage() {
  const { slug } = useParams();
  const article = helpArticles.find((art) => art.slug === slug);

  if (!article) {
    return <Navigate to="/dashboard/support" />;
  }

  return (
    <Container>
      <Row className="justify-content-center">
        <Col lg={8}>
          <Link
            to="/dashboard/support"
            className="text-decoration-none text-muted d-inline-block mb-4"
          >
            <ArrowLeft /> Back to Help Center
          </Link>
          <Card className="shadow-sm border-0">
            <Card.Body className="p-4 p-md-5">
              <h1 className="fw-bold mb-4">{article.title}</h1>
              {/* This div now gets styled by our new CSS */}
              <div className="article-content">{article.content}</div>
            </Card.Body>
          </Card>

          <div className="p-4 mt-5 rounded-3 bg-light text-center">
            <h4 className="fw-bold">Still need help?</h4>
            <p className="text-muted">
              If this article didn't solve your issue, our team is ready to
              assist.
            </p>
            <Button as={Link} to="/dashboard/support/tickets" variant="primary">
              <ChatDots className="me-2" /> Contact Support
            </Button>
          </div>
        </Col>
      </Row>
    </Container>
  );
}

export default HelpArticlePage;



==================================================
FILE: pages\LandingPage.jsx
==================================================

import React, { useState, useEffect } from "react";
import { Link } from "react-router-dom";
import {
  Check,
  Building,
  Users,
  Award,
  ArrowRight,
  Code,
  ShieldCheck,
  Zap,
  Layout,
  ChevronLeft,
  ChevronRight,
  Quote,
} from "lucide-react";
import PublicHeader from "../components/PublicHeader";
import PublicFooter from "../components/PublicFooter";

// --- SECTIONS ---

const Hero = () => (
  <section className="relative overflow-hidden bg-white pt-16 pb-24 lg:pt-32 lg:pb-40">
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 text-center">
      <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-indigo-50 text-indigo-600 text-sm font-semibold mb-8 border border-indigo-100">
        <span className="relative flex h-2 w-2">
          <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-indigo-400 opacity-75"></span>
          <span className="relative inline-flex rounded-full h-2 w-2 bg-indigo-500"></span>
        </span>
        Now supporting bulk PDF exports
      </div>
      <h1 className="text-5xl md:text-7xl font-extrabold text-gray-900 tracking-tight mb-6 leading-tight">
        Issue <span className="text-indigo-600">Verifiable</span> <br />
        Credentials in Seconds.
      </h1>
      <p className="mt-4 max-w-2xl mx-auto text-xl text-gray-500 mb-10">
        Create branded certificates, upload recipients via CSV, and auto-deliver
        secure PDFs. No fakeable docs. No bloated tools. Just simple issuance.
      </p>
      <div className="flex flex-col sm:flex-row gap-4 justify-center">
        <Link
          to="/signup"
          className="inline-flex items-center justify-center px-8 py-4 text-base font-bold text-white bg-indigo-600 rounded-xl hover:bg-indigo-700 transition-all shadow-lg hover:shadow-indigo-500/25 no-underline"
        >
          Start Issuing Free
          <ArrowRight className="ml-2 -mr-1" size={20} />
        </Link>
        <Link
          to="/search"
          className="inline-flex items-center justify-center px-8 py-4 text-base font-bold text-gray-700 bg-white border border-gray-200 rounded-xl hover:bg-gray-50 transition-all no-underline"
        >
          Verify a Certificate
        </Link>
      </div>
    </div>

    {/* Abstract Background Decoration */}
    <div className="absolute top-0 left-1/2 w-full -translate-x-1/2 h-full z-0 pointer-events-none opacity-30">
      <div className="absolute top-20 left-10 w-72 h-72 bg-purple-300 rounded-full mix-blend-multiply filter blur-3xl animate-blob"></div>
      <div className="absolute top-20 right-10 w-72 h-72 bg-indigo-300 rounded-full mix-blend-multiply filter blur-3xl animate-blob animation-delay-2000"></div>
      <div className="absolute -bottom-32 left-1/2 w-72 h-72 bg-pink-300 rounded-full mix-blend-multiply filter blur-3xl animate-blob animation-delay-4000"></div>
    </div>
  </section>
);

const Features = () => (
  <section className="py-24 bg-gray-50">
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div className="text-center max-w-3xl mx-auto mb-16">
        <h2 className="text-indigo-600 font-semibold tracking-wide uppercase text-sm">
          Features
        </h2>
        <p className="mt-2 text-3xl font-extrabold text-gray-900 sm:text-4xl">
          Everything you need to issue credentials
        </p>
      </div>

      <div className="grid md:grid-cols-3 gap-8">
        {[
          {
            icon: Layout,
            title: "Custom Templates",
            desc: "Drag & drop builder. Upload your own designs or use our professional presets.",
          },
          {
            icon: Zap,
            title: "Bulk Generation",
            desc: "Upload a CSV with thousands of names. We generate and email them instantly.",
          },
          {
            icon: ShieldCheck,
            title: "Bank-Grade Security",
            desc: "Every certificate gets a unique ID and QR code for instant, fraud-proof verification.",
          },
        ].map((feature, idx) => (
          <div
            key={idx}
            className="bg-white p-8 rounded-2xl border border-gray-100 shadow-sm hover:shadow-md transition-all"
          >
            <div className="w-12 h-12 bg-indigo-50 rounded-xl flex items-center justify-center text-indigo-600 mb-6">
              <feature.icon size={24} />
            </div>
            <h3 className="text-xl font-bold text-gray-900 mb-3">
              {feature.title}
            </h3>
            <p className="text-gray-500 leading-relaxed">{feature.desc}</p>
          </div>
        ))}
      </div>
    </div>
  </section>
);

const Stats = () => (
  <section className="py-12 bg-indigo-900 text-white">
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div className="grid grid-cols-1 md:grid-cols-3 gap-8 text-center divide-y md:divide-y-0 md:divide-x divide-indigo-800">
        <div className="p-4">
          <Building className="mx-auto mb-4 text-indigo-300" size={32} />
          <div className="text-4xl font-extrabold mb-1">10+</div>
          <div className="text-indigo-200">Companies Onboard</div>
        </div>
        <div className="p-4">
          <Users className="mx-auto mb-4 text-indigo-300" size={32} />
          <div className="text-4xl font-extrabold mb-1">20+</div>
          <div className="text-indigo-200">Active Issuers</div>
        </div>
        <div className="p-4">
          <Award className="mx-auto mb-4 text-indigo-300" size={32} />
          <div className="text-4xl font-extrabold mb-1">200+</div>
          <div className="text-indigo-200">Certificates Verified</div>
        </div>
      </div>
    </div>
  </section>
);

const PricingCard = ({
  title,
  price,
  suffix,
  features,
  isPopular,
  btnStyle,
  link,
}) => (
  <div
    className={`relative flex flex-col p-8 bg-white rounded-2xl border ${
      isPopular
        ? "border-indigo-600 shadow-xl scale-105 z-10"
        : "border-gray-200 shadow-sm"
    } transition-all`}
  >
    {isPopular && (
      <div className="absolute top-0 right-0 -mt-3 mr-3 bg-indigo-600 text-white text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wide">
        Most Popular
      </div>
    )}
    <h3 className="text-lg font-semibold text-gray-900 mb-4">{title}</h3>
    <div className="flex items-baseline mb-8">
      <span className="text-4xl font-extrabold text-gray-900">{price}</span>
      <span className="text-gray-500 ml-2">{suffix}</span>
    </div>
    <ul className="space-y-4 mb-8 flex-1">
      {features.map((feat, idx) => (
        <li key={idx} className="flex items-start text-sm text-gray-600">
          <Check size={18} className="text-green-500 mr-3 shrink-0" />
          {feat}
        </li>
      ))}
    </ul>
    <Link
      to={link}
      className={`w-full py-3 px-4 rounded-xl font-bold text-center transition-colors no-underline ${
        btnStyle === "primary"
          ? "bg-indigo-600 text-white hover:bg-indigo-700"
          : "bg-indigo-50 text-indigo-700 hover:bg-indigo-100"
      }`}
    >
      Choose {title}
    </Link>
  </div>
);

const Pricing = () => (
  <section id="pricing" className="py-24 bg-white">
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div className="text-center max-w-3xl mx-auto mb-16">
        <h2 className="text-3xl font-extrabold text-gray-900 sm:text-4xl">
          Flexible Pay-As-You-Go
        </h2>
        <p className="mt-4 text-xl text-gray-500">
          No monthly subscriptions. Credits never expire. Upgrade only when you
          need to.
        </p>
      </div>

      <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-6 items-start">
        <PricingCard
          title="Starter"
          price="$15"
          suffix="for 500 certs"
          features={[
            "500 Credits",
            "Unlimited Templates",
            "Email Delivery",
            "PDF Downloads",
          ]}
          link="/signup?plan=starter"
        />
        <PricingCard
          title="Growth"
          price="$50"
          suffix="for 2,000 certs"
          features={[
            "2,000 Credits",
            "Unlimited Templates",
            "Email Delivery",
            "Priority Support",
          ]}
          link="/signup?plan=growth"
        />
        <PricingCard
          title="Pro"
          price="$100"
          suffix="for 5,000 certs"
          features={[
            "5,000 Credits",
            "Everything in Growth",
            "API Access",
            "Custom Branding",
          ]}
          isPopular={true}
          btnStyle="primary"
          link="/signup?plan=pro"
        />
        <PricingCard
          title="Enterprise"
          price="$300"
          suffix="for 20,000 certs"
          features={[
            "20,000 Credits",
            "Dedicated Manager",
            "SLA Support",
            "API Access",
          ]}
          link="/signup?plan=enterprise"
        />
      </div>
    </div>
  </section>
);

const ApiCTA = () => (
  <section className="py-20 bg-gray-900 text-white overflow-hidden relative">
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 flex flex-col md:flex-row items-center justify-between gap-12">
      <div className="md:w-1/2">
        <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-indigo-900/50 border border-indigo-700 text-indigo-300 text-sm font-semibold mb-6">
          <Code size={16} /> For Developers
        </div>
        <h2 className="text-3xl md:text-4xl font-bold mb-4">
          Build on our Infrastructure
        </h2>
        <p className="text-gray-400 text-lg mb-8 leading-relaxed">
          Automate certificate generation directly from your own application
          using our robust REST API. Perfect for LMS platforms, event apps, and
          HR tools.
        </p>
        <Link
          to="/docs"
          className="inline-flex items-center text-white font-bold hover:text-indigo-400 no-underline text-lg"
        >
          Read the Documentation <ArrowRight className="ml-2" size={20} />
        </Link>
      </div>
      <div className="md:w-1/2 bg-gray-800 rounded-xl p-6 shadow-2xl border border-gray-700 font-mono text-sm">
        <div className="flex gap-2 mb-4">
          <div className="w-3 h-3 rounded-full bg-red-500"></div>
          <div className="w-3 h-3 rounded-full bg-yellow-500"></div>
          <div className="w-3 h-3 rounded-full bg-green-500"></div>
        </div>
        <div className="space-y-2 text-indigo-300">
          <p>
            <span className="text-pink-400">POST</span> /api/v1/certificates
          </p>
          <p className="text-gray-400">{`{`}</p>
          <p className="pl-4">
            <span className="text-blue-400">"template_id"</span>:{" "}
            <span className="text-green-400">"tmpl_123"</span>,
          </p>
          <p className="pl-4">
            <span className="text-blue-400">"recipient_name"</span>:{" "}
            <span className="text-green-400">"Jane Doe"</span>,
          </p>
          <p className="pl-4">
            <span className="text-blue-400">"course"</span>:{" "}
            <span className="text-green-400">"React Advanced"</span>
          </p>
          <p className="text-gray-400">{`}`}</p>
          <p className="mt-4 text-green-500">// Response: 201 Created</p>
        </div>
      </div>
    </div>
  </section>
);

const Testimonials = () => {
  const testimonials = [
    {
      quote:
        "CertifyMe is a game changer. The ability to custom my certificates and issue them in bulk made all the difference.",
      name: "Chibuzor Azodo, PhD",
      title: "Founder, Staunch Analytics Ltd",
      image: "/images/chibuzor-azodo.png",
    },
  ];

  return (
    <section className="py-24 bg-gray-50 border-b border-gray-200">
      <div className="max-w-4xl mx-auto px-4 text-center">
        <div className="bg-white p-8 md:p-12 rounded-2xl shadow-sm border border-gray-100 relative">
          <Quote
            size={48}
            className="text-indigo-100 absolute top-8 left-8 -z-0"
          />
          <div className="relative z-10">
            <p className="text-xl md:text-2xl text-gray-700 font-medium italic mb-8">
              "{testimonials[0].quote}"
            </p>
            <div className="flex items-center justify-center gap-4">
              <img
                src={testimonials[0].image}
                alt={testimonials[0].name}
                className="w-12 h-12 rounded-full object-cover"
              />
              <div className="text-left">
                <div className="font-bold text-gray-900">
                  {testimonials[0].name}
                </div>
                <div className="text-sm text-gray-500">
                  {testimonials[0].title}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  );
};

function LandingPage() {
  return (
    <div className="font-sans text-gray-900 bg-white">
      <PublicHeader />
      <main>
        <Hero />
        <div className="py-10 border-b border-gray-100 bg-white">
          <div className="max-w-7xl mx-auto px-4 flex flex-wrap justify-center items-center gap-8 md:gap-16 opacity-50 grayscale hover:grayscale-0 transition-all duration-500">
            <img
              src="/images/partners/logo1.png"
              className="h-8 md:h-10 object-contain"
              alt="Partner"
            />
            <img
              src="/images/partners/logo2.png"
              className="h-8 md:h-10 object-contain"
              alt="Partner"
            />
            <img
              src="/images/partners/logo3.png"
              className="h-8 md:h-10 object-contain"
              alt="Partner"
            />
          </div>
        </div>
        <Features />
        <Stats />
        <Testimonials />
        <Pricing />
        <ApiCTA />
      </main>
      <PublicFooter />
    </div>
  );
}

export default LandingPage;



==================================================
FILE: pages\LoginPage.jsx
==================================================

import React, { useState } from "react";
import { Link, useNavigate, useSearchParams } from "react-router-dom";
import { Form, Spinner, Alert } from "react-bootstrap";
import {
  Eye,
  EyeOff,
  AlertTriangle,
  CheckCircle,
  ArrowLeft,
  Mail,
  Lock,
  ArrowRight,
} from "lucide-react";
import { loginUser, resendVerificationEmail } from "../api";

function LoginPage() {
  const [formData, setFormData] = useState({ email: "", password: "" });
  const [error, setError] = useState("");
  const [success, setSuccess] = useState("");
  const [loading, setLoading] = useState(false);
  const [showVerificationPrompt, setShowVerificationPrompt] = useState(false);
  const [resendLoading, setResendLoading] = useState(false);
  const [showPassword, setShowPassword] = useState(false);
  const navigate = useNavigate();
  const [searchParams] = useSearchParams();
  const plan = searchParams.get("plan");

  const handleChange = (e) => {
    setFormData({ ...formData, [e.target.name]: e.target.value });
  };

  const handleResendCode = async () => {
    setError("");
    setSuccess("");
    setResendLoading(true);
    try {
      const response = await resendVerificationEmail(formData.email);
      setSuccess(response.data.msg);
    } catch (err) {
      setError(err.response?.data?.msg || "Failed to resend code.");
    } finally {
      setResendLoading(false);
    }
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError("");
    setSuccess("");
    setLoading(true);
    setShowVerificationPrompt(false);

    try {
      const response = await loginUser(formData);
      localStorage.setItem("token", response.data.access_token);

      if (plan) {
        navigate("/dashboard/settings", {
          state: { defaultTab: "billing", planToPurchase: plan },
        });
      } else {
        navigate("/dashboard");
      }
    } catch (err) {
      const errorData = err.response?.data;
      if (errorData?.unverified) {
        setShowVerificationPrompt(true);
      } else {
        setError(errorData?.msg || "Invalid credentials.");
      }
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8 font-sans">
      <div className="sm:mx-auto sm:w-full sm:max-w-md">
        <Link
          to="/"
          className="flex justify-center items-center gap-2 mb-6 no-underline"
        >
          <img src="/images/certbadge.png" alt="Logo" className="h-10 w-10" />
          <span className="font-bold text-2xl text-gray-900">CertifyMe</span>
        </Link>
        <h2 className="mt-6 text-center text-3xl font-extrabold text-gray-900">
          Sign in to your account
        </h2>
        <p className="mt-2 text-center text-sm text-gray-600">
          Or{" "}
          <Link
            to="/signup"
            className="font-medium text-indigo-600 hover:text-indigo-500 no-underline"
          >
            create a free account
          </Link>
        </p>
      </div>

      <div className="mt-8 sm:mx-auto sm:w-full sm:max-w-md">
        <div className="bg-white py-8 px-4 shadow-xl sm:rounded-2xl sm:px-10 border border-gray-100">
          {error && !showVerificationPrompt && (
            <div className="mb-4 p-3 rounded-lg bg-red-50 text-red-700 text-sm flex items-start gap-2">
              <AlertTriangle size={16} className="mt-0.5" /> {error}
            </div>
          )}

          {success && (
            <div className="mb-4 p-3 rounded-lg bg-green-50 text-green-700 text-sm flex items-start gap-2">
              <CheckCircle size={16} className="mt-0.5" /> {success}
            </div>
          )}

          {showVerificationPrompt && (
            <div className="bg-yellow-50 p-3 rounded-lg mb-4 border border-yellow-200 text-yellow-800">
              <div className="flex items-start">
                <AlertTriangle
                  size={20}
                  className="mr-2 mt-0.5 flex-shrink-0"
                />
                <div>
                  <h6 className="font-bold mb-1">Account not verified</h6>
                  <p className="text-xs mb-2">
                    Check your email for the code or request a new one.
                  </p>
                  <div className="flex gap-3">
                    <button
                      onClick={handleResendCode}
                      disabled={resendLoading}
                      className="text-xs font-semibold text-yellow-900 underline hover:text-black"
                    >
                      {resendLoading ? "Sending..." : "Resend Code"}
                    </button>
                    <Link
                      to="/verify-email"
                      state={{ email: formData.email }}
                      className="text-xs font-semibold text-indigo-600 hover:text-indigo-800"
                    >
                      Enter Code &rarr;
                    </Link>
                  </div>
                </div>
              </div>
            </div>
          )}

          <form className="space-y-6" onSubmit={handleSubmit}>
            <div>
              <label
                htmlFor="email"
                className="block text-sm font-medium text-gray-700"
              >
                Email address
              </label>
              <div className="mt-1 relative rounded-md shadow-sm">
                <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <Mail className="h-5 w-5 text-gray-400" />
                </div>
                <input
                  id="email"
                  name="email"
                  type="email"
                  required
                  value={formData.email}
                  onChange={handleChange}
                  className="block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
                  placeholder="you@example.com"
                />
              </div>
            </div>

            <div>
              <div className="flex justify-between items-center mb-1">
                <label
                  htmlFor="password"
                  className="block text-sm font-medium text-gray-700"
                >
                  Password
                </label>
                <Link
                  to="/forgot-password"
                  className="text-sm font-medium text-indigo-600 hover:text-indigo-500 no-underline"
                >
                  Forgot password?
                </Link>
              </div>
              <div className="mt-1 relative rounded-md shadow-sm">
                <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <Lock className="h-5 w-5 text-gray-400" />
                </div>
                <input
                  id="password"
                  name="password"
                  type={showPassword ? "text" : "password"}
                  required
                  value={formData.password}
                  onChange={handleChange}
                  className="block w-full pl-10 pr-10 py-2.5 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
                  placeholder="••••••••"
                />
                <button
                  type="button"
                  className="absolute inset-y-0 right-0 pr-3 flex items-center cursor-pointer text-gray-400 hover:text-gray-600"
                  onClick={() => setShowPassword(!showPassword)}
                >
                  {showPassword ? <EyeOff size={18} /> : <Eye size={18} />}
                </button>
              </div>
            </div>

            <div>
              <button
                type="submit"
                disabled={loading}
                className="w-full flex justify-center py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-70 disabled:cursor-not-allowed transition-all"
              >
                {loading ? (
                  <Spinner animation="border" size="sm" />
                ) : (
                  <span className="flex items-center">
                    Sign in <ArrowRight className="ml-2 h-4 w-4" />
                  </span>
                )}
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  );
}

export default LoginPage;



==================================================
FILE: pages\MyCertificatesPage.jsx
==================================================

import React, { useState, useEffect, useMemo } from "react";
import { Link, useNavigate } from "react-router-dom";
import {
  getCertificates,
  getTemplates,
  deleteCertificate,
  getCertificatePDF,
  sendCertificateEmail,
  sendBulkEmails,
  getCurrentUser,
} from "../api";
import {
  Pencil,
  Trash,
  PlusCircle,
  Download,
  Eye,
  Mail,
  Send,
  HelpCircle,
  Search,
  Filter,
  ChevronLeft,
  ChevronRight,
  MoreHorizontal,
  FileText,
  CheckCircle,
} from "lucide-react";
import toast, { Toaster } from "react-hot-toast";

function ErrorBoundary({ children }) {
  const [hasError, setHasError] = useState(false);

  useEffect(() => {
    const errorHandler = (error) => {
      console.error(
        "Error caught by ErrorBoundary in MyCertificatesPage:",
        error
      );
      setHasError(true);
    };
    const originalError = console.error;
    console.error = (...args) => {
      if (/The above error occurred in the <.*> component/.test(args[0])) {
        errorHandler(args[0]);
      }
      originalError(...args);
    };

    return () => {
      console.error = originalError;
    };
  }, []);

  if (hasError) {
    return (
      <div className="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded m-4">
        Something went wrong while rendering this page. Please refresh or try
        logging in again.
      </div>
    );
  }
  return children;
}

function MyCertificatesPage() {
  const [certificates, setCertificates] = useState([]);
  const [templates, setTemplates] = useState([]);
  const [user, setUser] = useState(null);
  const [error, setError] = useState("");
  const [showDeleteModal, setShowDeleteModal] = useState(false);
  const [selectedCert, setSelectedCert] = useState(null);
  const [loading, setLoading] = useState(true);

  // Action States
  const [downloadingId, setDownloadingId] = useState(null);
  const [sendingId, setSendingId] = useState(null);
  const [isBulkSending, setIsBulkSending] = useState(false);
  const [selectedCertIds, setSelectedCertIds] = useState(new Set());

  // Filter & Pagination States
  const [searchTerm, setSearchTerm] = useState("");
  const [filterStatus, setFilterStatus] = useState("all"); // all, sent, not_sent
  const [currentPage, setCurrentPage] = useState(1);
  const itemsPerPage = 10;

  const navigate = useNavigate();

  useEffect(() => {
    fetchData();
  }, []);

  const fetchData = async () => {
    try {
      setLoading(true);
      const [certResponse, templateResponse, userResponse] = await Promise.all([
        getCertificates(),
        getTemplates(),
        getCurrentUser(),
      ]);
      // Sort by newest first
      const sortedCertificates = certResponse.data.sort(
        (a, b) =>
          new Date(b.issue_date).getTime() - new Date(a.issue_date).getTime()
      );
      setCertificates(sortedCertificates);
      setTemplates(templateResponse.data.templates);
      setUser(userResponse.data);
    } catch (err) {
      console.error("Fetch error:", err);
      setError(
        "Could not fetch dashboard data. Your session might have expired. Please try logging in again."
      );
    } finally {
      setLoading(false);
    }
  };

  // --- Derived State for Filtering & Pagination ---
  const filteredCertificates = useMemo(() => {
    return certificates.filter((cert) => {
      const matchesSearch =
        cert.recipient_name.toLowerCase().includes(searchTerm.toLowerCase()) ||
        cert.course_title.toLowerCase().includes(searchTerm.toLowerCase());

      const matchesStatus =
        filterStatus === "all"
          ? true
          : filterStatus === "sent"
          ? !!cert.sent_at
          : !cert.sent_at;

      return matchesSearch && matchesStatus;
    });
  }, [certificates, searchTerm, filterStatus]);

  const totalPages = Math.ceil(filteredCertificates.length / itemsPerPage);
  const paginatedCertificates = useMemo(() => {
    const startIndex = (currentPage - 1) * itemsPerPage;
    return filteredCertificates.slice(startIndex, startIndex + itemsPerPage);
  }, [filteredCertificates, currentPage]);

  // --- Handlers ---

  const handlePageChange = (newPage) => {
    if (newPage >= 1 && newPage <= totalPages) {
      setCurrentPage(newPage);
    }
  };

  const handleSendEmail = (certId) => {
    setSendingId(certId);
    const promise = sendCertificateEmail(certId);

    toast.promise(promise, {
      loading: "Sending email...",
      success: (res) => {
        setCertificates((certs) =>
          certs.map((c) =>
            c.id === certId ? { ...c, sent_at: new Date().toISOString() } : c
          )
        );
        return res.data.msg || "Email sent successfully!";
      },
      error: (err) => err.response?.data?.msg || "Failed to send email.",
    });

    promise.finally(() => setSendingId(null));
  };

  const handleSelectOne = (certId) => {
    const newSelection = new Set(selectedCertIds);
    if (newSelection.has(certId)) newSelection.delete(certId);
    else newSelection.add(certId);
    setSelectedCertIds(newSelection);
  };

  const handleSelectAll = (e) => {
    if (e.target.checked) {
      // Select all currently filtered certificates
      const allIds = filteredCertificates.map((c) => c.id);
      setSelectedCertIds(new Set(allIds));
    } else {
      setSelectedCertIds(new Set());
    }
  };

  const handleBulkSend = () => {
    if (selectedCertIds.size === 0) {
      toast.error("Please select at least one certificate to send.");
      return;
    }
    setIsBulkSending(true);
    const ids = Array.from(selectedCertIds);
    const promise = sendBulkEmails(ids);

    toast.promise(promise, {
      loading: `Sending ${ids.length} emails...`,
      success: (res) => {
        fetchData();
        setSelectedCertIds(new Set());
        const { sent, failed } = res.data;
        return `Process complete! Sent: ${sent.length}, Failed: ${
          failed?.length || 0
        }.`;
      },
      error: (err) => err.response?.data?.msg || "Bulk send failed.",
    });

    promise.finally(() => setIsBulkSending(false));
  };

  const handleDelete = async () => {
    if (!selectedCert) return;
    const promise = deleteCertificate(selectedCert.id);
    toast.promise(promise, {
      loading: "Deleting certificate...",
      success: () => {
        setCertificates(
          certificates.filter((cert) => cert.id !== selectedCert.id)
        );
        setShowDeleteModal(false);
        setSelectedCert(null);
        // Clear from selection if it was selected
        if (selectedCertIds.has(selectedCert.id)) {
          const newSet = new Set(selectedCertIds);
          newSet.delete(selectedCert.id);
          setSelectedCertIds(newSet);
        }
        return "Certificate deleted successfully.";
      },
      error: (err) =>
        err.response?.data?.msg || "Failed to delete certificate.",
    });
  };

  const handleDownload = (cert) => {
    setDownloadingId(cert.id);
    const promise = getCertificatePDF(cert.id);
    toast.promise(promise, {
      loading: "Generating PDF...",
      success: (response) => {
        const url = window.URL.createObjectURL(new Blob([response.data]));
        const link = document.createElement("a");
        link.href = url;
        link.setAttribute(
          "download",
          `certificate_${cert.verification_id}.pdf`
        );
        document.body.appendChild(link);
        link.click();
        link.parentNode.removeChild(link);
        window.URL.revokeObjectURL(url);
        return "Download started!";
      },
      error: (err) => err.response?.data?.msg || "Failed to download PDF.",
    });
    promise.finally(() => setDownloadingId(null));
  };

  const stats = [
    {
      title: "Certificates Issued",
      value: certificates.length,
      icon: <FileText className="w-6 h-6" />,
      color: "text-blue-600 bg-blue-50",
    },
    {
      title: "Templates Created",
      value: templates.length,
      icon: <Eye className="w-6 h-6" />,
      color: "text-green-600 bg-green-50",
    },
    {
      title: "Quota Remaining",
      value: user ? user.cert_quota : "...",
      icon: <HelpCircle className="w-6 h-6" />,
      color: "text-purple-600 bg-purple-50",
    },
  ];

  return (
    <ErrorBoundary>
      <div className="max-w-7xl mx-auto pb-12">
        <Toaster position="top-right" />

        {/* Header Section */}
        <div className="mb-8 flex flex-col md:flex-row md:items-end justify-between gap-4">
          <div>
            <h2 className="text-3xl font-bold text-gray-900">
              Welcome back, {user?.name?.split(" ")[0]}!
            </h2>
            <p className="text-gray-500 mt-1">
              Manage your certificates and templates from here.
            </p>
          </div>
          <div className="flex gap-3">
            <Link
              to="/dashboard/create"
              className="inline-flex items-center justify-center bg-indigo-600 text-white rounded-lg py-2.5 px-5 hover:bg-indigo-700 transition-colors font-medium shadow-sm"
            >
              <PlusCircle className="w-5 h-5 mr-2" />
              Create New
            </Link>
            <Link
              to="/dashboard/bulk-create"
              className="inline-flex items-center justify-center bg-white border border-gray-300 text-gray-700 rounded-lg py-2.5 px-5 hover:bg-gray-50 transition-colors font-medium shadow-sm"
            >
              <PlusCircle className="w-5 h-5 mr-2" />
              Bulk Create
            </Link>
          </div>
        </div>

        {error && (
          <div className="bg-red-50 border-l-4 border-red-500 text-red-700 p-4 rounded-md mb-6 shadow-sm">
            {error}
          </div>
        )}

        {/* Stats Grid */}
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
          {stats.map((stat, index) => (
            <div
              key={index}
              className="bg-white rounded-xl shadow-sm border border-gray-100 p-6 flex items-center gap-4 hover:shadow-md transition-shadow"
            >
              <div className={`p-3 rounded-lg ${stat.color}`}>{stat.icon}</div>
              <div>
                <p className="text-gray-500 text-sm font-medium">
                  {stat.title}
                </p>
                <h3 className="text-2xl font-bold text-gray-900 mt-0.5">
                  {stat.value}
                </h3>
              </div>
            </div>
          ))}
        </div>

        {/* Main Content Card */}
        <div className="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
          {/* Toolbar */}
          <div className="p-5 border-b border-gray-200 flex flex-col lg:flex-row gap-4 justify-between items-center bg-gray-50/50">
            <div className="flex flex-col sm:flex-row gap-4 w-full lg:w-auto">
              {/* Search */}
              <div className="relative w-full sm:w-64">
                <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <Search className="h-5 w-5 text-gray-400" />
                </div>
                <input
                  type="text"
                  placeholder="Search certificates..."
                  className="pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-sm"
                  value={searchTerm}
                  onChange={(e) => {
                    setSearchTerm(e.target.value);
                    setCurrentPage(1); // Reset to page 1 on search
                  }}
                />
              </div>

              {/* Filter Tabs */}
              <div className="flex bg-gray-200 p-1 rounded-lg self-start sm:self-auto">
                {["all", "sent", "not_sent"].map((status) => (
                  <button
                    key={status}
                    onClick={() => {
                      setFilterStatus(status);
                      setCurrentPage(1);
                    }}
                    className={`px-4 py-1.5 text-sm font-medium rounded-md transition-all ${
                      filterStatus === status
                        ? "bg-white text-gray-900 shadow-sm"
                        : "text-gray-600 hover:text-gray-900"
                    }`}
                  >
                    {status === "all"
                      ? "All"
                      : status === "sent"
                      ? "Emailed"
                      : "Pending"}
                  </button>
                ))}
              </div>
            </div>

            {/* Bulk Actions */}
            {selectedCertIds.size > 0 && (
              <div className="flex items-center gap-3 w-full lg:w-auto justify-end animate-in fade-in slide-in-from-top-2 duration-200">
                <span className="text-sm font-medium text-gray-600">
                  {selectedCertIds.size} selected
                </span>
                <button
                  onClick={handleBulkSend}
                  disabled={isBulkSending}
                  className="inline-flex items-center bg-blue-600 text-white text-sm font-medium rounded-lg py-2 px-4 hover:bg-blue-700 transition-colors shadow-sm disabled:opacity-50"
                >
                  {isBulkSending ? (
                    <div className="animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full mr-2" />
                  ) : (
                    <Send className="w-4 h-4 mr-2" />
                  )}
                  Send Email
                </button>
              </div>
            )}
          </div>

          {/* Table */}
          {loading ? (
            <div className="text-center py-20">
              <div className="animate-spin h-8 w-8 mx-auto text-indigo-600 border-4 border-indigo-200 border-t-indigo-600 rounded-full"></div>
              <p className="mt-3 text-gray-500">Loading your certificates...</p>
            </div>
          ) : filteredCertificates.length === 0 ? (
            <div className="text-center py-16 px-4">
              <div className="bg-gray-100 rounded-full h-16 w-16 flex items-center justify-center mx-auto mb-4">
                <Search className="h-8 w-8 text-gray-400" />
              </div>
              <h3 className="text-lg font-medium text-gray-900">
                No certificates found
              </h3>
              <p className="text-gray-500 mt-1 max-w-sm mx-auto">
                {searchTerm || filterStatus !== "all"
                  ? "Try adjusting your search or filters to find what you're looking for."
                  : "Get started by creating your first certificate."}
              </p>
              {!searchTerm && filterStatus === "all" && (
                <Link
                  to="/dashboard/create"
                  className="mt-4 inline-flex items-center text-indigo-600 font-medium hover:text-indigo-800"
                >
                  Create Certificate <ChevronRight className="w-4 h-4 ml-1" />
                </Link>
              )}
            </div>
          ) : (
            <div className="overflow-x-auto">
              <table className="min-w-full divide-y divide-gray-200">
                <thead className="bg-gray-50">
                  <tr>
                    <th scope="col" className="px-6 py-3 text-left">
                      <div className="flex items-center">
                        <input
                          type="checkbox"
                          onChange={handleSelectAll}
                          checked={
                            paginatedCertificates.length > 0 &&
                            paginatedCertificates.every((c) =>
                              selectedCertIds.has(c.id)
                            )
                          }
                          className="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer"
                        />
                      </div>
                    </th>
                    <th
                      scope="col"
                      className="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"
                    >
                      Recipient
                    </th>
                    <th
                      scope="col"
                      className="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"
                    >
                      Course / Event
                    </th>
                    <th
                      scope="col"
                      className="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"
                    >
                      Date Issued
                    </th>
                    <th
                      scope="col"
                      className="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"
                    >
                      Status
                    </th>
                    <th
                      scope="col"
                      className="px-6 py-3 text-right text-xs font-semibold text-gray-500 uppercase tracking-wider"
                    >
                      Actions
                    </th>
                  </tr>
                </thead>
                <tbody className="bg-white divide-y divide-gray-200">
                  {paginatedCertificates.map((cert) => {
                    const isSelected = selectedCertIds.has(cert.id);
                    return (
                      <tr
                        key={cert.id}
                        className={`hover:bg-gray-50 transition-colors ${
                          isSelected ? "bg-indigo-50/30" : ""
                        }`}
                      >
                        <td className="px-6 py-4 whitespace-nowrap">
                          <input
                            type="checkbox"
                            checked={isSelected}
                            onChange={() => handleSelectOne(cert.id)}
                            className="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer"
                          />
                        </td>
                        <td className="px-6 py-4 whitespace-nowrap">
                          <div className="font-medium text-gray-900">
                            {cert.recipient_name}
                          </div>
                          {cert.recipient_email && (
                            <div className="text-xs text-gray-500 mt-0.5">
                              {cert.recipient_email}
                            </div>
                          )}
                        </td>
                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
                          {cert.course_title}
                        </td>
                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                          {new Date(cert.issue_date).toLocaleDateString()}
                        </td>
                        <td className="px-6 py-4 whitespace-nowrap">
                          {cert.sent_at ? (
                            <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                              <CheckCircle className="w-3 h-3 mr-1" />
                              Emailed
                            </span>
                          ) : (
                            <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                              Pending
                            </span>
                          )}
                        </td>
                        <td className="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                          <div className="flex items-center justify-end space-x-2">
                            <button
                              onClick={() => handleSendEmail(cert.id)}
                              disabled={!!cert.sent_at || sendingId === cert.id}
                              className={`p-1.5 rounded-md transition-colors ${
                                cert.sent_at
                                  ? "text-gray-300 cursor-not-allowed"
                                  : "text-gray-500 hover:text-blue-600 hover:bg-blue-50"
                              }`}
                              title="Send Email"
                            >
                              {sendingId === cert.id ? (
                                <div className="animate-spin h-4 w-4 border-2 border-current border-t-transparent rounded-full" />
                              ) : (
                                <Mail className="w-4 h-4" />
                              )}
                            </button>

                            <button
                              onClick={() => handleDownload(cert)}
                              disabled={downloadingId === cert.id}
                              className="p-1.5 text-gray-500 hover:text-green-600 hover:bg-green-50 rounded-md transition-colors"
                              title="Download PDF"
                            >
                              {downloadingId === cert.id ? (
                                <div className="animate-spin h-4 w-4 border-2 border-current border-t-transparent rounded-full" />
                              ) : (
                                <Download className="w-4 h-4" />
                              )}
                            </button>

                            <div className="h-4 w-px bg-gray-200 mx-1"></div>

                            <button
                              onClick={() =>
                                navigate(`/dashboard/view/${cert.id}`)
                              }
                              className="p-1.5 text-gray-500 hover:text-indigo-600 hover:bg-indigo-50 rounded-md transition-colors"
                              title="View Details"
                            >
                              <Eye className="w-4 h-4" />
                            </button>

                            <button
                              onClick={() =>
                                navigate(`/dashboard/edit/${cert.id}`)
                              }
                              className="p-1.5 text-gray-500 hover:text-orange-600 hover:bg-orange-50 rounded-md transition-colors"
                              title="Edit"
                            >
                              <Pencil className="w-4 h-4" />
                            </button>

                            <button
                              onClick={() => {
                                setSelectedCert(cert);
                                setShowDeleteModal(true);
                              }}
                              className="p-1.5 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors"
                              title="Delete"
                            >
                              <Trash className="w-4 h-4" />
                            </button>
                          </div>
                        </td>
                      </tr>
                    );
                  })}
                </tbody>
              </table>
            </div>
          )}

          {/* Pagination */}
          {!loading && filteredCertificates.length > itemsPerPage && (
            <div className="px-6 py-4 border-t border-gray-200 flex items-center justify-between bg-gray-50/50">
              <p className="text-sm text-gray-700">
                Showing{" "}
                <span className="font-medium">
                  {(currentPage - 1) * itemsPerPage + 1}
                </span>{" "}
                to{" "}
                <span className="font-medium">
                  {Math.min(
                    currentPage * itemsPerPage,
                    filteredCertificates.length
                  )}
                </span>{" "}
                of{" "}
                <span className="font-medium">
                  {filteredCertificates.length}
                </span>{" "}
                results
              </p>
              <div className="flex gap-2">
                <button
                  onClick={() => handlePageChange(currentPage - 1)}
                  disabled={currentPage === 1}
                  className="p-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
                >
                  <ChevronLeft className="h-4 w-4" />
                </button>
                {Array.from({ length: totalPages }, (_, i) => i + 1)
                  .filter((page) => {
                    // Logic to show limited page numbers (start, end, current +/- 1)
                    return (
                      page === 1 ||
                      page === totalPages ||
                      Math.abs(page - currentPage) <= 1
                    );
                  })
                  .map((page, index, array) => (
                    <React.Fragment key={page}>
                      {index > 0 && array[index - 1] !== page - 1 && (
                        <span className="px-2 text-gray-500">...</span>
                      )}
                      <button
                        onClick={() => handlePageChange(page)}
                        className={`px-3 py-1 text-sm font-medium rounded-md ${
                          currentPage === page
                            ? "bg-indigo-600 text-white"
                            : "bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"
                        }`}
                      >
                        {page}
                      </button>
                    </React.Fragment>
                  ))}
                <button
                  onClick={() => handlePageChange(currentPage + 1)}
                  disabled={currentPage === totalPages}
                  className="p-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
                >
                  <ChevronRight className="h-4 w-4" />
                </button>
              </div>
            </div>
          )}
        </div>

        {/* Delete Modal */}
        {showDeleteModal && (
          <div className="fixed inset-0 bg-gray-900/50 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in duration-200">
            <div className="bg-white rounded-xl shadow-xl p-6 max-w-md w-full">
              <div className="flex items-center gap-3 text-red-600 mb-4">
                <div className="p-3 bg-red-100 rounded-full">
                  <Trash className="w-6 h-6" />
                </div>
                <h3 className="text-xl font-bold text-gray-900">
                  Delete Certificate?
                </h3>
              </div>

              <p className="text-gray-600 mb-6">
                Are you sure you want to delete the certificate for{" "}
                <strong>{selectedCert?.recipient_name}</strong>? This action
                cannot be undone.
              </p>

              <div className="flex justify-end gap-3">
                <button
                  onClick={() => setShowDeleteModal(false)}
                  className="px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors"
                >
                  Cancel
                </button>
                <button
                  onClick={handleDelete}
                  className="px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded-lg font-medium transition-colors shadow-sm"
                >
                  Delete Certificate
                </button>
              </div>
            </div>
          </div>
        )}
      </div>
    </ErrorBoundary>
  );
}

export default MyCertificatesPage;



==================================================
FILE: pages\OpenLedgerPage.jsx
==================================================

import React, { useState, useEffect, useCallback } from "react";
import { Link, useSearchParams } from "react-router-dom";
import { advancedSearchCertificates } from "../api";
import {
  Search,
  Building,
  User,
  BookOpen,
  Filter,
  X,
  Calendar,
  ChevronRight,
  Loader2,
} from "lucide-react";
import DatePicker from "react-datepicker";
import PublicHeader from "../components/PublicHeader";
import PublicFooter from "../components/PublicFooter";
import "react-datepicker/dist/react-datepicker.css";

// --- COMPONENTS ---

const CredentialCard = ({ cert }) => {
  const isCompany = cert.issuer_type === "company";

  return (
    <Link
      to={`/verify/${cert.verification_id}`}
      className="block bg-white rounded-xl border border-gray-200 p-6 hover:shadow-lg hover:border-indigo-200 transition-all duration-300 group no-underline"
    >
      <div className="flex items-center gap-2 mb-4 text-xs font-bold text-gray-400 uppercase tracking-wider">
        {isCompany ? <Building size={14} /> : <User size={14} />}
        {cert.issuer_name}
      </div>

      <h3 className="text-lg font-bold text-gray-900 mb-2 group-hover:text-indigo-600 transition-colors line-clamp-1">
        {cert.recipient_name}
      </h3>

      <div className="flex items-center gap-2 text-gray-600 mb-6 text-sm line-clamp-1">
        <BookOpen size={16} className="text-gray-400" />
        {cert.course_title}
      </div>

      <div className="pt-4 border-t border-gray-100 flex justify-between items-center text-xs text-gray-500">
        <span>{new Date(cert.issue_date).toLocaleDateString()}</span>
        <span className="flex items-center text-indigo-600 font-medium opacity-0 group-hover:opacity-100 transition-opacity transform translate-x-2 group-hover:translate-x-0">
          Verify <ChevronRight size={14} className="ml-1" />
        </span>
      </div>
    </Link>
  );
};

const SkeletonCard = () => (
  <div className="bg-white rounded-xl border border-gray-200 p-6 animate-pulse">
    <div className="h-3 w-1/3 bg-gray-200 rounded mb-4"></div>
    <div className="h-6 w-3/4 bg-gray-200 rounded mb-3"></div>
    <div className="h-4 w-1/2 bg-gray-200 rounded mb-8"></div>
    <div className="h-px bg-gray-100 mb-4"></div>
    <div className="flex justify-between">
      <div className="h-3 w-1/4 bg-gray-200 rounded"></div>
    </div>
  </div>
);

const OpenLedgerPage = () => {
  const [searchParams, setSearchParams] = useSearchParams();

  const [filters, setFilters] = useState({
    recipient: searchParams.get("recipient") || "",
    issuer: searchParams.get("issuer") || "",
    course: searchParams.get("course") || "",
    startDate: searchParams.get("start_date")
      ? new Date(searchParams.get("start_date"))
      : null,
    endDate: searchParams.get("end_date")
      ? new Date(searchParams.get("end_date"))
      : null,
    sort_by: searchParams.get("sort_by") || "issue_date",
    sort_order: searchParams.get("sort_order") || "desc",
  });

  const [results, setResults] = useState([]);
  const [pagination, setPagination] = useState({});
  const [loading, setLoading] = useState(false);
  const [hasSearched, setHasSearched] = useState(false);

  // --- Initial Load Check ---
  useEffect(() => {
    const params = Object.fromEntries(searchParams.entries());
    if (Object.keys(params).length > 0) {
      performSearch(params);
    }
  }, []); // Run once on mount

  const performSearch = useCallback(async (params) => {
    setLoading(true);
    setHasSearched(true);
    try {
      const response = await advancedSearchCertificates(params);
      setResults(response.data.results);
      setPagination(response.data.pagination);
    } catch (err) {
      console.error("Search failed:", err);
      setResults([]);
    } finally {
      setLoading(false);
    }
  }, []);

  const handleSearch = (e) => {
    e.preventDefault();
    const newParams = { page: 1 };

    if (filters.recipient) newParams.recipient = filters.recipient;
    if (filters.issuer) newParams.issuer = filters.issuer;
    if (filters.course) newParams.course = filters.course;
    if (filters.startDate)
      newParams.start_date = filters.startDate.toISOString().split("T")[0];
    if (filters.endDate)
      newParams.end_date = filters.endDate.toISOString().split("T")[0];

    newParams.sort_by = filters.sort_by;
    newParams.sort_order = filters.sort_order;

    setSearchParams(newParams);
    performSearch(newParams);
  };

  const clearFilters = () => {
    setFilters({
      recipient: "",
      issuer: "",
      course: "",
      startDate: null,
      endDate: null,
      sort_by: "issue_date",
      sort_order: "desc",
    });
    setSearchParams({});
    setResults([]);
    setHasSearched(false);
  };

  const handlePageChange = (newPage) => {
    const currentParams = Object.fromEntries(searchParams.entries());
    const newParams = { ...currentParams, page: newPage };
    setSearchParams(newParams);
    performSearch(newParams);
    window.scrollTo({ top: 0, behavior: "smooth" });
  };

  return (
    <div className="min-h-screen bg-gray-50 flex flex-col font-sans">
      <PublicHeader />

      <main className="flex-grow">
        {/* Header */}
        <div className="bg-white border-b border-gray-200 py-12 px-4 sm:px-6 lg:px-8">
          <div className="max-w-7xl mx-auto">
            <h1 className="text-3xl font-bold text-gray-900 mb-2">
              Public Credential Ledger
            </h1>
            <p className="text-gray-500 text-lg">
              Search and verify credentials issued by organizations on
              CertifyMe.
            </p>
          </div>
        </div>

        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
          <div className="flex flex-col lg:flex-row gap-8">
            {/* Sidebar Filters */}
            <div className="w-full lg:w-80 flex-shrink-0">
              <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 sticky top-24">
                <div className="flex items-center gap-2 mb-6 text-gray-900 font-bold text-lg">
                  <Filter size={20} className="text-indigo-600" />
                  Search Filters
                </div>

                <form onSubmit={handleSearch} className="space-y-5">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">
                      Recipient Name
                    </label>
                    <input
                      type="text"
                      className="w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm py-2 px-3"
                      placeholder="e.g. Jane Doe"
                      value={filters.recipient}
                      onChange={(e) =>
                        setFilters({ ...filters, recipient: e.target.value })
                      }
                    />
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">
                      Issuer Name
                    </label>
                    <input
                      type="text"
                      className="w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm py-2 px-3"
                      placeholder="e.g. Tech Corp"
                      value={filters.issuer}
                      onChange={(e) =>
                        setFilters({ ...filters, issuer: e.target.value })
                      }
                    />
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">
                      Date Range
                    </label>
                    <div className="flex gap-2">
                      <DatePicker
                        selected={filters.startDate}
                        onChange={(date) =>
                          setFilters({ ...filters, startDate: date })
                        }
                        selectsStart
                        startDate={filters.startDate}
                        endDate={filters.endDate}
                        placeholderText="Start"
                        className="w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm py-2 px-3"
                      />
                      <DatePicker
                        selected={filters.endDate}
                        onChange={(date) =>
                          setFilters({ ...filters, endDate: date })
                        }
                        selectsEnd
                        startDate={filters.startDate}
                        endDate={filters.endDate}
                        minDate={filters.startDate}
                        placeholderText="End"
                        className="w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm py-2 px-3"
                      />
                    </div>
                  </div>

                  <div className="pt-4 flex flex-col gap-2">
                    <button
                      type="submit"
                      className="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2.5 rounded-lg transition-colors flex items-center justify-center gap-2 shadow-sm"
                    >
                      <Search size={18} /> Search Ledger
                    </button>
                    {hasSearched && (
                      <button
                        type="button"
                        onClick={clearFilters}
                        className="w-full bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 font-medium py-2.5 rounded-lg transition-colors flex items-center justify-center gap-2"
                      >
                        <X size={18} /> Clear Filters
                      </button>
                    )}
                  </div>
                </form>
              </div>
            </div>

            {/* Results Grid */}
            <div className="flex-1">
              {loading ? (
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  {[...Array(6)].map((_, i) => (
                    <SkeletonCard key={i} />
                  ))}
                </div>
              ) : hasSearched && results.length > 0 ? (
                <>
                  <p className="text-gray-500 mb-6 text-sm">
                    Found{" "}
                    <strong className="text-gray-900">
                      {pagination.total}
                    </strong>{" "}
                    credentials matching your criteria.
                  </p>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    {results.map((cert) => (
                      <CredentialCard key={cert.verification_id} cert={cert} />
                    ))}
                  </div>

                  {/* Pagination */}
                  {pagination.pages > 1 && (
                    <div className="mt-12 flex justify-center gap-2">
                      {[...Array(pagination.pages)].map((_, i) => {
                        const pageNum = i + 1;
                        const isCurrent = pageNum === pagination.page;
                        return (
                          <button
                            key={pageNum}
                            onClick={() => handlePageChange(pageNum)}
                            className={`w-10 h-10 rounded-lg text-sm font-medium transition-colors ${
                              isCurrent
                                ? "bg-indigo-600 text-white"
                                : "bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"
                            }`}
                          >
                            {pageNum}
                          </button>
                        );
                      })}
                    </div>
                  )}
                </>
              ) : hasSearched ? (
                <div className="bg-white rounded-xl border border-gray-200 p-12 text-center">
                  <div className="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <Search size={32} className="text-gray-400" />
                  </div>
                  <h3 className="text-lg font-bold text-gray-900 mb-2">
                    No credentials found
                  </h3>
                  <p className="text-gray-500">
                    Try adjusting your filters or search terms.
                  </p>
                </div>
              ) : (
                <div className="bg-white rounded-xl border border-gray-200 p-12 text-center h-full flex flex-col justify-center items-center min-h-[400px]">
                  <div className="w-20 h-20 bg-indigo-50 rounded-full flex items-center justify-center mb-6">
                    <BookOpen size={40} className="text-indigo-600" />
                  </div>
                  <h2 className="text-2xl font-bold text-gray-900 mb-3">
                    Start your search
                  </h2>
                  <p className="text-gray-500 max-w-md mx-auto">
                    Use the filters on the left to browse the public ledger of
                    verified credentials issued on CertifyMe.
                  </p>
                </div>
              )}
            </div>
          </div>
        </div>
      </main>
      <PublicFooter />
    </div>
  );
};

export default OpenLedgerPage;



==================================================
FILE: pages\PricingPage.jsx
==================================================

import React from "react";
import { Link } from "react-router-dom";
import PublicHeader from "../components/PublicHeader";
import PublicFooter from "../components/PublicFooter";
import { Check, Star, ArrowRight } from "lucide-react";

const PricingCard = ({ plan, isPopular }) => (
  <div
    className={`relative flex flex-col p-8 rounded-2xl border ${
      isPopular
        ? "border-indigo-600 shadow-2xl scale-105 z-10 bg-white"
        : "border-gray-200 bg-white"
    }`}
  >
    {isPopular && (
      <div className="absolute top-0 -translate-y-1/2 left-1/2 -translate-x-1/2">
        <div className="flex items-center gap-2 px-4 py-1.5 bg-indigo-600 text-white rounded-full text-sm font-bold shadow-lg">
          Most Popular
        </div>
      </div>
    )}
    <h3 className="text-xl font-bold text-gray-900 mb-2">{plan.name}</h3>
    <p className="text-gray-500 text-sm mb-6 h-10">{plan.for}</p>

    <div className="flex items-baseline mb-1">
      <span className="text-4xl font-extrabold text-gray-900">
        {plan.priceUSD}
      </span>
      <span className="text-gray-500 ml-2">/ {plan.priceNGN}</span>
    </div>
    <p className="text-xs text-gray-400 mb-6">{plan.certs} Credits</p>

    <div className="bg-indigo-50 text-indigo-700 text-center rounded-lg py-2 px-3 mb-8">
      <p className="font-bold text-sm mb-0">{plan.costPerCert}</p>
      <p className="text-xs font-medium">per certificate</p>
    </div>

    <ul className="space-y-4 mb-8 flex-1 text-gray-600 text-sm">
      {plan.features.map((feat, idx) => (
        <li key={idx} className="flex items-start">
          <Check size={16} className="text-green-500 mr-3 shrink-0 mt-0.5" />
          {feat}
        </li>
      ))}
    </ul>

    <Link
      to={`/signup?plan=${plan.name.toLowerCase()}`}
      className={`w-full py-3 px-4 rounded-xl font-bold text-center transition-colors no-underline ${
        isPopular
          ? "bg-indigo-600 text-white hover:bg-indigo-700"
          : "bg-indigo-50 text-indigo-700 hover:bg-indigo-100"
      }`}
    >
      Choose {plan.name}
    </Link>
  </div>
);

const FaqItem = ({ q, a }) => (
  <div className="border-b border-gray-200 py-6">
    <h4 className="font-bold text-gray-900 text-lg mb-2">{q}</h4>
    <p className="text-gray-600 leading-relaxed">{a}</p>
  </div>
);

const PricingPage = () => {
  const plans = [
    {
      name: "Starter",
      priceUSD: "$15",
      priceNGN: "₦22,500",
      certs: "500",
      costPerCert: "₦45",
      for: "For workshops, bootcamps, and small cohorts.",
      features: [
        "500 certificate credits",
        "Unlimited templates",
        "Email delivery & PDF downloads",
        "Secure online verification",
      ],
    },
    {
      name: "Growth",
      priceUSD: "$50",
      priceNGN: "₦70,000",
      certs: "2,000",
      costPerCert: "₦35",
      for: "For schools and training centers issuing regularly.",
      features: [
        "2,000 certificate credits",
        "Everything in Starter, plus:",
        "Priority support",
        "Faster processing",
      ],
    },
    {
      name: "Pro",
      priceUSD: "$100",
      priceNGN: "₦145,000",
      certs: "5,000",
      costPerCert: "₦29",
      for: "For institutions needing automation and integrations.",
      features: [
        "5,000 certificate credits",
        "Everything in Growth, plus:",
        "API access",
        "Priority support",
      ],
    },
    {
      name: "Enterprise",
      priceUSD: "$300",
      priceNGN: "₦440,000",
      certs: "20,000",
      costPerCert: "₦22",
      for: "For universities, exam bodies, and large organizations.",
      features: [
        "20,000 certificate credits",
        "Everything in Pro, plus:",
        "SLA-backed support",
        "Custom onboarding (on request)",
      ],
    },
  ];

  return (
    <div className="bg-white font-sans">
      <PublicHeader />
      <main>
        {/* Hero Section */}
        <section className="py-20 text-center bg-gray-50 border-b border-gray-100">
          <div className="max-w-3xl mx-auto px-4">
            <h1 className="text-4xl md:text-5xl font-extrabold text-gray-900 tracking-tight mb-4">
              Simple pricing. Pay only for what you issue.
            </h1>
            <p className="text-lg text-gray-600 mb-6">
              CertifyMe uses a credit-based system. One certificate equals one
              credit. No hidden fees. No surprises.
            </p>
            <p className="text-sm text-gray-500">
              Trusted by schools, training centers, and institutions issuing
              verifiable digital certificates.
            </p>
          </div>
        </section>

        {/* Pricing Cards Section */}
        <section className="py-24 bg-white">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div className="text-center max-w-3xl mx-auto mb-16">
              <h2 className="text-3xl font-extrabold text-gray-900 sm:text-4xl">
                Choose a plan that fits your institution
              </h2>
              <p className="mt-4 text-lg text-gray-500">
                All plans include secure certificate verification, PDF
                downloads, and email delivery. Upgrade anytime.
              </p>
            </div>
            <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-8 items-start">
              {plans.map((plan) => (
                <PricingCard
                  key={plan.name}
                  plan={plan}
                  isPopular={plan.name === "Pro"}
                />
              ))}
            </div>
          </div>
        </section>

        {/* Cost Clarity */}
        <section className="py-16 bg-indigo-50">
          <div className="max-w-4xl mx-auto px-4 text-center">
            <h3 className="text-2xl font-bold text-gray-900 mb-3">
              Transparent cost per certificate
            </h3>
            <p className="text-gray-600 mb-4">
              With CertifyMe, you always know what you’re paying. As your
              institution grows, the cost per certificate goes down.
            </p>
            <p className="text-indigo-600 font-semibold">
              From ₦45 per certificate on Starter → as low as ₦22 per
              certificate on Enterprise.
            </p>
          </div>
        </section>

        {/* Feature Comparison */}
        <section className="py-24 bg-white">
          <div className="max-w-4xl mx-auto px-4">
            <h2 className="text-center text-3xl font-bold text-gray-900 mb-12">
              What’s Included
            </h2>
            <div className="grid md:grid-cols-2 gap-8 text-center">
              <div className="bg-gray-50 p-8 rounded-xl border border-gray-100">
                <h3 className="font-bold text-gray-900 mb-6">
                  Available on All Plans
                </h3>
                <ul className="space-y-4 text-gray-600">
                  <li className="flex items-center gap-3">
                    <Check className="text-green-500" /> Secure certificate
                    verification
                  </li>
                  <li className="flex items-center gap-3">
                    <Check className="text-green-500" /> PDF certificate
                    downloads
                  </li>
                  <li className="flex items-center gap-3">
                    <Check className="text-green-500" /> Email delivery to
                    recipients
                  </li>
                  <li className="flex items-center gap-3">
                    <Check className="text-green-500" /> Unlimited templates
                  </li>
                  <li className="flex items-center gap-3">
                    <Check className="text-green-500" /> Fraud-resistant
                    certificate IDs
                  </li>
                </ul>
              </div>
              <div className="bg-gray-50 p-8 rounded-xl border border-gray-100">
                <h3 className="font-bold text-gray-900 mb-6">
                  Available on Pro & Enterprise
                </h3>
                <ul className="space-y-4 text-gray-600">
                  <li className="flex items-center gap-3">
                    <Check className="text-green-500" /> API access
                  </li>
                  <li className="flex items-center gap-3">
                    <Check className="text-green-500" /> SLA-backed support
                  </li>
                  <li className="flex items-center gap-3">
                    <Check className="text-green-500" /> Custom onboarding (on
                    request)
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </section>

        {/* FAQ */}
        <section className="py-24 bg-gray-50 border-t border-gray-100">
          <div className="max-w-3xl mx-auto px-4">
            <h2 className="text-center text-3xl font-bold text-gray-900 mb-12">
              Frequently Asked Questions
            </h2>
            <div className="divide-y divide-gray-200">
              <FaqItem
                q="What is a credit?"
                a="One credit equals one issued certificate. If you create a certificate but delete it before sending, the credit is returned to your account."
              />
              <FaqItem
                q="Do credits expire?"
                a="No. Your credits remain available in your account until you use them, regardless of how long ago you purchased them."
              />
              <FaqItem
                q="Can I upgrade my plan later?"
                a="Yes. You can purchase a new credit bundle at any time. Your new credits will be added to your existing balance."
              />
              <FaqItem
                q="Can I start small and scale later?"
                a="Absolutely. Most institutions start with the Starter or Growth plan and purchase larger credit bundles as their issuance needs increase."
              />
              <FaqItem
                q="Do recipients need an account to verify certificates?"
                a="No. Certificates are publicly verifiable via a secure link and QR code. Anyone can confirm a certificate's authenticity without logging in."
              />
            </div>
          </div>
        </section>

        {/* Final CTA */}
        <section className="py-24 bg-white">
          <div className="max-w-2xl mx-auto px-4 text-center">
            <h2 className="text-3xl font-bold text-gray-900 mb-4">
              Start issuing certificates in minutes
            </h2>
            <p className="text-lg text-gray-600 mb-8">
              No complex setup. No long onboarding. Choose a plan and start
              issuing verifiable certificates today.
            </p>
            <div className="flex flex-col sm:flex-row gap-4 justify-center">
              <Link
                to="/signup"
                className="inline-flex items-center justify-center px-6 py-3 text-base font-bold text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 transition-all no-underline"
              >
                Get Started with CertifyMe
              </Link>
              <Link
                to="/contact"
                className="inline-flex items-center justify-center px-6 py-3 text-base font-bold text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg no-underline"
              >
                Contact Sales
              </Link>
            </div>
          </div>
        </section>
      </main>
      <PublicFooter />
    </div>
  );
};

export default PricingPage;



==================================================
FILE: pages\ResetPasswordPage.jsx
==================================================

import React, { useState } from "react";
import { Link, useParams, useNavigate } from "react-router-dom";
import { Form, Button, Alert, Spinner } from "react-bootstrap";
import { Eye, EyeSlash } from "react-bootstrap-icons";
import { resetPassword } from "../api";
import "../styles/Auth.css";

function ResetPasswordPage() {
  const [formData, setFormData] = useState({
    password: "",
    confirmPassword: "",
  });
  const [message, setMessage] = useState("");
  const [error, setError] = useState("");
  const [loading, setLoading] = useState(false);
  const [showPassword, setShowPassword] = useState(false);
  const { token } = useParams();
  const navigate = useNavigate();

  const handleChange = (e) => {
    setFormData({ ...formData, [e.target.name]: e.target.value });
  };

  const togglePasswordVisibility = () => {
    setShowPassword(!showPassword);
  };

  const handleSubmit = async (e) => {
    e.preventDefault();

    if (formData.password !== formData.confirmPassword) {
      setError("Passwords do not match.");
      return;
    }
    if (formData.password.length < 6) {
      setError("Password must be at least 6 characters long.");
      return;
    }

    setError("");
    setMessage("");
    setLoading(true);

    try {
      const response = await resetPassword(token, formData.password);
      setMessage(response.data.msg + " Redirecting to login...");
      setTimeout(() => {
        navigate("/login");
      }, 3000);
    } catch (err) {
      setError(
        err.response?.data?.msg ||
          "Failed to reset password. The link may be invalid or expired."
      );
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="auth-container">
      <div className="auth-wrapper">
        <div className="auth-panel">
          <h2>Create a New Password</h2>
          <p>
            Your new password must be different from previously used passwords.
          </p>
        </div>
        <div className="auth-form-container">
          <img
            src="/images/certbadge.png"
            alt="CertifyMe Logo"
            className="auth-logo mx-auto d-block"
            style={{ maxHeight: "35px" }}
          />
          <h3>Set New Password</h3>
          {error && <Alert variant="danger">{error}</Alert>}
          {message && <Alert variant="success">{message}</Alert>}

          <Form onSubmit={handleSubmit}>
            <Form.Group className="mb-3 position-relative" controlId="password">
              <Form.Label>New Password</Form.Label>
              <Form.Control
                type={showPassword ? "text" : "password"}
                name="password"
                value={formData.password}
                onChange={handleChange}
                placeholder="Enter your new password"
                required
                className="password-input"
                disabled={!!message}
              />
              <button
                type="button"
                className="password-toggle-btn"
                onClick={togglePasswordVisibility}
                aria-label={showPassword ? "Hide password" : "Show password"}
              >
                {showPassword ? <EyeSlash size={20} /> : <Eye size={20} />}
              </button>
            </Form.Group>

            <Form.Group className="mb-4" controlId="confirmPassword">
              <Form.Label>Confirm New Password</Form.Label>
              <Form.Control
                type="password"
                name="confirmPassword"
                value={formData.confirmPassword}
                onChange={handleChange}
                placeholder="Confirm your new password"
                required
                disabled={!!message}
              />
            </Form.Group>

            <Button
              className="btn-auth w-100"
              type="submit"
              disabled={loading || !!message}
            >
              {loading ? (
                <Spinner
                  as="span"
                  animation="border"
                  size="sm"
                  role="status"
                  aria-hidden="true"
                />
              ) : (
                "Reset Password"
              )}
            </Button>
          </Form>
          {message && (
            <p className="text-center mt-4 text-muted">
              <Link to="/login" className="auth-switch-link">
                Go to Login
              </Link>
            </p>
          )}
        </div>
      </div>
    </div>
  );
}

export default ResetPasswordPage;



==================================================
FILE: pages\SettingsPage.jsx
==================================================

import React, { useState, useEffect, useCallback } from "react";
import { usePaystackPayment } from "react-paystack";
import {
  getCurrentUser,
  initializePayment as apiInitializePayment,
  verifyPayment,
  uploadUserSignature,
  generateApiKey,
  switchToCompany,
  getCanvaAuthUrl,
} from "../api";
import toast, { Toaster } from "react-hot-toast";
import { useNavigate, useLocation } from "react-router-dom";
import { SERVER_BASE_URL } from "../config";
import { useUser } from "../context/UserContext";
import {
  User,
  CreditCard,
  Shield,
  Building,
  PenTool,
  UploadCloud,
  Check,
  Copy,
  LogOut,
  HelpCircle,
  Lock,
  Info,
  Key,
  CheckCircle,
  Link as LinkIcon,
} from "lucide-react";
import { Modal, Spinner, Button } from "react-bootstrap";

const Section = ({ title, icon: Icon, children, className = "" }) => (
  <div
    className={`bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6 ${className}`}
  >
    <div className="flex items-center gap-3 mb-6 border-b border-gray-100 pb-4">
      <div className="p-2 bg-indigo-50 text-indigo-600 rounded-lg">
        <Icon size={20} />
      </div>
      <h3 className="text-lg font-bold text-gray-900">{title}</h3>
    </div>
    {children}
  </div>
);

const PlanCard = ({
  title,
  price,
  features,
  actionText,
  onAction,
  current,
  disabled,
  loading,
}) => (
  <div
    className={`flex flex-col h-full p-6 rounded-xl border ${
      current
        ? "border-indigo-600 ring-1 ring-indigo-600 bg-indigo-50/50"
        : "border-gray-200 bg-white hover:border-indigo-300"
    } transition-all`}
  >
    <h3 className="text-lg font-bold text-gray-900">{title}</h3>
    <div className="my-4">
      <span className="text-3xl font-bold text-gray-900">
        {price.split(" ")[0]}
      </span>
      <span className="text-gray-500 text-sm">
        {" "}
        {price.split(" ").slice(1).join(" ")}
      </span>
    </div>
    <ul className="space-y-3 mb-6 flex-1">
      {features.map((feature, idx) => (
        <li key={idx} className="flex items-start text-sm text-gray-600">
          <Check
            size={16}
            className="text-green-500 mr-2 mt-0.5 flex-shrink-0"
          />
          {feature}
        </li>
      ))}
    </ul>
    <button
      onClick={onAction}
      disabled={disabled || loading || current}
      className={`w-full py-2.5 px-4 rounded-lg font-medium text-sm transition-colors flex items-center justify-center ${
        current
          ? "bg-green-100 text-green-700 cursor-default"
          : "bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed"
      }`}
    >
      {loading ? <Spinner size="sm" /> : current ? "Current Plan" : actionText}
    </button>
  </div>
);

function SettingsPage() {
  const { user, refreshUser } = useUser();
  const [localUser, setLocalUser] = useState(null);
  const [loading, setLoading] = useState(true);
  const [activeTab, setActiveTab] = useState("profile");
  const [signatureFile, setSignatureFile] = useState(null);
  const [preview, setPreview] = useState(null);
  const [isUploading, setIsUploading] = useState(false);
  const [processingPlan, setProcessingPlan] = useState(null);
  const [paystackConfig, setPaystackConfig] = useState(null);
  const [showKeyModal, setShowKeyModal] = useState(false);
  const [newApiKey, setNewApiKey] = useState("");
  const [isCopied, setIsCopied] = useState(false);
  const [newCompanyName, setNewCompanyName] = useState("");
  const [isSwitching, setIsSwitching] = useState(false);
  const [isCanvaConnecting, setIsCanvaConnecting] = useState(false);

  const navigate = useNavigate();
  const location = useLocation();

  const isFreeUser = user && user.role === "free";
  const hasApiAccess = user && ["pro", "enterprise"].includes(user.role);
  const isCompanyUser = user && user.company;
  const isCanvaConnected = user && user.canva_access_token;

  const initializePayment = usePaystackPayment(paystackConfig || {});

  const fetchUser = async () => {
    try {
      const res = await getCurrentUser();
      setLocalUser(res.data);
      if (res.data.signature_image_url) {
        setPreview(SERVER_BASE_URL + res.data.signature_image_url);
      }
    } catch (error) {
      toast.error("Session expired.");
      navigate("/login");
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    const params = new URLSearchParams(location.search);
    if (params.get("canva_connected") === "true") {
      toast.success("Canva connected successfully!");
      refreshUser();
      setActiveTab("integrations");
      navigate(location.pathname, { replace: true });
    } else {
      fetchUser();
    }

    if (location.state?.defaultTab) {
      setActiveTab(location.state.defaultTab);
    }
  }, [navigate, location.search, location.state, refreshUser]);

  const handleUpgrade = useCallback(async (plan) => {
    setProcessingPlan(plan);
    try {
      const res = await apiInitializePayment(plan);
      setPaystackConfig({ ...res.data, currency: res.data.currency || "NGN" });
    } catch (error) {
      toast.error(error.response?.data?.msg || "Payment init failed.");
      setProcessingPlan(null);
    }
  }, []);

  useEffect(() => {
    if (paystackConfig) {
      initializePayment({
        onSuccess: async (reference) => {
          setPaystackConfig(null);
          const toastId = toast.loading("Verifying payment...");
          try {
            await verifyPayment(reference.reference);
            toast.success("Upgrade successful!", { id: toastId });
            setProcessingPlan(null);
            await refreshUser();
            await fetchUser();
          } catch (err) {
            toast.error("Payment verification failed.", { id: toastId });
            setProcessingPlan(null);
          }
        },
        onClose: () => {
          toast.error("Payment cancelled.");
          setPaystackConfig(null);
          setProcessingPlan(null);
        },
      });
    }
  }, [paystackConfig, initializePayment, refreshUser]);

  const handleFileChange = (e) => {
    const file = e.target.files[0];
    if (file && (file.type === "image/png" || file.type === "image/jpeg")) {
      setSignatureFile(file);
      setPreview(URL.createObjectURL(file));
    } else {
      toast.error("Please upload a PNG or JPG.");
    }
  };

  const handleSubmitSignature = async (e) => {
    e.preventDefault();
    if (!signatureFile) return;
    setIsUploading(true);
    const formData = new FormData();
    formData.append("signature", signatureFile);
    try {
      await uploadUserSignature(formData);
      toast.success("Signature uploaded!");
      refreshUser();
      setSignatureFile(null);
    } catch (error) {
      toast.error("Upload failed.");
    } finally {
      setIsUploading(false);
    }
  };

  const handleGenerateApiKey = async () => {
    toast.promise(generateApiKey(), {
      loading: "Generating key...",
      success: (res) => {
        setNewApiKey(res.data.api_key);
        setShowKeyModal(true);
        fetchUser();
        return "API Key generated!";
      },
      error: "Failed to generate key.",
    });
  };

  const handleSwitchToCompany = async (e) => {
    e.preventDefault();
    if (!newCompanyName.trim()) return toast.error("Enter company name.");
    setIsSwitching(true);
    try {
      await switchToCompany(newCompanyName);
      toast.success("Account upgraded to Company!");
      setTimeout(() => window.location.reload(), 1000);
    } catch (error) {
      toast.error("Failed to switch.");
    } finally {
      setIsSwitching(false);
    }
  };

  const handleLogout = () => {
    localStorage.removeItem("token");
    navigate("/login");
  };

  const copyToClipboard = () => {
    navigator.clipboard.writeText(newApiKey);
    setIsCopied(true);
    setTimeout(() => setIsCopied(false), 2000);
  };

  const handleCanvaConnect = async () => {
    setIsCanvaConnecting(true);
    try {
      const response = await getCanvaAuthUrl();
      window.location.href = response.data.auth_url;
    } catch (error) {
      toast.error("Could not connect to Canva. Please try again.");
      setIsCanvaConnecting(false);
    }
  };

  if (loading)
    return (
      <div className="flex justify-center p-12">
        <Spinner animation="border" />
      </div>
    );

  const tabs = [
    { id: "profile", label: "Profile", icon: User },
    // { id: "integrations", label: "Integrations", icon: LinkIcon },
    { id: "billing", label: "Billing", icon: CreditCard },
    {
      id: "developer",
      label: "Developer",
      icon: Shield,
      locked: !hasApiAccess,
    },
  ];

  return (
    <div className="max-w-5xl mx-auto pb-12">
      <Toaster position="top-right" />

      <div className="mb-8">
        <h1 className="text-2xl font-bold text-gray-900">Settings</h1>
        <p className="text-gray-500">
          Manage your account, integrations, and billing.
        </p>
      </div>

      <div className="flex gap-1 mb-8 border-b border-gray-200 overflow-x-auto">
        {tabs.map((tab) => (
          <button
            key={tab.id}
            onClick={() => !tab.locked && setActiveTab(tab.id)}
            className={`flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${
              activeTab === tab.id
                ? "border-indigo-600 text-indigo-600"
                : "border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"
            } ${tab.locked ? "opacity-50 cursor-not-allowed" : ""}`}
          >
            <tab.icon size={16} />
            {tab.label}
            {tab.locked && <Lock size={12} />}
          </button>
        ))}
      </div>

      {activeTab === "profile" && (
        <div className="space-y-6">
          <Section title="Public Profile" icon={User}>
            {isCompanyUser && (
              <div className="bg-blue-50 text-blue-800 p-3 rounded-lg flex items-start gap-3 mb-6 text-sm">
                <Building size={18} className="mt-0.5" />
                <div>
                  Managed by <strong>{user.company.name}</strong>. Certificates
                  issued under this company name.
                </div>
              </div>
            )}
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  Full Name
                </label>
                <input
                  type="text"
                  value={localUser?.name || ""}
                  disabled
                  className="w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-lg text-gray-500 cursor-not-allowed"
                />
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  Email Address
                </label>
                <input
                  type="email"
                  value={localUser?.email || ""}
                  disabled
                  className="w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-lg text-gray-500 cursor-not-allowed"
                />
              </div>
            </div>
          </Section>

          {!isCompanyUser && (
            <Section title="Company Workspace" icon={Building}>
              <p className="text-gray-600 mb-4 text-sm">
                Upgrade to a company account to issue certificates under your
                organization's name.
                <span className="text-red-500 ml-1 font-medium">
                  Irreversible action.
                </span>
              </p>
              <form onSubmit={handleSwitchToCompany} className="flex gap-3">
                <input
                  type="text"
                  placeholder="Company Name"
                  value={newCompanyName}
                  onChange={(e) => setNewCompanyName(e.target.value)}
                  className="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none"
                />
                <button
                  type="submit"
                  disabled={isSwitching}
                  className="bg-indigo-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-indigo-700 disabled:opacity-50 whitespace-nowrap flex items-center"
                >
                  {isSwitching && <Spinner size="sm" className="mr-2" />} Switch
                  to Company
                </button>
              </form>
            </Section>
          )}

          <Section
            title="Signature Management"
            icon={PenTool}
            className="relative overflow-hidden"
          >
            {isFreeUser && (
              <div className="absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex flex-col items-center justify-center text-center p-6">
                <Lock size={40} className="text-yellow-500 mb-2" />
                <h4 className="font-bold text-gray-900">Premium Feature</h4>
                <p className="text-sm text-gray-500 mb-4">
                  Upgrade to Starter or higher to upload custom signatures.
                </p>
                <button
                  onClick={() => setActiveTab("billing")}
                  className="bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm font-medium"
                >
                  View Plans
                </button>
              </div>
            )}
            <div className="flex flex-col md:flex-row gap-6">
              <div className="flex-1">
                <p className="text-sm text-gray-600 mb-4">
                  Upload a transparent PNG of your signature.
                </p>
                <form onSubmit={handleSubmitSignature} className="space-y-4">
                  <input
                    type="file"
                    accept="image/png, image/jpeg"
                    onChange={handleFileChange}
                    className="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"
                  />
                  <button
                    type="submit"
                    disabled={isUploading || !signatureFile}
                    className="bg-indigo-600 text-white px-4 py-2 rounded-lg font-medium text-sm hover:bg-indigo-700 disabled:opacity-50 flex items-center"
                  >
                    {isUploading ? (
                      <Spinner size="sm" className="mr-2" />
                    ) : (
                      <UploadCloud size={16} className="mr-2" />
                    )}{" "}
                    Save Signature
                  </button>
                </form>
              </div>
              {preview && (
                <div className="border border-gray-200 rounded-lg p-4 bg-gray-50 flex items-center justify-center min-w-[200px]">
                  <img
                    src={preview}
                    alt="Sig"
                    className="max-h-16 object-contain"
                  />
                </div>
              )}
            </div>
          </Section>

          <Section title="Account Actions" icon={Shield}>
            <div className="space-y-2">
              <button
                onClick={() => navigate("/dashboard/support")}
                className="w-full flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg transition-colors text-left"
              >
                <span className="flex items-center gap-3 font-medium text-gray-700">
                  <HelpCircle size={18} /> Contact Support
                </span>
              </button>
              <div className="h-px bg-gray-100"></div>
              <button
                onClick={handleLogout}
                className="w-full flex items-center justify-between p-3 hover:bg-red-50 rounded-lg transition-colors text-left text-red-600"
              >
                <span className="flex items-center gap-3 font-medium">
                  <LogOut size={18} /> Logout
                </span>
              </button>
            </div>
          </Section>
        </div>
      )}

      {/* {activeTab === "integrations" && (
        <Section title="External Apps" icon={LinkIcon}>
          <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200">
            <div className="flex items-center gap-4">
              <img
                src="https://static.canva.com/web/images/8439b51bb7a19f6e65ce1064bc37c197.svg"
                alt="Canva"
                className="w-10 h-10"
              />
              <div>
                <h4 className="font-bold text-gray-900">Canva</h4>
                <p className="text-sm text-gray-500">
                  Import your designs to use as templates.
                </p>
              </div>
            </div>
            {isCanvaConnected ? (
              <div className="flex items-center gap-2 text-green-600 font-medium text-sm bg-green-50 px-3 py-1.5 rounded-lg border border-green-200">
                <CheckCircle size={16} /> Connected
              </div>
            ) : (
              <button
                onClick={handleCanvaConnect}
                disabled={isCanvaConnecting}
                className="bg-black text-white px-4 py-2 rounded-lg font-medium text-sm hover:bg-gray-800 transition-colors disabled:opacity-50"
              >
                {isCanvaConnecting ? <Spinner size="sm" /> : "Connect"}
              </button>
            )}
          </div>
        </Section>
      )} */}

      {activeTab === "billing" && (
        <div>
          <div className="bg-indigo-50 border border-indigo-100 rounded-xl p-4 mb-8 flex items-start gap-3">
            <Info className="text-indigo-600 mt-0.5" size={20} />
            <div>
              <p className="text-indigo-900 font-medium">
                Current Plan: <span className="uppercase">{user?.role}</span>
              </p>
              <p className="text-indigo-700 text-sm">
                {user?.cert_quota || 0} certificate credits remaining.
              </p>
            </div>
          </div>
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <PlanCard
              title="Starter"
              price="$15 /month"
              features={["500 Credits", "Standard Templates", "Email Support"]}
              actionText="Upgrade"
              current={user?.role === "starter"}
              onAction={() => handleUpgrade("starter")}
              loading={processingPlan === "starter"}
            />
            <PlanCard
              title="Growth"
              price="$50 /month"
              features={["2,000 Credits", "All Templates", "Priority Support"]}
              actionText="Upgrade"
              current={user?.role === "growth"}
              onAction={() => handleUpgrade("growth")}
              loading={processingPlan === "growth"}
            />
            <PlanCard
              title="Pro"
              price="$100 /month"
              features={["5,000 Credits", "API Access", "Custom Branding"]}
              actionText="Upgrade"
              current={user?.role === "pro"}
              onAction={() => handleUpgrade("pro")}
              loading={processingPlan === "pro"}
            />
            <PlanCard
              title="Enterprise"
              price="$300 /month"
              features={["20,000 Credits", "Dedicated Manager", "SLA"]}
              actionText="Upgrade"
              current={user?.role === "enterprise"}
              onAction={() => handleUpgrade("enterprise")}
              loading={processingPlan === "enterprise"}
            />
          </div>
        </div>
      )}

      {activeTab === "developer" && hasApiAccess && (
        <Section title="API Configuration" icon={Key}>
          <p className="text-gray-600 mb-6">
            Use this key to authenticate requests to the CertifyMe API. Keep it
            secret.
          </p>
          {localUser?.api_key ? (
            <div className="bg-gray-50 border border-gray-200 rounded-lg p-4 mb-6 flex items-start gap-3">
              <CheckCircle className="text-green-500 mt-0.5" size={20} />
              <div>
                <h4 className="font-medium text-gray-900">
                  Active API Key Found
                </h4>
                <p className="text-sm text-gray-500">
                  For security, the key is hidden. Regenerate if lost.
                </p>
              </div>
            </div>
          ) : (
            <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6 flex items-start gap-3">
              <Info className="text-yellow-600 mt-0.5" size={20} />
              <div>
                <h4 className="font-medium text-yellow-900">No API Key</h4>
                <p className="text-sm text-yellow-700">
                  Generate a key to start integrating.
                </p>
              </div>
            </div>
          )}
          <button
            onClick={handleGenerateApiKey}
            className="bg-red-50 text-red-600 border border-red-200 px-4 py-2 rounded-lg font-medium hover:bg-red-100 transition-colors flex items-center gap-2"
          >
            <Key size={16} />
            {localUser?.api_key ? "Regenerate Key" : "Generate Key"}
          </button>
          {localUser?.api_key && (
            <p className="text-xs text-red-500 mt-2">
              Warning: Regenerating will stop existing integrations.
            </p>
          )}
        </Section>
      )}

      <Modal
        show={showKeyModal}
        onHide={() => setShowKeyModal(false)}
        centered
        backdrop="static"
      >
        <Modal.Header closeButton>
          <Modal.Title className="text-lg font-bold">
            New API Key Generated
          </Modal.Title>
        </Modal.Header>
        <Modal.Body>
          <div className="bg-yellow-50 text-yellow-800 p-3 rounded-lg mb-4 text-sm">
            Please copy this key now. You won't be able to see it again.
          </div>
          <div className="flex gap-2">
            <input
              type="text"
              value={newApiKey}
              readOnly
              className="flex-1 bg-gray-50 border border-gray-300 rounded-lg px-3 py-2 font-mono text-sm"
            />
            <button
              onClick={copyToClipboard}
              className="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-gray-600"
            >
              {isCopied ? (
                <Check size={18} className="text-green-600" />
              ) : (
                <Copy size={18} />
              )}
            </button>
          </div>
        </Modal.Body>
        <Modal.Footer>
          <Button variant="secondary" onClick={() => setShowKeyModal(false)}>
            I have copied it
          </Button>
        </Modal.Footer>
      </Modal>
    </div>
  );
}

export default SettingsPage;



==================================================
FILE: pages\SignupPage.jsx
==================================================

import React, { useState } from "react";
import { Link, useNavigate, useSearchParams } from "react-router-dom";
import { Form, Spinner, Alert } from "react-bootstrap";
import {
  Eye,
  EyeOff,
  User,
  Building,
  Mail,
  Lock,
  ArrowRight,
} from "lucide-react";
import { signupUser } from "../api";

function SignupPage() {
  const [formData, setFormData] = useState({
    name: "",
    email: "",
    password: "",
    account_type: "individual",
    company_name: "",
  });
  const [error, setError] = useState("");
  const [loading, setLoading] = useState(false);
  const [showPassword, setShowPassword] = useState(false);
  const navigate = useNavigate();
  const [searchParams] = useSearchParams();
  const plan = searchParams.get("plan");

  const handleChange = (e) => {
    setFormData({ ...formData, [e.target.name]: e.target.value });
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError("");
    setLoading(true);

    const { name, email, password, account_type, company_name } = formData;
    const payload = { name, email, password, account_type };

    if (account_type === "company") {
      if (!company_name.trim()) {
        setError("Company Name is required.");
        setLoading(false);
        return;
      }
      payload.company_name = company_name;
    }

    try {
      await signupUser(payload);
      navigate("/verify-email", { state: { email: payload.email } });
    } catch (err) {
      setError(err.response?.data?.msg || "Signup failed.");
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8 font-sans">
      <div className="sm:mx-auto sm:w-full sm:max-w-md">
        <Link
          to="/"
          className="flex justify-center items-center gap-2 mb-6 no-underline"
        >
          <img src="/images/certbadge.png" alt="Logo" className="h-10 w-10" />
          <span className="font-bold text-2xl text-gray-900">CertifyMe</span>
        </Link>
        <h2 className="mt-6 text-center text-3xl font-extrabold text-gray-900">
          Create your account
        </h2>
        <p className="mt-2 text-center text-sm text-gray-600">
          Already have an account?{" "}
          <Link
            to="/login"
            className="font-medium text-indigo-600 hover:text-indigo-500 no-underline"
          >
            Sign in
          </Link>
        </p>
      </div>

      <div className="mt-8 sm:mx-auto sm:w-full sm:max-w-lg">
        <div className="bg-white py-8 px-4 shadow-xl sm:rounded-2xl sm:px-10 border border-gray-100">
          {plan && (
            <div className="mb-6 bg-indigo-50 border border-indigo-100 text-indigo-700 px-4 py-3 rounded-lg text-sm font-medium text-center">
              You selected the{" "}
              <span className="uppercase font-bold">{plan}</span> plan.
            </div>
          )}

          {error && (
            <div className="mb-6 bg-red-50 border border-red-100 text-red-600 px-4 py-3 rounded-lg text-sm">
              {error}
            </div>
          )}

          <Form onSubmit={handleSubmit} className="space-y-6">
            {/* Account Type Selector */}
            <div className="grid grid-cols-2 gap-3 p-1 bg-gray-100 rounded-lg">
              <button
                type="button"
                onClick={() =>
                  setFormData({ ...formData, account_type: "individual" })
                }
                className={`py-2 text-sm font-medium rounded-md transition-all ${
                  formData.account_type === "individual"
                    ? "bg-white text-gray-900 shadow-sm"
                    : "text-gray-500 hover:text-gray-700"
                }`}
              >
                Individual
              </button>
              <button
                type="button"
                onClick={() =>
                  setFormData({ ...formData, account_type: "company" })
                }
                className={`py-2 text-sm font-medium rounded-md transition-all ${
                  formData.account_type === "company"
                    ? "bg-white text-gray-900 shadow-sm"
                    : "text-gray-500 hover:text-gray-700"
                }`}
              >
                Organization
              </button>
            </div>

            {formData.account_type === "company" && (
              <div>
                <label className="block text-sm font-medium text-gray-700">
                  Company Name
                </label>
                <div className="mt-1 relative rounded-md shadow-sm">
                  <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <Building className="h-5 w-5 text-gray-400" />
                  </div>
                  <input
                    type="text"
                    name="company_name"
                    required
                    value={formData.company_name}
                    onChange={handleChange}
                    className="block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
                    placeholder="Acme Inc."
                  />
                </div>
              </div>
            )}

            <div>
              <label className="block text-sm font-medium text-gray-700">
                Full Name
              </label>
              <div className="mt-1 relative rounded-md shadow-sm">
                <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <User className="h-5 w-5 text-gray-400" />
                </div>
                <input
                  type="text"
                  name="name"
                  required
                  value={formData.name}
                  onChange={handleChange}
                  className="block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
                  placeholder="John Doe"
                />
              </div>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700">
                Email Address
              </label>
              <div className="mt-1 relative rounded-md shadow-sm">
                <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <Mail className="h-5 w-5 text-gray-400" />
                </div>
                <input
                  type="email"
                  name="email"
                  required
                  value={formData.email}
                  onChange={handleChange}
                  className="block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
                  placeholder="you@example.com"
                />
              </div>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700">
                Password
              </label>
              <div className="mt-1 relative rounded-md shadow-sm">
                <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <Lock className="h-5 w-5 text-gray-400" />
                </div>
                <input
                  type={showPassword ? "text" : "password"}
                  name="password"
                  required
                  value={formData.password}
                  onChange={handleChange}
                  className="block w-full pl-10 pr-10 py-2.5 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
                  placeholder="••••••••"
                />
                <button
                  type="button"
                  className="absolute inset-y-0 right-0 pr-3 flex items-center cursor-pointer text-gray-400 hover:text-gray-600"
                  onClick={() => setShowPassword(!showPassword)}
                >
                  {showPassword ? <EyeOff size={18} /> : <Eye size={18} />}
                </button>
              </div>
            </div>

            <button
              type="submit"
              disabled={loading}
              className="w-full flex justify-center py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-70 disabled:cursor-not-allowed transition-all"
            >
              {loading ? (
                <Spinner animation="border" size="sm" />
              ) : (
                <span className="flex items-center">
                  Create Account <ArrowRight className="ml-2 h-4 w-4" />
                </span>
              )}
            </button>
          </Form>
        </div>
      </div>
    </div>
  );
}

export default SignupPage;



==================================================
FILE: pages\SupportHubPage.jsx
==================================================

// frontend/src/pages/SupportHubPage.jsx

import React, { useState } from "react";
import { Link } from "react-router-dom";
import { helpArticles } from "../data/helpArticles.jsx";
import { Search, MessageCircle, HelpCircle } from "lucide-react";
import { useSupportStatus } from "../hooks/useSupportStatus";

function SupportHubPage() {
  const [searchTerm, setSearchTerm] = useState("");
  const { isOnline } = useSupportStatus();

  const filteredArticles = helpArticles.filter(
    (article) =>
      article.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
      article.description.toLowerCase().includes(searchTerm.toLowerCase())
  );

  return (
    <div className="max-w-7xl mx-auto px-4 py-8">
      {/* Hero Section */}
      <div className="bg-white rounded-2xl shadow-sm border border-gray-200 p-8 md:p-12 text-center mb-12 relative overflow-hidden">
        <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"></div>
        <div className="max-w-2xl mx-auto relative z-10">
          <div className="bg-indigo-50 text-indigo-600 p-3 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-6">
            <HelpCircle size={32} />
          </div>
          <h1 className="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
            How can we help you?
          </h1>
          <p className="text-gray-500 text-lg mb-8">
            Search our knowledge base or browse the topics below to find
            answers.
          </p>

          <div className="relative max-w-lg mx-auto">
            <div className="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-gray-400">
              <Search size={20} />
            </div>
            <input
              type="text"
              placeholder="Search for answers..."
              className="w-full pl-11 pr-4 py-3.5 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none text-gray-900 shadow-sm transition-all"
              value={searchTerm}
              onChange={(e) => setSearchTerm(e.target.value)}
            />
          </div>
        </div>
      </div>

      {/* Topics Grid */}
      <div className="mb-16">
        <h3 className="text-xl font-bold text-gray-900 mb-6 flex items-center gap-2">
          <div className="w-1 h-6 bg-indigo-600 rounded-full"></div>
          Browse Help Topics
        </h3>

        {filteredArticles.length > 0 ? (
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            {filteredArticles.map((article) => (
              <Link
                key={article.slug}
                to={`/dashboard/support/articles/${article.slug}`}
                className="group bg-white rounded-xl border border-gray-200 p-6 hover:shadow-lg hover:border-indigo-200 transition-all duration-300 flex flex-col h-full text-decoration-none"
              >
                <div
                  className={`w-12 h-12 rounded-lg flex items-center justify-center mb-4 ${article.theme}`}
                >
                  {article.icon}
                </div>
                <h4 className="text-lg font-bold text-gray-900 mb-2 group-hover:text-indigo-600 transition-colors">
                  {article.title}
                </h4>
                <p className="text-gray-500 text-sm leading-relaxed">
                  {article.description}
                </p>
              </Link>
            ))}
          </div>
        ) : (
          <div className="text-center py-12 bg-gray-50 rounded-xl border border-dashed border-gray-300">
            <p className="text-gray-500">
              No articles found matching "{searchTerm}"
            </p>
            <button
              onClick={() => setSearchTerm("")}
              className="text-indigo-600 font-medium mt-2 hover:underline"
            >
              Clear search
            </button>
          </div>
        )}
      </div>

      {/* Support Contact */}
      <div className="max-w-3xl mx-auto">
        <div className="bg-indigo-900 rounded-2xl shadow-xl p-8 md:p-12 text-center text-white relative overflow-hidden">
          {/* Background decoration */}
          <div className="absolute top-0 right-0 -mr-16 -mt-16 w-64 h-64 bg-white opacity-5 rounded-full blur-3xl"></div>
          <div className="absolute bottom-0 left-0 -ml-16 -mb-16 w-64 h-64 bg-indigo-400 opacity-10 rounded-full blur-3xl"></div>

          <div className="relative z-10">
            <MessageCircle size={48} className="mx-auto mb-6 text-indigo-300" />
            <h2 className="text-2xl md:text-3xl font-bold mb-4">
              Still need help?
            </h2>
            <p className="text-indigo-100 text-lg mb-8 max-w-xl mx-auto">
              Our Nigerian-based support team is ready to assist you. Create a
              ticket and we'll get back to you as soon as possible.
            </p>

            <div className="inline-flex items-center gap-2 bg-indigo-800/50 backdrop-blur-sm px-4 py-2 rounded-full mb-8 border border-indigo-700/50">
              <div
                className={`w-2.5 h-2.5 rounded-full ${
                  isOnline ? "bg-green-400 animate-pulse" : "bg-gray-400"
                }`}
              ></div>
              <span
                className={`text-sm font-medium ${
                  isOnline ? "text-green-300" : "text-gray-300"
                }`}
              >
                {isOnline ? "Support Team Online" : "Currently Offline"}
              </span>
            </div>

            <div>
              <Link
                to="/dashboard/support/tickets"
                className="inline-block bg-white text-indigo-900 font-bold py-3.5 px-8 rounded-xl hover:bg-indigo-50 transition-colors shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all text-decoration-none"
              >
                Create Support Ticket
              </Link>
            </div>

            <p className="mt-6 text-indigo-300/80 text-xs">
              Support Hours: Mon - Fri, 9am - 5pm (WAT)
            </p>
          </div>
        </div>
      </div>
    </div>
  );
}

export default SupportHubPage;



==================================================
FILE: pages\TemplatesPage.jsx
==================================================

import React, { useState, useEffect } from "react";
import { Link } from "react-router-dom";
import {
  getTemplates,
  createTemplate,
  updateTemplate,
  deleteTemplate,
} from "../api";
import {
  Edit3,
  Maximize2,
  X,
  Brush,
  Copy,
  Check,
  Trash2,
  Plus,
  LayoutTemplate,
  Eye,
} from "lucide-react";
import { SERVER_BASE_URL } from "../config";
import { Spinner, Modal, Button } from "react-bootstrap";
import toast, { Toaster } from "react-hot-toast";

const TemplatePreview = ({ previewData, isFullscreen = false }) => {
  const {
    primary_color = "#0284C7",
    secondary_color = "#E2E8F0",
    body_font_color = "#1E293B",
    font_family = "Lato",
    layout_style = "modern",
    logo_url,
    background_url,
    custom_text = {
      title: "Certificate of Completion",
      body: "has successfully completed the course",
    },
  } = previewData;

  const certificateTitle = custom_text?.title || "Certificate of Completion";
  const certificateBody =
    custom_text?.body || "has successfully completed the course";

  const textStyle = { color: body_font_color };
  const backgroundStyle = {
    fontFamily: font_family,
    backgroundImage: background_url ? `url(${background_url})` : "none",
    backgroundSize: "cover",
    backgroundPosition: "center",
  };

  const containerStyle = {
    aspectRatio: "1.414 / 1",
    width: "100%",
    transform: isFullscreen ? "scale(1)" : "scale(1)",
    transition: "transform 0.3s ease",
    position: "relative",
    overflow: "hidden",
  };

  // --- RENDER RECEIPT ---
  if (layout_style === "receipt") {
    return (
      <div style={containerStyle} className="shadow-lg bg-white p-4">
        <div
          className="h-full w-full flex flex-col p-6 border border-gray-200 bg-white"
          style={{ fontFamily: "sans-serif" }}
        >
          <div className="flex justify-between items-start mb-6">
            <div>
              {logo_url ? (
                <img
                  src={logo_url}
                  className="h-12 object-contain mb-2"
                  alt="Logo"
                />
              ) : (
                <h2
                  className="text-xl font-bold"
                  style={{ color: primary_color }}
                >
                  Issuer Inc.
                </h2>
              )}
            </div>
            <div className="text-right text-xs text-gray-500">
              <p className="font-bold text-base text-gray-800">Issuer Name</p>
              <p>Payment Receipt</p>
              <p>MM/DD/YYYY</p>
            </div>
          </div>

          <div
            className="p-3 mb-6 rounded flex justify-between items-center"
            style={{ backgroundColor: primary_color, color: "white" }}
          >
            <span className="font-bold text-lg tracking-wider uppercase">
              PAYMENT RECEIPT
            </span>
            <span className="font-mono text-sm opacity-80">#12345678</span>
          </div>

          <div className="flex justify-between mb-6 text-sm">
            <div>
              <p className="text-xs text-gray-400 uppercase font-bold mb-1">
                Bill To
              </p>
              <p className="font-bold text-lg text-gray-800">Recipient Name</p>
              <p className="text-gray-500 text-xs">recipient@example.com</p>
            </div>
            <div className="text-right">
              <p className="text-xs text-gray-400 uppercase font-bold mb-1">
                Status
              </p>
              <div className="inline-block px-3 py-1 bg-green-100 text-green-700 rounded-full font-bold text-xs">
                PAID
              </div>
            </div>
          </div>

          <div className="border-b border-gray-200 mb-2">
            <div className="flex justify-between py-2 bg-gray-50 px-3 text-xs font-bold text-gray-500 uppercase rounded-t">
              <span>Description</span>
              <span>Amount</span>
            </div>
            <div className="flex justify-between py-4 px-3 text-sm">
              <span className="font-medium text-gray-800">
                Course / Service Title
              </span>
              <span className="font-bold" style={{ color: primary_color }}>
                PAID
              </span>
            </div>
          </div>

          <div className="flex justify-end mt-4 mb-auto">
            <div className="w-1/2 flex justify-between border-t-2 border-gray-800 pt-3">
              <span className="font-bold text-lg">Total</span>
              <span
                className="font-bold text-lg"
                style={{ color: primary_color }}
              >
                PAID
              </span>
            </div>
          </div>

          <div className="border-t border-gray-200 pt-4 mt-4 text-xs text-gray-400 flex justify-between items-end">
            <div>
              <p>Auth Signature: Signature</p>
              <p className="mt-1">Thank you for your business.</p>
            </div>
            <div className="w-16 h-16 bg-gray-100 flex items-center justify-center text-[10px]">
              QR
            </div>
          </div>
        </div>
      </div>
    );
  }

  // --- RENDER CLASSIC ---
  if (layout_style === "classic") {
    return (
      <div style={containerStyle} className="shadow-lg">
        <div
          className="h-full w-full bg-white relative flex flex-col"
          style={{ border: `8px double ${primary_color}`, ...backgroundStyle }}
        >
          <div
            style={{
              height: "12px",
              borderBottom: `4px solid ${primary_color}`,
              background: `linear-gradient(to right, ${primary_color}, ${secondary_color})`,
            }}
          ></div>
          <div className="flex-grow flex flex-col justify-center items-center text-center p-8">
            {logo_url && (
              <img
                src={logo_url}
                alt="Logo"
                className="mb-4 object-contain"
                style={{ width: "80px", height: "80px" }}
              />
            )}
            <h1
              className="font-bold uppercase tracking-wider leading-tight mb-2"
              style={{
                fontSize: isFullscreen ? "2.5rem" : "1.5rem",
                color: primary_color,
              }}
            >
              {certificateTitle}
            </h1>
            <p
              className="italic my-1"
              style={{
                fontSize: isFullscreen ? "1.2rem" : "0.8rem",
                color: "#4B5EAA",
              }}
            >
              This is to certify that
            </p>
            <h2
              className="font-extrabold my-2"
              style={{
                fontSize: isFullscreen ? "3rem" : "1.8rem",
                fontFamily: "'Georgia', serif",
                ...textStyle,
              }}
            >
              Recipient Name
            </h2>
            <p
              className="italic my-2"
              style={{
                fontSize: isFullscreen ? "1.2rem" : "0.8rem",
                color: "#4B5EAA",
              }}
            >
              {certificateBody}
            </p>
            <p
              className="font-bold uppercase my-3"
              style={{
                fontSize: isFullscreen ? "1.8rem" : "1rem",
                color: secondary_color,
              }}
            >
              Course Title
            </p>
            <div className="flex justify-around w-full mt-auto pt-4">
              <div className="text-center w-1/3">
                <p
                  className="font-semibold border-b border-gray-400 pb-1 mb-1"
                  style={textStyle}
                >
                  MM/DD/YYYY
                </p>
                <span className="text-gray-500 text-xs">Date</span>
              </div>
              <div className="text-center w-1/3">
                <p
                  className="font-semibold border-b border-gray-400 pb-1 mb-1"
                  style={textStyle}
                >
                  Signature
                </p>
                <span className="text-gray-500 text-xs">Signature</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    );
  }

  // --- RENDER MODERN ---
  return (
    <div style={containerStyle} className="shadow-lg">
      <div
        className="flex h-full w-full bg-white text-black border-4"
        style={{ borderColor: primary_color, ...backgroundStyle }}
      >
        <div
          className="w-[35%] p-4 flex flex-col justify-between items-center text-center"
          style={{
            background: `linear-gradient(135deg, ${primary_color}, ${secondary_color})`,
          }}
        >
          <div>
            {logo_url && (
              <img
                src={logo_url}
                className="w-20 h-20 rounded-full border-4 border-white object-cover bg-white shadow-sm mb-2"
                alt="Logo"
              />
            )}
            <p className="font-bold text-white text-xs uppercase tracking-wider">
              Issuer Name
            </p>
          </div>
          <div className="bg-white/90 p-2 rounded shadow-sm">
            <div className="w-16 h-16 bg-gray-200 flex items-center justify-center text-[10px] text-gray-500">
              QR
            </div>
          </div>
        </div>
        <div className="w-[65%] p-6 flex flex-col justify-center bg-white/90 backdrop-blur-sm">
          <h1
            className="font-light uppercase tracking-widest mb-4"
            style={{
              fontSize: isFullscreen ? "1.5rem" : "1rem",
              color: primary_color,
            }}
          >
            {certificateTitle}
          </h1>
          <h2
            className="font-extrabold mb-3"
            style={{
              fontSize: isFullscreen ? "2.5rem" : "1.6rem",
              ...textStyle,
            }}
          >
            Recipient Name
          </h2>
          <p className="italic mb-4 text-sm" style={{ color: body_font_color }}>
            {certificateBody}
          </p>
          <p
            className="font-bold uppercase tracking-wide mb-6"
            style={{
              fontSize: isFullscreen ? "1.2rem" : "0.9rem",
              color: secondary_color,
            }}
          >
            Course Title
          </p>
          <div
            className="flex justify-between mt-auto pt-3 border-t-2"
            style={{ borderColor: primary_color }}
          >
            <div className="text-xs" style={textStyle}>
              <p className="font-bold">Date: MM/DD/YYYY</p>
              <p className="text-gray-500">Authorized Signature</p>
            </div>
            <div className="text-xs text-right" style={textStyle}>
              <p className="font-bold">ID: PENDING</p>
              <p className="text-gray-500">Verification</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

// --- Form Components ---
const FormInput = ({ label, ...props }) => (
  <div>
    <label className="block text-gray-700 font-semibold mb-1.5 text-sm">
      {label}
    </label>
    <input
      {...props}
      className="w-full px-3 py-2.5 bg-gray-50 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-shadow text-sm"
    />
  </div>
);

const FormSelect = ({ label, options, ...props }) => (
  <div>
    <label className="block text-gray-700 font-semibold mb-1.5 text-sm">
      {label}
    </label>
    <select
      {...props}
      className="w-full px-3 py-2.5 bg-gray-50 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm"
    >
      {options.map((opt) => (
        <option key={opt} value={opt}>
          {opt.charAt(0).toUpperCase() + opt.slice(1)}
        </option>
      ))}
    </select>
  </div>
);

const FormColorInput = ({ label, ...props }) => (
  <div>
    <label className="block text-gray-500 text-xs font-medium mb-1 uppercase tracking-wide">
      {label}
    </label>
    <div className="flex items-center gap-2 border border-gray-300 rounded-lg p-1 bg-white">
      <input
        type="color"
        {...props}
        className="w-8 h-8 rounded cursor-pointer border-0 p-0"
      />
      <span className="text-xs font-mono text-gray-600 flex-grow">
        {props.value}
      </span>
    </div>
  </div>
);

const FormFileInput = ({ label, ...props }) => (
  <div>
    <label className="block text-gray-700 font-semibold mb-1.5 text-sm">
      {label}
    </label>
    <input
      type="file"
      {...props}
      accept="image/*"
      className="block w-full text-sm text-gray-500
        file:mr-4 file:py-2 file:px-4
        file:rounded-md file:border-0
        file:text-sm file:font-semibold
        file:bg-indigo-50 file:text-indigo-700
        hover:file:bg-indigo-100 cursor-pointer"
    />
  </div>
);

const TemplateCard = ({ template, onEditClick, onDeleteClick }) => {
  const [isCopied, setIsCopied] = useState(false);

  const handleCopyId = (e) => {
    e.stopPropagation();
    e.preventDefault();
    navigator.clipboard.writeText(template.id);
    setIsCopied(true);
    toast.success(`ID Copied`);
    setTimeout(() => setIsCopied(false), 2000);
  };

  return (
    <div className="group bg-white rounded-xl border border-gray-200 overflow-hidden hover:shadow-xl transition-all duration-300 flex flex-col h-full">
      <div className="relative aspect-[1.414/1] bg-gray-100 border-b border-gray-100 overflow-hidden">
        <div
          className="w-full h-full transform group-hover:scale-105 transition-transform duration-500"
          style={{
            backgroundColor: template.primary_color,
            backgroundImage: template.background_url
              ? `url(${SERVER_BASE_URL}${template.background_url})`
              : "none",
            backgroundSize: "cover",
            backgroundPosition: "center",
          }}
        />
        <div className="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors" />

        {/* Badges */}
        <div className="absolute top-3 right-3 flex flex-col gap-2 items-end">
          {template.is_public && (
            <span className="bg-indigo-600 text-white text-[10px] font-bold px-2 py-1 rounded shadow-sm">
              SYSTEM
            </span>
          )}
          {template.layout_style === "visual" && (
            <span className="bg-blue-500 text-white text-[10px] font-bold px-2 py-1 rounded shadow-sm">
              VISUAL
            </span>
          )}
          {template.layout_style === "receipt" && (
            <span className="bg-green-600 text-white text-[10px] font-bold px-2 py-1 rounded shadow-sm">
              RECEIPT
            </span>
          )}
        </div>
      </div>

      <div className="p-4 flex flex-col flex-grow">
        <div className="flex justify-between items-start mb-2">
          <h3
            className="font-bold text-gray-900 line-clamp-1 text-lg"
            title={template.title}
          >
            {template.title}
          </h3>
          {!template.is_public && (
            <div className="flex gap-1 -mr-2">
              <Link
                to={
                  template.layout_style === "visual"
                    ? `/dashboard/upload-template/${template.id}`
                    : "#"
                }
                onClick={
                  template.layout_style !== "visual"
                    ? (e) => {
                        e.preventDefault();
                        onEditClick(template);
                      }
                    : undefined
                }
                className="p-1.5 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-md transition-colors"
              >
                <Edit3 size={16} />
              </Link>
              <button
                onClick={(e) => {
                  e.preventDefault();
                  onDeleteClick(template);
                }}
                className="p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors"
              >
                <Trash2 size={16} />
              </button>
            </div>
          )}
        </div>

        <div className="mt-auto pt-3 border-t border-gray-100 flex items-center justify-between">
          <span className="text-xs text-gray-500 font-mono bg-gray-50 px-1.5 py-0.5 rounded border border-gray-200">
            ID: {template.id}
          </span>
          <button
            onClick={handleCopyId}
            className="text-gray-400 hover:text-gray-700 transition-colors"
            title="Copy ID"
          >
            {isCopied ? (
              <Check size={14} className="text-green-600" />
            ) : (
              <Copy size={14} />
            )}
          </button>
        </div>
      </div>
    </div>
  );
};

function TemplatesPage() {
  const [templates, setTemplates] = useState([]);
  const [formData, setFormData] = useState({
    title: "",
    logo: null,
    background: null,
    primary_color: "#2563EB",
    secondary_color: "#D1D5DB",
    body_font_color: "#111827",
    font_family: "Georgia",
    layout_style: "classic",
    custom_title: "Certificate of Completion",
    custom_body: "has successfully completed the course",
  });
  const [previewData, setPreviewData] = useState({
    logo_url: null,
    background_url: null,
    primary_color: "#2563EB",
    secondary_color: "#D1D5DB",
    body_font_color: "#111827",
    font_family: "Georgia",
    layout_style: "classic",
    custom_text: {
      title: "Certificate of Completion",
      body: "has successfully completed the course",
    },
  });
  const [editFormData, setEditFormData] = useState(null);
  const [showEditModal, setShowEditModal] = useState(false);
  const [loading, setLoading] = useState(true);
  const [isFullscreen, setIsFullscreen] = useState(false);
  const [showDeleteModal, setShowDeleteModal] = useState(false);
  const [templateToDelete, setTemplateToDelete] = useState(null);

  const fontOptions = [
    "Georgia",
    "Lato",
    "Roboto",
    "Arial",
    "Verdana",
    "Times New Roman",
  ];
  const layoutOptions = ["classic", "modern", "receipt"]; // Updated options

  useEffect(() => {
    fetchTemplates();
  }, []);

  const fetchTemplates = async () => {
    setLoading(true);
    try {
      const response = await getTemplates();
      setTemplates(response.data.templates);
    } catch (err) {
      toast.error("Could not fetch templates.");
    } finally {
      setLoading(false);
    }
  };

  const handleInputChange = (e) => {
    const { name, value } = e.target;
    const stateSetter = showEditModal ? setEditFormData : setFormData;
    stateSetter((prev) => ({ ...prev, [name]: value }));

    const targetPreview = showEditModal ? editFormData : formData;
    if (name === "custom_title" || name === "custom_body") {
      setPreviewData((prev) => ({
        ...prev,
        ...targetPreview,
        [name]: value,
        custom_text: {
          ...prev.custom_text,
          [name === "custom_title" ? "title" : "body"]: value,
        },
      }));
    } else {
      setPreviewData((prev) => ({ ...prev, ...targetPreview, [name]: value }));
    }
  };

  const handleFileChange = (e) => {
    const { name, files } = e.target;
    const file = files[0];
    if (file) {
      const stateSetter = showEditModal ? setEditFormData : setFormData;
      stateSetter((prev) => ({ ...prev, [name]: file }));
      setPreviewData((prev) => ({
        ...prev,
        [`${name}_url`]: URL.createObjectURL(file),
      }));
    }
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    const promise = new Promise(async (resolve, reject) => {
      const data = new FormData();
      Object.keys(formData).forEach((key) => {
        if (formData[key]) data.append(key, formData[key]);
      });
      try {
        await createTemplate(data);
        fetchTemplates();
        e.target.reset();
        resolve();
      } catch (err) {
        reject(err);
      }
    });
    toast.promise(promise, {
      loading: "Creating...",
      success: "Template created successfully!",
      error: (err) => err.response?.data?.msg || "Failed to create.",
    });
  };

  const handleEditClick = (template) => {
    setEditFormData({
      ...template,
      logo: null,
      background: null,
      custom_title: template.custom_text?.title,
      custom_body: template.custom_text?.body,
    });
    setPreviewData({
      ...template,
      logo_url: template.logo_url
        ? `${SERVER_BASE_URL}${template.logo_url}`
        : null,
      background_url: template.background_url
        ? `${SERVER_BASE_URL}${template.background_url}`
        : null,
    });
    setShowEditModal(true);
  };

  const handleEditSubmit = async (e) => {
    e.preventDefault();
    const promise = new Promise(async (resolve, reject) => {
      const data = new FormData();
      Object.keys(editFormData).forEach((key) => {
        if (
          key !== "logo_url" &&
          key !== "background_url" &&
          editFormData[key]
        ) {
          data.append(key, editFormData[key]);
        }
      });
      try {
        await updateTemplate(editFormData.id, data);
        setShowEditModal(false);
        fetchTemplates();
        resolve();
      } catch (err) {
        reject(err);
      }
    });
    toast.promise(promise, {
      loading: "Updating...",
      success: "Template updated!",
      error: (err) => err.response?.data?.msg || "Failed.",
    });
  };

  const handleDeleteConfirm = async () => {
    if (!templateToDelete) return;
    const promise = deleteTemplate(templateToDelete.id);
    toast.promise(promise, {
      loading: "Deleting...",
      success: () => {
        setShowDeleteModal(false);
        setTemplateToDelete(null);
        fetchTemplates();
        return "Template deleted!";
      },
      error: (err) => {
        setShowDeleteModal(false);
        return err.response?.data?.msg || "Failed.";
      },
    });
  };

  const currentFormState = showEditModal ? editFormData : formData;

  return (
    <div className="max-w-7xl mx-auto pb-12">
      <Toaster position="top-right" />

      {/* Header */}
      <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4">
        <div>
          <h2 className="text-2xl font-bold text-gray-900">Templates</h2>
          <p className="text-gray-500 mt-1">
            Design and manage your certificate layouts.
          </p>
        </div>
        <Link
          to="/dashboard/upload-template"
          className="inline-flex items-center justify-center bg-indigo-600 text-white rounded-lg py-2.5 px-5 hover:bg-indigo-700 transition-colors font-medium shadow-sm"
        >
          <Brush size={18} className="mr-2" />
          Open Visual Editor
        </Link>
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-12 gap-8 mb-16">
        {/* Creator Form */}
        <div className="col-span-12 lg:col-span-4">
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <div className="flex items-center gap-3 mb-6 pb-4 border-b border-gray-100">
              <LayoutTemplate size={20} className="text-indigo-600" />
              <h3 className="text-lg font-bold text-gray-900">
                Standard Creator
              </h3>
            </div>

            <form onSubmit={handleSubmit} className="space-y-5">
              <FormInput
                label="Template Name"
                name="title"
                value={formData.title}
                onChange={handleInputChange}
                required
                placeholder="e.g. Monthly Award"
              />

              <div className="grid grid-cols-2 gap-4">
                <FormSelect
                  label="Layout"
                  name="layout_style"
                  value={formData.layout_style}
                  onChange={handleInputChange}
                  options={layoutOptions}
                />
                <FormSelect
                  label="Font"
                  name="font_family"
                  value={formData.font_family}
                  onChange={handleInputChange}
                  options={fontOptions}
                />
              </div>

              <div className="space-y-3">
                <label className="block text-gray-700 font-semibold text-sm">
                  Colors
                </label>
                <div className="grid grid-cols-3 gap-3">
                  <FormColorInput
                    label="Primary"
                    name="primary_color"
                    value={formData.primary_color}
                    onChange={handleInputChange}
                  />
                  <FormColorInput
                    label="Accent"
                    name="secondary_color"
                    value={formData.secondary_color}
                    onChange={handleInputChange}
                  />
                  <FormColorInput
                    label="Text"
                    name="body_font_color"
                    value={formData.body_font_color}
                    onChange={handleInputChange}
                  />
                </div>
              </div>

              <div className="space-y-4 pt-2">
                <FormInput
                  label="Heading"
                  name="custom_title"
                  value={formData.custom_title}
                  onChange={handleInputChange}
                  placeholder="Certificate of..."
                />
                <FormInput
                  label="Body Text"
                  name="custom_body"
                  value={formData.custom_body}
                  onChange={handleInputChange}
                  placeholder="has successfully..."
                />
              </div>

              <div className="grid grid-cols-2 gap-4 pt-2">
                <FormFileInput
                  label="Logo"
                  name="logo"
                  onChange={handleFileChange}
                />
                <FormFileInput
                  label="Background"
                  name="background"
                  onChange={handleFileChange}
                />
              </div>

              <button
                type="submit"
                className="w-full bg-gray-900 text-white rounded-lg py-3 font-semibold hover:bg-black transition-all shadow-md mt-4 flex items-center justify-center gap-2"
              >
                <Plus size={18} /> Create Template
              </button>
            </form>
          </div>
        </div>

        {/* Live Preview - Sticky */}
        <div className="col-span-12 lg:col-span-8">
          <div className="bg-gray-100 rounded-xl border border-gray-200 p-6 sticky top-6">
            <div className="flex justify-between items-center mb-4">
              <div className="flex items-center gap-2 text-gray-700 font-bold">
                <Eye size={18} />
                <h4>Live Preview</h4>
              </div>
              <button
                onClick={() => setIsFullscreen(true)}
                className="p-2 text-gray-500 hover:text-gray-900 hover:bg-white rounded-lg transition-all shadow-sm"
              >
                <Maximize2 size={18} />
              </button>
            </div>
            <div className="w-full flex justify-center">
              <div className="w-full max-w-2xl bg-white shadow-xl rounded overflow-hidden">
                <TemplatePreview previewData={previewData} />
              </div>
            </div>
          </div>
        </div>
      </div>

      {/* Templates List */}
      <div>
        <h3 className="text-xl font-bold text-gray-900 mb-6 flex items-center gap-2">
          <div className="w-1 h-6 bg-indigo-600 rounded-full"></div>
          Your Library
        </h3>

        {loading ? (
          <div className="flex justify-center py-12">
            <Spinner animation="border" />
          </div>
        ) : templates.length > 0 ? (
          <div className="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-6">
            {templates.map((t) => (
              <TemplateCard
                key={t.id}
                template={t}
                onEditClick={handleEditClick}
                onDeleteClick={(template) => {
                  setTemplateToDelete(template);
                  setShowDeleteModal(true);
                }}
              />
            ))}
          </div>
        ) : (
          <div className="text-center py-12 bg-white rounded-xl border border-dashed border-gray-300">
            <p className="text-gray-500">
              No templates found. Create one above!
            </p>
          </div>
        )}
      </div>

      {/* Edit Modal */}
      <Modal
        show={showEditModal}
        onHide={() => setShowEditModal(false)}
        centered
        size="lg"
      >
        <Modal.Header closeButton className="border-0 pb-0">
          <Modal.Title className="font-bold">Edit Template</Modal.Title>
        </Modal.Header>
        <Modal.Body className="p-6">
          <form
            id="edit-form"
            onSubmit={handleEditSubmit}
            className="space-y-4"
          >
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div className="space-y-4">
                <FormInput
                  label="Name"
                  name="title"
                  value={currentFormState?.title}
                  onChange={handleInputChange}
                  required
                />
                <div className="grid grid-cols-2 gap-4">
                  <FormSelect
                    label="Layout"
                    name="layout_style"
                    value={currentFormState?.layout_style}
                    onChange={handleInputChange}
                    options={layoutOptions}
                  />
                  <FormSelect
                    label="Font"
                    name="font_family"
                    value={currentFormState?.font_family}
                    onChange={handleInputChange}
                    options={fontOptions}
                  />
                </div>
                <div className="grid grid-cols-3 gap-2">
                  <FormColorInput
                    label="Primary"
                    name="primary_color"
                    value={currentFormState?.primary_color}
                    onChange={handleInputChange}
                  />
                  <FormColorInput
                    label="Accent"
                    name="secondary_color"
                    value={currentFormState?.secondary_color}
                    onChange={handleInputChange}
                  />
                  <FormColorInput
                    label="Text"
                    name="body_font_color"
                    value={currentFormState?.body_font_color}
                    onChange={handleInputChange}
                  />
                </div>
              </div>
              <div className="space-y-4">
                <FormInput
                  label="Heading"
                  name="custom_title"
                  value={currentFormState?.custom_title}
                  onChange={handleInputChange}
                />
                <FormInput
                  label="Body"
                  name="custom_body"
                  value={currentFormState?.custom_body}
                  onChange={handleInputChange}
                />
                <FormFileInput
                  label="New Logo"
                  name="logo"
                  onChange={handleFileChange}
                />
                <FormFileInput
                  label="New Background"
                  name="background"
                  onChange={handleFileChange}
                />
              </div>
            </div>
          </form>
        </Modal.Body>
        <Modal.Footer className="border-0 pt-0">
          <Button variant="light" onClick={() => setShowEditModal(false)}>
            Cancel
          </Button>
          <Button variant="primary" type="submit" form="edit-form">
            Save Changes
          </Button>
        </Modal.Footer>
      </Modal>

      {/* Delete Modal */}
      <Modal
        show={showDeleteModal}
        onHide={() => setShowDeleteModal(false)}
        centered
      >
        <Modal.Header closeButton className="border-0">
          <Modal.Title className="text-red-600 font-bold">
            Delete Template?
          </Modal.Title>
        </Modal.Header>
        <Modal.Body>
          Are you sure you want to delete{" "}
          <strong>{templateToDelete?.title}</strong>?
          <br />
          This action cannot be undone.
        </Modal.Body>
        <Modal.Footer className="border-0">
          <Button variant="light" onClick={() => setShowDeleteModal(false)}>
            Cancel
          </Button>
          <Button variant="danger" onClick={handleDeleteConfirm}>
            Delete Forever
          </Button>
        </Modal.Footer>
      </Modal>

      {/* Fullscreen Preview */}
      {isFullscreen && (
        <div
          className="fixed inset-0 bg-black/90 z-[9999] flex items-center justify-center p-4"
          onClick={() => setIsFullscreen(false)}
        >
          <button className="absolute top-6 right-6 text-white hover:text-gray-300 transition-colors">
            <X size={32} />
          </button>
          <div
            className="w-full max-w-6xl"
            onClick={(e) => e.stopPropagation()}
          >
            <TemplatePreview previewData={previewData} isFullscreen={true} />
          </div>
        </div>
      )}
    </div>
  );
}

export default TemplatesPage;



==================================================
FILE: pages\UploadTemplatePage.jsx
==================================================

import React, { useState, useRef, createRef, useEffect } from "react";
import { useNavigate, useParams } from "react-router-dom";
import toast, { Toaster } from "react-hot-toast";
import {
  ArrowLeft,
  Save,
  UploadCloud,
  RotateCcw,
  RotateCw,
  Grid,
  FileBadge,
  Receipt,
} from "lucide-react";
import { Spinner } from "react-bootstrap";
import {
  createCustomTemplate,
  getTemplate,
  updateCustomTemplate,
} from "../api";
import CustomTemplateEditor from "../components/CustomTemplateEditor";
import TextElementControls from "../components/TextElementControls";
import { SERVER_BASE_URL } from "../config";

// --- PLACEHOLDER CONFIGURATIONS ---
const CERTIFICATE_PLACEHOLDERS = [
  { name: "Recipient Name", value: "{{recipient_name}}", defaultWidth: 350 },
  { name: "Course Title", value: "{{course_title}}", defaultWidth: 400 },
  { name: "Issue Date", value: "{{issue_date}}", defaultWidth: 200 },
  { name: "Issuer Name", value: "{{issuer_name}}", defaultWidth: 250 },
  { name: "Verification ID", value: "{{verification_id}}", defaultWidth: 300 },
  { name: "Signature", value: "{{signature}}", defaultWidth: 200 },
  { name: "QR Code", value: "{{qr_code}}", isQr: true },
];

const RECEIPT_PLACEHOLDERS = [
  { name: "Payer Name", value: "{{recipient_name}}", defaultWidth: 300 }, // Maps to recipient
  { name: "Total Amount", value: "{{amount}}", defaultWidth: 150 },
  { name: "Payment Date", value: "{{issue_date}}", defaultWidth: 200 },
  { name: "Description", value: "{{course_title}}", defaultWidth: 350 }, // Maps to course/event
  { name: "Receipt / Txn ID", value: "{{verification_id}}", defaultWidth: 250 },
  { name: "Issuer Name", value: "{{issuer_name}}", defaultWidth: 250 },
  { name: "Auth Signature", value: "{{signature}}", defaultWidth: 200 },
  { name: "QR Code", value: "{{qr_code}}", isQr: true },
];

const DraggablePlaceholder = ({ placeholder }) => (
  <div
    draggable
    className="text-sm bg-white border border-gray-200 hover:border-indigo-500 hover:shadow-sm text-gray-700 p-3 rounded-md cursor-grab active:cursor-grabbing mb-2 transition-all flex items-center justify-between group"
    onDragStart={(e) => {
      e.dataTransfer.setData("text/plain", JSON.stringify(placeholder));
    }}
  >
    <span className="font-medium group-hover:text-indigo-600">
      {placeholder.name}
    </span>
    <span className="text-[10px] text-gray-400 bg-gray-50 px-1.5 py-0.5 rounded border border-gray-100 font-mono">
      {placeholder.value.replace(/[{}]/g, "")}
    </span>
  </div>
);

const UploadTemplatePage = () => {
  const { templateId } = useParams();
  const navigate = useNavigate();
  const [templateTitle, setTemplateTitle] = useState("");
  const [templateType, setTemplateType] = useState("certificate"); // 'certificate' or 'receipt'
  const [templateImageFile, setTemplateImageFile] = useState(null);
  const [templateImageUrl, setTemplateImageUrl] = useState(null);
  const [elements, setElements] = useState([]);
  const [history, setHistory] = useState([[]]);
  const [currentStep, setCurrentStep] = useState(0);
  const [isLoadingHistory, setIsLoadingHistory] = useState(false);
  const [selectedId, setSelectedId] = useState(null);
  const [canvasSize, setCanvasSize] = useState({ width: 842, height: 595 });
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [isLoading, setIsLoading] = useState(!!templateId);
  const [showGrid, setShowGrid] = useState(true);
  const fileInputRef = useRef(null);
  const stageRef = createRef();

  useEffect(() => {
    if (templateId) {
      const fetchTemplateData = async () => {
        try {
          const response = await getTemplate(templateId);
          const { title, layout_data } = response.data;
          setTemplateTitle(title);

          if (layout_data) {
            // Restore template type if saved
            if (layout_data.type) setTemplateType(layout_data.type);

            const loadedElements = (layout_data.elements || []).map(
              (el, index) => ({
                ...el,
                id:
                  el.id ||
                  `el_${Math.random().toString(36).substring(2, 11)}_${index}`,
              })
            );
            setElements(loadedElements);
            setCanvasSize(layout_data.canvas || { width: 842, height: 595 });
            if (layout_data.background?.image) {
              setTemplateImageUrl(
                `${SERVER_BASE_URL}${layout_data.background.image}`
              );
            }
            setHistory([loadedElements]);
            setCurrentStep(0);
          }
        } catch (error) {
          toast.error("Failed to load template data.");
          navigate("/dashboard/templates");
        } finally {
          setIsLoading(false);
        }
      };
      fetchTemplateData();
    }
  }, [templateId, navigate]);

  useEffect(() => {
    if (!isLoadingHistory) {
      const newHistory = history.slice(0, currentStep + 1);
      newHistory.push(elements);
      setHistory(newHistory);
      setCurrentStep(newHistory.length - 1);
    } else {
      setIsLoadingHistory(false);
    }
  }, [elements]);

  const handleUndo = () => {
    if (currentStep > 0) {
      setIsLoadingHistory(true);
      const prevStep = currentStep - 1;
      setCurrentStep(prevStep);
      setElements(history[prevStep]);
    }
  };

  const handleRedo = () => {
    if (currentStep < history.length - 1) {
      setIsLoadingHistory(true);
      const nextStep = currentStep + 1;
      setCurrentStep(nextStep);
      setElements(history[nextStep]);
    }
  };

  const handleFileChange = (e) => {
    const file = e.target.files[0];
    if (file && (file.type === "image/png" || file.type === "image/jpeg")) {
      const reader = new FileReader();
      reader.onload = (event) => {
        const img = new Image();
        img.onload = () => {
          const aspectRatio = img.width / img.height;
          // Default to A4 width (landscape) or keep ratio
          const canvasWidth = 842;
          const canvasHeight = canvasWidth / aspectRatio;
          setCanvasSize({ width: canvasWidth, height: canvasHeight });
          setTemplateImageUrl(event.target.result);
          setTemplateImageFile(file);
        };
        img.src = event.target.result;
      };
      reader.readAsDataURL(file);
    } else {
      toast.error("Please upload a valid PNG or JPG image.");
    }
  };

  const handleDrop = (e) => {
    e.preventDefault();
    if (!stageRef.current) return;

    stageRef.current.setPointersPositions(e);
    const pos = stageRef.current.getPointerPosition();
    const placeholder = JSON.parse(e.dataTransfer.getData("text/plain"));

    const defaultWidth = placeholder.defaultWidth || 250;
    const isQr = placeholder.isQr || false;

    const newElement = {
      id: `el_${Math.random().toString(36).substring(2, 11)}`,
      type: "placeholder",
      text: placeholder.value,
      x: pos.x - defaultWidth / 2,
      y: pos.y - 15,
      width: defaultWidth,
      height: 30,
      fontSize: 20,
      fontFamily: "Times New Roman",
      fill: "#000000",
      align: isQr ? "center" : "left",
      fontStyle: "normal",
      rotation: 0,
      verticalAlign: "middle",
      isQr,
    };

    if (isQr) {
      newElement.x = pos.x - 50;
      newElement.y = pos.y - 50;
      newElement.width = 100;
      newElement.height = 100;
    }

    setElements([...elements, newElement]);
  };

  const handleSaveTemplate = async () => {
    if (!templateTitle.trim())
      return toast.error("Please provide a title for your template.");
    if (!templateImageUrl)
      return toast.error("Please upload or keep a template image.");
    if (elements.length === 0)
      return toast.error("Please add at least one placeholder element.");

    setIsSubmitting(true);
    const layoutData = {
      type: templateType, // Save the type (certificate/receipt)
      canvas: canvasSize,
      elements: elements.map((el) => ({
        id: el.id,
        type: "placeholder",
        text: el.text,
        x: el.x,
        y: el.y,
        width: el.width,
        height: el.height,
        fontSize: el.fontSize,
        fontFamily: el.fontFamily,
        fill: el.fill,
        align: el.align,
        fontStyle: el.fontStyle,
        rotation: el.rotation,
        verticalAlign: el.verticalAlign,
        isQr: el.isQr,
      })),
    };

    if (templateId && !templateImageFile && templateImageUrl) {
      const relativePath = templateImageUrl.replace(SERVER_BASE_URL, "");
      layoutData.background = { image: relativePath };
    }

    const formData = new FormData();
    formData.append("title", templateTitle);
    formData.append("layout_data", JSON.stringify(layoutData));
    if (templateImageFile) {
      formData.append("template_image", templateImageFile);
    }

    const promise = templateId
      ? updateCustomTemplate(templateId, formData)
      : createCustomTemplate(formData);

    toast.promise(promise, {
      loading: templateId ? "Updating template..." : "Saving template...",
      success: () => {
        setTimeout(() => navigate("/dashboard/templates"), 1500);
        return `Template ${templateId ? "updated" : "saved"} successfully!`;
      },
      error: (err) => err.response?.data?.msg || `Failed to save template.`,
    });
    promise.finally(() => setIsSubmitting(false));
  };

  const selectedElement = elements.find((el) => el.id === selectedId);
  const activePlaceholders =
    templateType === "receipt"
      ? RECEIPT_PLACEHOLDERS
      : CERTIFICATE_PLACEHOLDERS;

  return (
    <div className="min-h-screen bg-gray-100 flex flex-col font-sans">
      <Toaster position="top-center" />
      <header className="bg-white shadow-sm border-b border-gray-200 px-6 py-3 flex items-center justify-between sticky top-0 z-50">
        <div className="flex items-center gap-4">
          <button
            onClick={() => navigate("/dashboard/templates")}
            className="text-gray-500 hover:text-gray-900 transition-colors p-2 rounded-full hover:bg-gray-100"
          >
            <ArrowLeft size={20} />
          </button>
          <div className="h-6 w-px bg-gray-300"></div>
          <input
            type="text"
            value={templateTitle}
            onChange={(e) => setTemplateTitle(e.target.value)}
            placeholder="Untitled Template"
            className="text-lg font-bold text-gray-800 border-none focus:ring-0 placeholder-gray-400 bg-transparent w-64"
          />
        </div>
        <div className="flex items-center gap-3">
          <div className="bg-gray-100 p-1 rounded-lg flex text-sm font-medium mr-4">
            <button
              onClick={() => setTemplateType("certificate")}
              className={`px-3 py-1.5 rounded-md flex items-center gap-2 transition-all ${
                templateType === "certificate"
                  ? "bg-white text-indigo-600 shadow-sm"
                  : "text-gray-500 hover:text-gray-700"
              }`}
            >
              <FileBadge size={16} /> Certificate
            </button>
            <button
              onClick={() => setTemplateType("receipt")}
              className={`px-3 py-1.5 rounded-md flex items-center gap-2 transition-all ${
                templateType === "receipt"
                  ? "bg-white text-indigo-600 shadow-sm"
                  : "text-gray-500 hover:text-gray-700"
              }`}
            >
              <Receipt size={16} /> Receipt
            </button>
          </div>

          <button
            onClick={() => setShowGrid(!showGrid)}
            className={`p-2 rounded-md transition-colors ${
              showGrid
                ? "bg-indigo-50 text-indigo-600"
                : "text-gray-500 hover:bg-gray-100"
            }`}
            title="Toggle Grid"
          >
            <Grid size={18} />
          </button>
          <div className="h-6 w-px bg-gray-300 mx-1"></div>
          <button
            onClick={handleUndo}
            disabled={currentStep <= 0}
            className="text-gray-600 hover:text-gray-900 disabled:opacity-30 p-2 rounded-md hover:bg-gray-100"
          >
            <RotateCcw size={18} />
          </button>
          <button
            onClick={handleRedo}
            disabled={currentStep >= history.length - 1}
            className="text-gray-600 hover:text-gray-900 disabled:opacity-30 p-2 rounded-md hover:bg-gray-100"
          >
            <RotateCw size={18} />
          </button>
          <button
            onClick={handleSaveTemplate}
            disabled={isSubmitting}
            className="bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-5 rounded-lg flex items-center gap-2 disabled:opacity-70 shadow-sm transition-all ml-2"
          >
            {isSubmitting ? (
              <Spinner animation="border" size="sm" />
            ) : (
              <Save size={18} />
            )}
            <span>Save</span>
          </button>
        </div>
      </header>

      <div className="flex-grow grid grid-cols-12 gap-0 overflow-hidden">
        <aside className="col-span-3 bg-white border-r border-gray-200 flex flex-col h-[calc(100vh-64px)]">
          <div className="p-5 border-b border-gray-100">
            <h3 className="font-bold text-gray-800 text-lg flex items-center gap-2">
              {templateType === "receipt" ? (
                <Receipt size={20} className="text-indigo-600" />
              ) : (
                <FileBadge size={20} className="text-indigo-600" />
              )}
              {templateType === "receipt"
                ? "Receipt Editor"
                : "Certificate Editor"}
            </h3>
            <p className="text-xs text-gray-500 mt-1">
              Drag fields to design your layout.
            </p>
          </div>

          <div className="flex-grow overflow-y-auto p-5">
            {isLoading ? (
              <div className="text-center py-10">
                <Spinner variant="primary" />
              </div>
            ) : !templateImageUrl ? (
              <div
                onClick={() => fileInputRef.current?.click()}
                className="text-center p-8 border-2 border-dashed border-gray-300 rounded-xl cursor-pointer hover:border-indigo-500 hover:bg-indigo-50 transition-all group"
              >
                <div className="bg-indigo-100 p-4 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform">
                  <UploadCloud size={32} className="text-indigo-600" />
                </div>
                <h4 className="font-bold text-gray-800">Upload Design</h4>
                <p className="text-xs text-gray-500 mt-2">
                  Upload a blank {templateType} background (JPG/PNG).
                </p>
                <input
                  type="file"
                  ref={fileInputRef}
                  className="hidden"
                  accept="image/png, image/jpeg"
                  onChange={handleFileChange}
                />
              </div>
            ) : (
              <div className="space-y-6">
                <div>
                  <div className="flex justify-between items-center mb-3">
                    <h4 className="text-xs font-bold text-gray-400 uppercase tracking-wider">
                      Variables
                    </h4>
                    <button
                      onClick={() => fileInputRef.current?.click()}
                      className="text-[10px] text-indigo-600 font-bold hover:underline"
                    >
                      Change Image
                    </button>
                    <input
                      type="file"
                      ref={fileInputRef}
                      className="hidden"
                      accept="image/png, image/jpeg"
                      onChange={handleFileChange}
                    />
                  </div>
                  <div>
                    {activePlaceholders.map((p) => (
                      <DraggablePlaceholder key={p.value} placeholder={p} />
                    ))}
                  </div>
                </div>

                {selectedElement && (
                  <div className="border-t border-gray-100 pt-6">
                    <h4 className="text-xs font-bold text-gray-400 uppercase tracking-wider mb-3">
                      Settings
                    </h4>
                    <TextElementControls
                      element={selectedElement}
                      onUpdate={(updatedAttrs) => {
                        const updatedElements = elements.map((el) =>
                          el.id === selectedId ? { ...el, ...updatedAttrs } : el
                        );
                        setElements(updatedElements);
                      }}
                      onDelete={() => {
                        setElements(
                          elements.filter((el) => el.id !== selectedId)
                        );
                        setSelectedId(null);
                      }}
                      onDone={() => setSelectedId(null)}
                    />
                  </div>
                )}
              </div>
            )}
          </div>
        </aside>

        <main
          className="col-span-9 bg-gray-100 flex items-center justify-center overflow-auto p-8 relative h-[calc(100vh-64px)]"
          onDrop={handleDrop}
          onDragOver={(e) => e.preventDefault()}
        >
          {templateImageUrl ? (
            <CustomTemplateEditor
              stageRef={stageRef}
              backgroundImageUrl={templateImageUrl}
              elements={elements}
              setElements={setElements}
              selectedId={selectedId}
              setSelectedId={setSelectedId}
              canvasSize={canvasSize}
              showGrid={showGrid}
            />
          ) : (
            <div className="text-center text-gray-400 select-none pointer-events-none">
              <UploadCloud size={64} className="mx-auto opacity-20 mb-4" />
              <p className="text-lg font-medium">Canvas Empty</p>
              <p className="text-sm">
                Upload a template image from the sidebar to begin.
              </p>
            </div>
          )}
        </main>
      </div>
    </div>
  );
};

export default UploadTemplatePage;



==================================================
FILE: pages\VerifyCertificatePage.jsx
==================================================

import React, { useState, useEffect } from "react";
import { useParams, useNavigate, Link } from "react-router-dom";
import { verifyCertificate } from "../api";
import { SERVER_BASE_URL } from "../config";
import QRCode from "react-qr-code";
import {
  CheckCircle,
  XCircle,
  Search,
  Building,
  AlertCircle,
  Loader2,
  ArrowLeft,
} from "lucide-react";
import KonvaPreview from "../components/KonvaPreview";
import PublicHeader from "../components/PublicHeader";
import PublicFooter from "../components/PublicFooter";

// --- CERTIFICATE DISPLAY COMPONENT ---
const CertificateDisplay = ({ certificate, template }) => {
  if (!certificate || !template) return null;

  if (template.layout_style === "visual") {
    if (!template.layout_data) {
      return (
        <div className="flex items-center justify-center h-full bg-gray-50 rounded-lg p-8 border-2 border-dashed border-red-200">
          <p className="text-red-600 text-center font-medium">
            Preview Unavailable: Missing layout data.
          </p>
        </div>
      );
    }
    return (
      <div className="shadow-2xl rounded-lg overflow-hidden h-full bg-white">
        <KonvaPreview
          layoutData={template.layout_data}
          dynamicData={certificate}
        />
      </div>
    );
  }

  // --- FIX: Destructure layout_style here ---
  const {
    layout_style,
    primary_color = "#2563EB",
    secondary_color = "#64748B",
    body_font_color = "#333333",
    font_family = "Georgia",
    background_url,
    logo_url,
    custom_text = {},
  } = template;

  const {
    recipient_name,
    course_title,
    issue_date,
    signature,
    issuer_name,
    verification_id,
  } = certificate;

  const certificateTitle = custom_text.title || "Certificate of Completion";
  const certificateBody =
    custom_text.body || "has successfully completed the course";
  const issueDateFormatted = new Date(issue_date).toLocaleDateString("en-US", {
    year: "numeric",
    month: "long",
    day: "numeric",
  });

  const textStyle = { color: body_font_color, fontFamily: font_family };
  const backgroundStyle = background_url
    ? {
        backgroundImage: `url(${SERVER_BASE_URL}${background_url})`,
        backgroundSize: "cover",
        backgroundPosition: "center",
      }
    : {};

  const renderClassic = () => (
    <div
      className="w-full h-full bg-white p-2 shadow-2xl rounded-lg overflow-hidden"
      style={{ fontFamily: font_family }}
    >
      <div
        className="relative flex flex-col h-full w-full border-[8px] border-double"
        style={{ borderColor: primary_color, ...backgroundStyle }}
      >
        <div
          className="h-3 w-full border-b-4"
          style={{
            borderColor: primary_color,
            background: `linear-gradient(to right, ${primary_color}, ${secondary_color})`,
          }}
        ></div>

        <div className="flex-grow flex flex-col items-center justify-center text-center p-8 relative">
          {logo_url && (
            <img
              src={`${SERVER_BASE_URL}${logo_url}`}
              alt="Logo"
              className="h-24 w-auto object-contain mb-4"
            />
          )}

          <h1
            className="text-4xl font-bold uppercase tracking-wider mb-2"
            style={{ color: primary_color }}
          >
            {certificateTitle}
          </h1>
          <p className="text-lg italic mb-4" style={{ color: "#4B5EAA" }}>
            This is to certify that
          </p>

          <h2
            className="text-5xl font-extrabold mb-4"
            style={{ fontFamily: "'Georgia', serif", ...textStyle }}
          >
            {recipient_name}
          </h2>

          <p className="text-xl italic mb-6" style={{ color: "#4B5EAA" }}>
            {certificateBody}
          </p>

          <p
            className="text-3xl font-bold uppercase mb-8"
            style={{ color: secondary_color }}
          >
            {course_title}
          </p>

          <div className="w-full flex justify-around items-end mt-auto pt-8 px-12">
            <div className="text-center w-1/3">
              <p
                className="text-lg font-semibold border-b border-gray-400 pb-1 mb-1"
                style={textStyle}
              >
                {issueDateFormatted}
              </p>
              <span className="text-gray-500 text-sm">Date</span>
            </div>
            <div className="text-center w-1/3">
              <p
                className="text-lg font-semibold border-b border-gray-400 pb-1 mb-1"
                style={textStyle}
              >
                {signature || issuer_name}
              </p>
              <span className="text-gray-500 text-sm">Signature</span>
            </div>
          </div>

          <div className="absolute bottom-4 right-4 bg-white p-1.5 rounded shadow-md">
            <QRCode
              value={`${window.location.origin}/verify/${verification_id}`}
              size={64}
            />
          </div>

          <div className="absolute bottom-4 left-4 text-left text-xs text-gray-500">
            <p className="mb-0 font-semibold">Issued by: {issuer_name}</p>
            <p className="font-mono">ID: {verification_id}</p>
          </div>
        </div>
      </div>
    </div>
  );

  const renderModern = () => (
    <div
      className="flex w-full h-full bg-white shadow-2xl rounded-lg overflow-hidden"
      style={{ fontFamily: font_family, border: `6px solid ${primary_color}` }}
    >
      <div
        className="w-[35%] flex flex-col justify-between items-center p-8 text-white text-center"
        style={{
          background: `linear-gradient(135deg, ${primary_color}, ${secondary_color})`,
        }}
      >
        <div>
          {logo_url && (
            <img
              src={`${SERVER_BASE_URL}${logo_url}`}
              className="w-24 h-24 rounded-full bg-white p-1 shadow-lg mb-4 object-contain mx-auto"
              alt="Logo"
            />
          )}
          <p className="font-bold uppercase tracking-widest text-sm opacity-90">
            {issuer_name}
          </p>
        </div>
        <div className="bg-white p-2 rounded-lg shadow-lg">
          <QRCode
            value={`${window.location.origin}/verify/${verification_id}`}
            size={80}
          />
        </div>
      </div>

      <div
        className="w-[65%] flex flex-col justify-center p-12 relative bg-white/95"
        style={backgroundStyle}
      >
        <h1
          className="text-xl font-light uppercase tracking-[0.2em] mb-6"
          style={{ color: primary_color }}
        >
          {certificateTitle}
        </h1>
        <h2
          className="text-5xl font-bold mb-4 leading-tight"
          style={{ fontFamily: "'Georgia', serif", ...textStyle }}
        >
          {recipient_name}
        </h2>
        <p className="text-lg italic text-gray-600 mb-6">{certificateBody}</p>
        <p
          className="text-2xl font-bold uppercase tracking-wide mb-8"
          style={{ color: secondary_color }}
        >
          {course_title}
        </p>

        <div
          className="mt-auto pt-6 border-t-2 flex justify-between text-sm"
          style={{ borderColor: primary_color }}
        >
          <div>
            <p className="font-bold text-lg mb-0" style={textStyle}>
              {issueDateFormatted}
            </p>
            <span className="text-gray-500 uppercase text-xs tracking-wider">
              Date
            </span>
          </div>
          <div className="text-right">
            <p className="font-bold text-lg mb-0" style={textStyle}>
              {signature || issuer_name}
            </p>
            <span className="text-gray-500 uppercase text-xs tracking-wider">
              Signature
            </span>
          </div>
        </div>
      </div>
    </div>
  );

  return layout_style === "modern" ? renderModern() : renderClassic();
};

// --- MAIN PAGE COMPONENT ---
const VerifyCertificatePage = () => {
  const { verificationId: paramId } = useParams();
  const [verificationId, setVerificationId] = useState(paramId || "");
  const [certificate, setCertificate] = useState(null);
  const [template, setTemplate] = useState(null);
  const [company, setCompany] = useState(null);
  const [error, setError] = useState("");
  const [loading, setLoading] = useState(!!paramId);
  const navigate = useNavigate();

  const handleVerify = async (idToVerify) => {
    if (!idToVerify?.trim()) {
      setError("Please enter a valid Verification ID.");
      return;
    }
    setError("");
    setCertificate(null);
    setTemplate(null);
    setCompany(null);
    setLoading(true);

    // Update URL without reload if manually typing
    if (idToVerify !== paramId) {
      navigate(`/verify/${idToVerify}`, { replace: true });
    }

    try {
      const response = await verifyCertificate(idToVerify);
      setCertificate(response.data.certificate);
      setTemplate(response.data.template);
      setCompany(response.data.company);
    } catch (err) {
      setError(
        err.response?.data?.msg || "Verification failed. Credential not found."
      );
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    if (paramId) handleVerify(paramId);
  }, [paramId]);

  const handleSubmit = (e) => {
    e.preventDefault();
    handleVerify(verificationId);
  };

  return (
    <div className="min-h-screen bg-gray-50 flex flex-col font-sans">
      <PublicHeader />

      <main className="flex-grow py-12 px-4 sm:px-6 lg:px-8">
        <div className="max-w-3xl mx-auto">
          {/* Header Section */}
          <div className="text-center mb-10">
            <h1 className="text-3xl font-extrabold text-gray-900 sm:text-4xl mb-3">
              Credential Verification
            </h1>
            <p className="text-lg text-gray-600 max-w-2xl mx-auto">
              Verify the authenticity of a digital credential by entering its
              unique ID below.
            </p>
          </div>

          {/* Search Card */}
          <div className="bg-white rounded-2xl shadow-sm border border-gray-200 p-6 md:p-8 mb-8 max-w-xl mx-auto">
            <form onSubmit={handleSubmit} className="space-y-4">
              <div>
                <label htmlFor="verify-id" className="sr-only">
                  Verification ID
                </label>
                <input
                  id="verify-id"
                  type="text"
                  className="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-lg py-3 px-4"
                  placeholder="e.g. 550e8400-e29b..."
                  value={verificationId}
                  onChange={(e) => setVerificationId(e.target.value)}
                  required
                />
              </div>
              <button
                type="submit"
                disabled={loading}
                className="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-base font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-70 disabled:cursor-not-allowed transition-colors"
              >
                {loading ? (
                  <Loader2 className="animate-spin" />
                ) : (
                  <span className="flex items-center gap-2">
                    <Search size={20} /> Verify Credential
                  </span>
                )}
              </button>
            </form>
          </div>

          {error && (
            <div className="max-w-xl mx-auto mb-8 bg-red-50 border-l-4 border-red-500 p-4 rounded-r-lg flex items-start gap-3">
              <XCircle className="text-red-500 mt-0.5 shrink-0" size={20} />
              <p className="text-red-700 font-medium">{error}</p>
            </div>
          )}

          {certificate && template && (
            <div className="animate-in fade-in slide-in-from-bottom-4 duration-500">
              {/* Status Banner */}
              <div
                className={`rounded-xl p-4 mb-6 flex items-start gap-4 border ${
                  certificate.status === "valid"
                    ? "bg-green-50 border-green-200"
                    : "bg-red-50 border-red-200"
                }`}
              >
                {certificate.status === "valid" ? (
                  <CheckCircle className="text-green-600 shrink-0" size={24} />
                ) : (
                  <AlertCircle className="text-red-600 shrink-0" size={24} />
                )}
                <div>
                  <h3
                    className={`font-bold text-lg ${
                      certificate.status === "valid"
                        ? "text-green-800"
                        : "text-red-800"
                    }`}
                  >
                    {certificate.status === "valid"
                      ? "Valid Credential"
                      : "Revoked Credential"}
                  </h3>
                  <p
                    className={`text-sm mt-1 ${
                      certificate.status === "valid"
                        ? "text-green-700"
                        : "text-red-700"
                    }`}
                  >
                    Issued to <strong>{certificate.recipient_name}</strong> on{" "}
                    {new Date(certificate.issue_date).toLocaleDateString()}.
                  </p>
                </div>
              </div>

              {/* Company Info */}
              {company && (
                <div className="bg-blue-50 border border-blue-100 rounded-xl p-4 mb-8 flex items-center gap-3">
                  <div className="bg-blue-100 p-2 rounded-full text-blue-600">
                    <Building size={20} />
                  </div>
                  <div>
                    <p className="text-sm text-blue-900">
                      Issued by verified organization:{" "}
                      <strong>{company.name}</strong>
                    </p>
                  </div>
                </div>
              )}

              {/* Certificate Preview */}
              <div
                className="w-full max-w-4xl mx-auto rounded-lg shadow-2xl overflow-hidden bg-white"
                style={{ aspectRatio: "1.414/1" }}
              >
                <CertificateDisplay
                  certificate={certificate}
                  template={template}
                />
              </div>
            </div>
          )}
        </div>
      </main>
      <PublicFooter />
    </div>
  );
};

export default VerifyCertificatePage;



==================================================
FILE: pages\VerifyEmailPage.jsx
==================================================

import React, { useState, useEffect } from "react";
import { Link, useNavigate, useLocation } from "react-router-dom";
import { Form, Spinner, Alert } from "react-bootstrap";
import { verifyEmail, resendVerificationEmail } from "../api";
import { Mail, ArrowRight, ShieldCheck, ArrowLeft } from "lucide-react";

function VerifyEmailPage() {
  const [verificationCode, setVerificationCode] = useState("");
  const [error, setError] = useState("");
  const [success, setSuccess] = useState("");
  const [loading, setLoading] = useState(false);
  const [resendLoading, setResendLoading] = useState(false);
  const navigate = useNavigate();
  const location = useLocation();
  const email = location.state?.email;

  useEffect(() => {
    if (!email) {
      navigate("/signup");
    }
  }, [email, navigate]);

  const handleChange = (e) => {
    // Only allow numbers and max 6 chars
    const val = e.target.value.replace(/\D/g, "").slice(0, 6);
    setVerificationCode(val);
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError("");
    setSuccess("");
    setLoading(true);

    try {
      const response = await verifyEmail({
        email,
        verification_code: verificationCode,
      });
      localStorage.setItem("token", response.data.access_token);
      navigate("/dashboard");
    } catch (err) {
      setError(
        err.response?.data?.msg || "Verification failed. Check the code."
      );
    } finally {
      setLoading(false);
    }
  };

  const handleResendCode = async () => {
    setError("");
    setSuccess("");
    setResendLoading(true);
    try {
      const response = await resendVerificationEmail(email);
      setSuccess(response.data.msg);
    } catch (err) {
      setError(err.response?.data?.msg || "Failed to resend code.");
    } finally {
      setResendLoading(false);
    }
  };

  if (!email) return null;

  return (
    <div className="d-flex min-vh-100 bg-white">
      {/* LEFT SIDE - BRANDING */}
      <div
        className="d-none d-lg-flex col-lg-6 bg-indigo-900 text-white flex-column justify-content-center align-items-center p-5 position-relative overflow-hidden"
        style={{
          background: "linear-gradient(135deg, #1e1b4b 0%, #3730a3 100%)",
        }}
      >
        <div
          className="position-relative z-1 text-center"
          style={{ maxWidth: "480px" }}
        >
          <ShieldCheck size={64} className="mb-4 text-indigo-300" />
          <h1 className="fw-bold display-6 mb-3">Secure Your Account</h1>
          <p className="lead opacity-75">
            Verification helps us keep your data safe and ensures you are a real
            person.
          </p>
        </div>
      </div>

      {/* RIGHT SIDE - FORM */}
      <div className="col-12 col-lg-6 d-flex flex-column justify-content-center align-items-center p-4 p-md-5 bg-light">
        <div
          className="w-100 bg-white p-4 p-md-5 rounded-4 shadow-sm text-center"
          style={{ maxWidth: "450px" }}
        >
          <div className="mb-4">
            <div className="bg-indigo-50 d-inline-flex p-3 rounded-circle mb-3 text-indigo-600">
              <Mail size={32} />
            </div>
            <h2 className="fw-bold text-dark mb-2">Check Your Email</h2>
            <p className="text-muted small mb-0">
              We've sent a 6-digit code to:
            </p>
            <p className="fw-bold text-dark">{email}</p>
          </div>

          {error && (
            <Alert
              variant="danger"
              className="border-0 bg-danger-subtle text-danger small py-2"
            >
              {error}
            </Alert>
          )}
          {success && (
            <Alert
              variant="success"
              className="border-0 bg-success-subtle text-success small py-2"
            >
              {success}
            </Alert>
          )}

          <Form onSubmit={handleSubmit} className="mb-4">
            <Form.Group className="mb-4">
              <Form.Control
                type="text"
                value={verificationCode}
                onChange={handleChange}
                placeholder="000000"
                className="text-center fw-bold fs-3 tracking-widest border-2 py-2"
                style={{ letterSpacing: "0.5em" }}
                autoFocus
                required
              />
            </Form.Group>

            <button
              type="submit"
              disabled={loading || verificationCode.length < 6}
              className="btn btn-primary w-100 py-2.5 fw-bold shadow-sm"
              style={{ backgroundColor: "#4f46e5", borderColor: "#4f46e5" }}
            >
              {loading ? (
                <Spinner size="sm" animation="border" />
              ) : (
                <>
                  Verify & Sign In <ArrowRight size={18} className="ms-1" />
                </>
              )}
            </button>
          </Form>

          <div className="d-flex flex-column gap-2 text-sm">
            <div className="text-muted">
              Didn't receive the code?{" "}
              <button
                onClick={handleResendCode}
                disabled={resendLoading}
                className="btn btn-link p-0 text-indigo-600 text-decoration-none fw-bold"
              >
                {resendLoading ? "Sending..." : "Resend"}
              </button>
            </div>

            <div className="border-top pt-3 mt-2">
              <Link
                to="/login"
                className="text-muted text-decoration-none small d-inline-flex align-items-center hover:text-dark"
              >
                <ArrowLeft size={14} className="me-1" /> Back to Sign In
              </Link>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

export default VerifyEmailPage;



==================================================
FILE: pages\ViewCertificatePage.jsx
==================================================

import React, { useState, useEffect, Component } from "react";
import { useParams, useNavigate, Link } from "react-router-dom";
import { Container, Spinner, Modal, Button } from "react-bootstrap";
import {
  getCertificate,
  getCertificatePDF,
  updateCertificateStatus,
  getTemplates,
} from "../api";
import { SERVER_BASE_URL } from "../config";
import QRCode from "react-qr-code";
import {
  Edit3,
  Download,
  Maximize2,
  X,
  CheckCircle,
  AlertCircle,
  RefreshCw,
  ArrowLeft,
  Mail,
  Calendar,
  Award,
  User,
  Shield,
  Globe,
} from "lucide-react";
import toast, { Toaster } from "react-hot-toast";
import KonvaPreview from "../components/KonvaPreview";

// --- ERROR BOUNDARY ---
class ErrorBoundary extends Component {
  state = { hasError: false, error: null };
  static getDerivedStateFromError(error) {
    return { hasError: true, error };
  }
  render() {
    if (this.state.hasError) {
      return (
        <div className="bg-red-50 border-l-4 border-red-500 p-4 m-4">
          <h3 className="text-red-700 font-bold">Something went wrong</h3>
          <p className="text-red-600">
            {this.state.error?.message || "An error occurred."}
          </p>
        </div>
      );
    }
    return this.props.children;
  }
}

// --- PREVIEW COMPONENT ---
const CertificateDisplay = ({ certificate, template }) => {
  if (!certificate || !template) return null;

  if (template.layout_style === "visual") {
    return (
      <KonvaPreview
        layoutData={template.layout_data}
        dynamicData={certificate}
      />
    );
  }

  const {
    layout_style,
    primary_color = "#2563EB",
    secondary_color = "#64748B",
    body_font_color = "#333333",
    font_family = "Georgia",
    background_url,
    logo_url,
    custom_text = {},
  } = template;

  const {
    recipient_name,
    course_title,
    issue_date,
    signature,
    issuer_name,
    verification_id,
  } = certificate;

  const certificateTitle = custom_text.title || "Certificate of Completion";
  const certificateBody =
    custom_text.body || "has successfully completed the course";
  const issueDateFormatted = new Date(issue_date).toLocaleDateString("en-US", {
    year: "numeric",
    month: "long",
    day: "numeric",
  });
  const textStyle = { color: body_font_color, fontFamily: font_family };
  const backgroundStyle = background_url
    ? {
        backgroundImage: `url(${SERVER_BASE_URL}${background_url})`,
        backgroundSize: "cover",
        backgroundPosition: "center",
      }
    : {};

  const renderClassic = () => (
    <div
      className="h-full w-full bg-white relative flex flex-col overflow-hidden"
      style={{
        border: `8px double ${primary_color}`,
        ...backgroundStyle,
        fontFamily: font_family,
      }}
    >
      <div
        style={{
          height: "12px",
          borderBottom: `4px solid ${primary_color}`,
          background: `linear-gradient(to right, ${primary_color}, ${secondary_color})`,
        }}
      />
      <div className="flex-grow flex flex-col justify-center items-center text-center p-6">
        {logo_url && (
          <img
            src={`${SERVER_BASE_URL}${logo_url}`}
            alt="Logo"
            className="mb-3 object-contain w-24 h-24"
          />
        )}
        <h1
          className="font-bold uppercase tracking-wider text-2xl md:text-3xl"
          style={{ color: primary_color }}
        >
          {certificateTitle}
        </h1>
        <p
          className="italic my-1 text-base md:text-lg"
          style={{ color: "#4B5EAA" }}
        >
          This is to certify that
        </p>
        <h2
          className="font-extrabold my-2 text-3xl md:text-4xl"
          style={{
            fontFamily: "'Georgia', serif",
            ...textStyle,
          }}
        >
          {recipient_name}
        </h2>
        <p
          className="italic my-2 text-base md:text-lg"
          style={{ color: "#4B5EAA" }}
        >
          {certificateBody}
        </p>
        <p
          className="font-bold uppercase my-3 text-xl md:text-2xl"
          style={{ color: secondary_color }}
        >
          {course_title}
        </p>
        <p className="my-2 text-base" style={{ color: body_font_color }}>
          Awarded on {issueDateFormatted}
        </p>

        <div className="flex justify-between w-full mt-auto pt-6 px-4">
          <div className="text-center w-1/3">
            <p className="font-semibold text-sm md:text-base" style={textStyle}>
              {signature || issuer_name}
            </p>
            <hr className="w-full my-1 border-gray-400" />
            <span className="text-gray-500 text-xs">Authorized Signature</span>
          </div>
          <div className="text-center w-1/3">
            <p className="font-semibold text-sm md:text-base" style={textStyle}>
              {issuer_name}
            </p>
            <hr className="w-full my-1 border-gray-400" />
            <span className="text-gray-500 text-xs">Issuer</span>
          </div>
        </div>

        <div className="absolute bottom-2 right-2 bg-white p-1 rounded shadow-sm">
          <QRCode
            value={`${window.location.origin}/verify/${verification_id}`}
            size={50}
          />
        </div>
      </div>
    </div>
  );

  const renderModern = () => (
    <div
      className="flex h-full w-full overflow-hidden text-white"
      style={{
        border: `6px solid ${primary_color}`,
        ...backgroundStyle,
        fontFamily: font_family,
      }}
    >
      <div
        className="flex flex-col justify-between items-center p-4 w-[35%]"
        style={{
          background: `linear-gradient(135deg, ${primary_color}, ${secondary_color})`,
        }}
      >
        <div className="text-center">
          {logo_url && (
            <img
              src={`${SERVER_BASE_URL}${logo_url}`}
              className="rounded-full border-4 border-white shadow mb-2 object-cover w-20 h-20"
              alt="Logo"
            />
          )}
          <p className="font-bold uppercase text-xs tracking-wider opacity-90">
            {issuer_name}
          </p>
        </div>
        <div className="bg-white p-1.5 rounded shadow-lg">
          <QRCode
            value={`${window.location.origin}/verify/${verification_id}`}
            size={60}
          />
        </div>
      </div>
      <div className="flex-grow p-6 flex flex-col justify-center relative bg-white/95 w-[65%]">
        <h1
          className="font-light uppercase mb-2 text-xl tracking-widest"
          style={{ color: primary_color }}
        >
          {certificateTitle}
        </h1>
        <h2
          className="font-bold mb-2 text-3xl md:text-4xl"
          style={{
            fontFamily: "'Georgia', serif",
            ...textStyle,
          }}
        >
          {recipient_name}
        </h2>
        <p className="italic mb-2 text-base text-gray-600">{certificateBody}</p>
        <p
          className="font-bold uppercase mb-4 text-lg md:text-xl"
          style={{ color: secondary_color }}
        >
          {course_title}
        </p>
        <p style={{ ...textStyle, fontSize: "0.9rem" }}>
          Awarded on {issueDateFormatted}
        </p>
        <div
          className="flex justify-between mt-auto pt-3 border-t-2"
          style={{ borderColor: primary_color }}
        >
          <div>
            <p className="font-bold text-sm" style={textStyle}>
              {signature || issuer_name}
            </p>
            <p className="text-gray-500 text-xs uppercase">Signature</p>
          </div>
          <div className="text-right">
            <p className="font-bold text-sm" style={textStyle}>
              {issuer_name}
            </p>
            <p className="text-gray-500 text-xs uppercase">Issuer</p>
          </div>
        </div>
      </div>
    </div>
  );

  const renderReceipt = () => (
    <div
      className="h-full w-full bg-white relative flex flex-col shadow-xl overflow-hidden text-sm"
      style={{ fontFamily: "sans-serif" }}
    >
      <div className="p-8 h-full flex flex-col">
        <div className="flex justify-between items-start mb-6">
          <div>
            {logo_url ? (
              <img
                src={`${SERVER_BASE_URL}${logo_url}`}
                className="h-12 object-contain mb-2"
              />
            ) : (
              <h2
                className="text-xl font-bold"
                style={{ color: primary_color }}
              >
                {issuer_name}
              </h2>
            )}
          </div>
          <div className="text-right text-gray-500 text-xs">
            <p className="font-bold text-base text-gray-800">{issuer_name}</p>
            <p>Receipt</p>
            <p>{issueDateFormatted}</p>
          </div>
        </div>

        <div
          className="flex justify-between items-center p-3 rounded mb-6"
          style={{ background: primary_color, color: "white" }}
        >
          <span className="font-bold text-lg tracking-wider">
            {certificateTitle}
          </span>
          <span className="font-mono opacity-80">
            #{verification_id.substring(0, 8).toUpperCase()}
          </span>
        </div>

        <div className="flex justify-between mb-6">
          <div>
            <p className="text-xs font-bold text-gray-400 uppercase">Bill To</p>
            <p className="font-bold text-lg text-gray-800">{recipient_name}</p>
          </div>
          <div className="text-right">
            <p className="text-xs font-bold text-gray-400 uppercase">Status</p>
            <p className="font-bold text-green-600">PAID</p>
          </div>
        </div>

        <div className="border-b border-gray-200 mb-2">
          <div className="flex justify-between py-2 bg-gray-50 px-2 font-bold text-gray-500 text-xs uppercase">
            <span>Description</span>
            <span>Amount</span>
          </div>
          <div className="flex justify-between py-4 px-2">
            <span className="font-medium text-gray-800">{course_title}</span>
            <span className="font-bold" style={{ color: primary_color }}>
              {course_title.includes("$") || course_title.includes("₦")
                ? " "
                : "PAID"}
            </span>
          </div>
        </div>

        <div className="flex justify-end mt-4 mb-auto">
          <div className="w-1/2 flex justify-between border-t-2 border-gray-800 pt-2">
            <span className="font-bold text-lg">Total</span>
            <span
              className="font-bold text-lg"
              style={{ color: primary_color }}
            >
              {course_title.includes("$") ? course_title.split("$")[1] : " - "}
            </span>
          </div>
        </div>

        <div className="border-t border-gray-200 pt-4 mt-4 flex justify-between items-end">
          <div className="text-xs text-gray-400">
            <p>Auth Signature: {signature}</p>
            <p className="font-mono mt-1">ID: {verification_id}</p>
          </div>
          <QRCode
            value={`${window.location.origin}/verify/${verification_id}`}
            size={48}
          />
        </div>
      </div>
    </div>
  );

  if (layout_style === "receipt") return renderReceipt();
  return layout_style === "modern" ? renderModern() : renderClassic();
};

// --- MAIN PAGE COMPONENT ---
function ViewCertificatePage() {
  const { certId } = useParams();
  const navigate = useNavigate();
  const [certificate, setCertificate] = useState(null);
  const [template, setTemplate] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState("");
  const [downloading, setDownloading] = useState(false);
  const [showFullscreen, setShowFullscreen] = useState(false);

  useEffect(() => {
    const fetchCertificate = async () => {
      try {
        const response = await getCertificate(certId);
        const certData = response.data.certificate;
        const partialTemplate = response.data.template;

        setCertificate(certData);

        if (partialTemplate && partialTemplate.layout_style === "visual") {
          const templatesResponse = await getTemplates();
          const fullTemplate = templatesResponse.data.templates.find(
            (t) => t.id === partialTemplate.id
          );
          setTemplate(fullTemplate || partialTemplate);
        } else {
          setTemplate(partialTemplate);
        }
      } catch (err) {
        setError(
          err.response?.data?.msg || "Could not fetch certificate details."
        );
      } finally {
        setLoading(false);
      }
    };
    fetchCertificate();
  }, [certId]);

  const handleDownloadPDF = () => {
    setDownloading(true);
    const promise = getCertificatePDF(certId);
    toast.promise(promise, {
      loading: "Generating PDF...",
      success: (response) => {
        const url = window.URL.createObjectURL(new Blob([response.data]));
        const link = document.createElement("a");
        link.href = url;
        link.setAttribute(
          "download",
          `certificate_${certificate.verification_id}.pdf`
        );
        document.body.appendChild(link);
        link.click();
        link.parentNode.removeChild(link);
        window.URL.revokeObjectURL(url);
        return "Download started!";
      },
      error: (err) => err.response?.data?.msg || "Failed to download PDF.",
    });
    promise.finally(() => setDownloading(false));
  };

  const handleStatusChange = (status) => {
    const promise = updateCertificateStatus(certId, status);
    toast.promise(promise, {
      loading: `Updating status...`,
      success: () => {
        setCertificate((prev) => ({ ...prev, status }));
        return `Certificate ${
          status === "valid" ? "re-validated" : "revoked"
        }!`;
      },
      error: (err) => err.response?.data?.msg || "Failed to update status.",
    });
  };

  const InfoRow = ({ icon: Icon, label, value }) => (
    <div className="flex items-start gap-3 py-3 border-b border-gray-100 last:border-0">
      <div className="p-2 bg-indigo-50 text-indigo-600 rounded-lg shrink-0">
        <Icon size={18} />
      </div>
      <div>
        <p className="text-xs font-bold text-gray-400 uppercase tracking-wide mb-0.5">
          {label}
        </p>
        <p className="text-gray-900 font-medium text-sm break-all">{value}</p>
      </div>
    </div>
  );

  if (loading) {
    return (
      <div className="min-h-[60vh] flex items-center justify-center">
        <Spinner animation="border" variant="primary" />
      </div>
    );
  }

  if (error) {
    return (
      <div className="max-w-2xl mx-auto mt-8">
        <div className="bg-red-50 border border-red-200 rounded-lg p-6 text-center">
          <AlertCircle size={48} className="mx-auto text-red-500 mb-3" />
          <h3 className="text-lg font-bold text-red-700">
            Error Loading Certificate
          </h3>
          <p className="text-red-600 mb-4">{error}</p>
          <Button
            variant="outline-danger"
            onClick={() => navigate("/dashboard")}
          >
            Back to Dashboard
          </Button>
        </div>
      </div>
    );
  }

  const isValid = certificate.status === "valid";

  return (
    <ErrorBoundary>
      <Toaster position="top-right" />
      <div className="max-w-7xl mx-auto pb-12">
        {/* Header */}
        <div className="flex items-center gap-4 mb-8">
          <Link
            to="/dashboard"
            className="p-2 rounded-full hover:bg-gray-100 text-gray-500 transition-colors"
          >
            <ArrowLeft size={24} />
          </Link>
          <div className="flex-1">
            <div className="flex items-center gap-3">
              <h1 className="text-2xl font-bold text-gray-900">
                Certificate Details
              </h1>
              <span
                className={`px-2.5 py-0.5 rounded-full text-xs font-bold uppercase flex items-center gap-1 ${
                  isValid
                    ? "bg-green-100 text-green-700 border border-green-200"
                    : "bg-red-100 text-red-700 border border-red-200"
                }`}
              >
                {isValid ? (
                  <CheckCircle size={12} />
                ) : (
                  <AlertCircle size={12} />
                )}
                {certificate.status}
              </span>
            </div>
            <p className="text-gray-500 text-sm">
              Issued on {new Date(certificate.issue_date).toLocaleDateString()}
            </p>
          </div>

          <div className="flex gap-2">
            {isValid ? (
              <button
                onClick={() => handleStatusChange("revoked")}
                className="hidden sm:flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg border border-red-200 transition-colors text-sm font-medium"
              >
                <RefreshCw size={16} /> Revoke
              </button>
            ) : (
              <button
                onClick={() => handleStatusChange("valid")}
                className="hidden sm:flex items-center gap-2 px-4 py-2 text-green-600 hover:bg-green-50 rounded-lg border border-green-200 transition-colors text-sm font-medium"
              >
                <RefreshCw size={16} /> Re-validate
              </button>
            )}

            <button
              onClick={() => navigate(`/dashboard/edit/${certId}`)}
              className="flex items-center gap-2 px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg border border-gray-300 transition-colors text-sm font-medium"
            >
              <Edit3 size={16} /> Edit
            </button>

            <button
              onClick={handleDownloadPDF}
              disabled={downloading}
              className="flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white hover:bg-indigo-700 rounded-lg transition-colors text-sm font-medium shadow-sm disabled:opacity-70"
            >
              {downloading ? <Spinner size="sm" /> : <Download size={16} />}
              Download PDF
            </button>
          </div>
        </div>

        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
          {/* Left Column: Preview */}
          <div className="lg:col-span-2">
            <div className="bg-gray-100 rounded-xl border border-gray-200 p-6 flex flex-col items-center">
              <div
                className="w-full relative shadow-2xl rounded-lg overflow-hidden"
                style={{ aspectRatio: "1.414/1" }}
              >
                <CertificateDisplay
                  certificate={certificate}
                  template={template}
                />
              </div>

              <button
                onClick={() => setShowFullscreen(true)}
                className="mt-4 flex items-center gap-2 text-gray-500 hover:text-indigo-600 text-sm font-medium transition-colors"
              >
                <Maximize2 size={16} /> View Fullscreen
              </button>
            </div>
          </div>

          {/* Right Column: Details */}
          <div className="lg:col-span-1 space-y-6">
            {/* Metadata Card */}
            <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
              <h3 className="font-bold text-gray-900 mb-4 pb-2 border-b border-gray-100">
                Recipient Details
              </h3>
              <div className="space-y-1">
                <InfoRow
                  icon={User}
                  label="Recipient Name"
                  value={certificate.recipient_name}
                />
                <InfoRow
                  icon={Mail}
                  label="Email Address"
                  value={certificate.recipient_email || "N/A"}
                />
                <InfoRow
                  icon={Award}
                  label="Course / Event"
                  value={certificate.course_title}
                />
                <InfoRow
                  icon={Calendar}
                  label="Issue Date"
                  value={new Date(certificate.issue_date).toLocaleDateString()}
                />
                <InfoRow
                  icon={Shield}
                  label="Issued By"
                  value={certificate.issuer_name}
                />
              </div>
            </div>

            {/* Verification Card */}
            <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 text-center">
              <h3 className="font-bold text-gray-900 mb-4">Verification</h3>
              <div className="bg-white p-4 rounded-xl border-2 border-dashed border-gray-200 inline-block mb-4">
                <QRCode
                  value={`${window.location.origin}/verify/${certificate.verification_id}`}
                  size={140}
                />
              </div>
              <div className="bg-gray-50 rounded-lg p-3 mb-4">
                <p className="text-xs font-bold text-gray-400 uppercase mb-1">
                  Verification ID
                </p>
                <code className="text-sm font-mono text-indigo-600 select-all">
                  {certificate.verification_id}
                </code>
              </div>
              <a
                href={`${window.location.origin}/verify/${certificate.verification_id}`}
                target="_blank"
                rel="noopener noreferrer"
                className="flex items-center justify-center gap-2 w-full py-2.5 bg-indigo-50 text-indigo-700 hover:bg-indigo-100 rounded-lg font-medium transition-colors text-sm"
              >
                <Globe size={16} /> Open Public Verification Page
              </a>
            </div>
          </div>
        </div>

        {/* Fullscreen Modal */}
        <Modal
          show={showFullscreen}
          onHide={() => setShowFullscreen(false)}
          size="xl"
          centered
          dialogClassName="modal-fullscreen"
          contentClassName="bg-transparent border-0"
        >
          <div className="relative">
            <button
              onClick={() => setShowFullscreen(false)}
              className="absolute -top-12 right-0 text-white hover:text-gray-300 z-50 p-2"
            >
              <X size={32} />
            </button>
            <div
              className="shadow-2xl rounded-lg overflow-hidden"
              style={{ aspectRatio: "1.414/1" }}
            >
              <CertificateDisplay
                certificate={certificate}
                template={template}
              />
            </div>
          </div>
        </Modal>
      </div>
    </ErrorBoundary>
  );
}

export default ViewCertificatePage;



==================================================
FILE: store\editorStore.js
==================================================

// editorStore.js
import { create } from "zustand";
import { v4 as uuidv4 } from "uuid";
import { produce } from "immer";

const PAGE_SIZES = {
  A4: {
    landscape: { width: 842, height: 595 },
    portrait: { width: 595, height: 842 },
  },
  US_LETTER: {
    landscape: { width: 792, height: 612 },
    portrait: { width: 612, height: 792 },
  },
};

const useEditorStore = create((set, get) => ({
  templateTitle: "Untitled Template",
  elements: [],
  selectedIds: [],
  background: { fill: "#FFFFFF", image: null },
  canvas: { ...PAGE_SIZES.A4.landscape, size: "A4", orientation: "landscape" },
  clipboard: [],
  history: [],
  historyIndex: -1,

  // --- Core Actions ---
  setTemplateTitle: (title) => set({ templateTitle: title }),

  updateStateWithHistory: (newState) => {
    set(
      produce((state) => {
        const currentSnapshot = {
          elements: state.elements.map((el) => ({ ...el })), // deep copy
          background: { ...state.background },
          canvas: { ...state.canvas },
        };

        const newHistory = state.history.slice(0, state.historyIndex + 1);
        newHistory.push(currentSnapshot);

        state.history = newHistory;
        state.historyIndex = newHistory.length - 1;

        for (const key in newState) {
          state[key] = newState[key];
        }
      })
    );
  },

  setElements: (elements) => {
    get().updateStateWithHistory({ elements });
  },

  addElement: (type, props = {}) => {
    let newElement;
    const commonProps = {
      id: uuidv4(),
      x: 50,
      y: 50,
      rotation: 0,
      parentId: null,
      textDecoration: "none",
    };

    switch (type) {
      case "text":
        newElement = {
          ...commonProps,
          type: "text",
          text: "New Text",
          fontSize: 24,
          fontFamily: "Arial",
          fill: "#000000",
          width: 200,
          height: 30,
          fontStyle: "normal",
          align: "left",
          ...props,
        };
        break;
      case "image":
        newElement = {
          ...commonProps,
          type: "image",
          keepAspectRatio: true,
          ...props,
        };
        break;
      case "shape":
        newElement = {
          ...commonProps,
          type: "shape",
          shapeType: "rect",
          width: 100,
          height: 100,
          fill: "#cccccc",
          stroke: "#000000",
          strokeWidth: 1,
          cornerRadius: 0,
          ...props,
        };
        break;
      case "placeholder":
        newElement = {
          ...commonProps,
          type: "placeholder",
          text: props.text || "{{recipient_name}}",
          fontSize: 20,
          fontFamily: "Arial",
          fill: "#000000",
          width: 250,
          height: 25,
          ...props,
        };
        break;
      case "group":
        newElement = {
          ...commonProps,
          type: "group",
          scaleX: 1,
          scaleY: 1,
          childrenIds: [],
          ...props,
        };
        break;
      default:
        return;
    }
    get().updateStateWithHistory({
      elements: [...get().elements, newElement],
      selectedIds: [newElement.id],
    });
  },

  updateElement: (id, props) => {
    set(
      produce((state) => {
        const el = state.elements.find((e) => e.id === id);
        if (el) {
          Object.assign(el, props);
        }
      })
    );
  },

  updateSelectedElements: (propsUpdater) => {
    set(
      produce((state) => {
        state.selectedIds.forEach((id) => {
          const el = state.elements.find((e) => e.id === id);
          if (el) {
            const newProps =
              typeof propsUpdater === "function"
                ? propsUpdater(el)
                : propsUpdater;
            Object.assign(el, newProps);
          }
        });
      })
    );
  },

  commitUpdate: () => {
    get().updateStateWithHistory({ elements: get().elements });
  },

  deleteSelected: () => {
    const { selectedIds, elements } = get();
    if (selectedIds.length > 0) {
      const toDelete = new Set(selectedIds);
      selectedIds.forEach((id) => {
        const el = elements.find((e) => e.id === id);
        if (el && el.type === "group") {
          el.childrenIds.forEach((childId) => toDelete.add(childId));
        }
      });
      get().updateStateWithHistory({
        elements: elements.filter((el) => !toDelete.has(el.id)),
        selectedIds: [],
      });
    }
  },

  setSelectedIds: (ids) => set({ selectedIds: ids }),

  setCanvasConfig: (config) => {
    const currentCanvas = get().canvas;
    const newConfig = { ...currentCanvas, ...config };
    const newDimensions = PAGE_SIZES[newConfig.size][newConfig.orientation];
    get().updateStateWithHistory({
      canvas: { ...newConfig, ...newDimensions },
    });
  },

  setBackground: (props) => {
    get().updateStateWithHistory({
      background: { ...get().background, ...props },
    });
  },

  moveSelection: (direction) => {
    const { elements, selectedIds } = get();
    if (selectedIds.length !== 1) return;
    const selectedId = selectedIds[0];

    const index = elements.findIndex((e) => e.id === selectedId);
    if (index === -1) return;

    const newElements = [...elements];
    const [item] = newElements.splice(index, 1);

    if (direction === "up" && index < newElements.length)
      newElements.splice(index + 1, 0, item);
    else if (direction === "down" && index > 0)
      newElements.splice(index - 1, 0, item);
    else if (direction === "top") newElements.push(item);
    else if (direction === "bottom") newElements.unshift(item);

    get().updateStateWithHistory({ elements: newElements });
  },

  copySelection: () => {
    const { elements, selectedIds } = get();
    const copied = elements
      .filter((el) => selectedIds.includes(el.id))
      .map((el) => ({ ...el }));
    set({ clipboard: copied });
  },

  pasteFromClipboard: () => {
    const { clipboard } = get();
    if (clipboard.length === 0) return;

    const newElements = clipboard.map((el) => ({
      ...el,
      id: uuidv4(),
      x: el.x + 20,
      y: el.y + 20,
    }));

    const newIds = newElements.map((el) => el.id);
    get().updateStateWithHistory({
      elements: [...get().elements, ...newElements],
      selectedIds: newIds,
    });
  },

  duplicateSelection: () => {
    get().copySelection();
    get().pasteFromClipboard();
  },

  alignSelection: (edge) => {
    const { elements, selectedIds } = get();
    if (selectedIds.length < 2) return;

    const selected = elements.filter((el) => selectedIds.includes(el.id));

    let target;
    switch (edge) {
      case "left":
        target = Math.min(...selected.map((el) => el.x));
        break;
      case "right":
        target = Math.max(...selected.map((el) => el.x + el.width));
        break;
      case "h-center":
        const hCenterMin = Math.min(...selected.map((el) => el.x));
        const hCenterMax = Math.max(...selected.map((el) => el.x + el.width));
        target = (hCenterMin + hCenterMax) / 2;
        break;
      case "top":
        target = Math.min(...selected.map((el) => el.y));
        break;
      case "bottom":
        target = Math.max(...selected.map((el) => el.y + el.height));
        break;
      case "v-center":
        const vCenterMin = Math.min(...selected.map((el) => el.y));
        const vCenterMax = Math.max(...selected.map((el) => el.y + el.height));
        target = (vCenterMin + vCenterMax) / 2;
        break;
      default:
        return;
    }

    const newElements = elements.map((el) => {
      if (!selectedIds.includes(el.id)) return el;
      switch (edge) {
        case "left":
          return { ...el, x: target };
        case "right":
          return { ...el, x: target - el.width };
        case "h-center":
          return { ...el, x: target - el.width / 2 };
        case "top":
          return { ...el, y: target };
        case "bottom":
          return { ...el, y: target - el.height };
        case "v-center":
          return { ...el, y: target - el.height / 2 };
        default:
          return el;
      }
    });

    get().updateStateWithHistory({ elements: newElements });
  },

  distributeSelection: (direction) => {
    const { elements, selectedIds } = get();
    if (selectedIds.length < 3) return;

    const selected = elements.filter((el) => selectedIds.includes(el.id));

    let newElements = [...elements];
    if (direction === "horizontal") {
      const sorted = [...selected].sort((a, b) => a.x - b.x);
      const minX = sorted[0].x;
      const maxX =
        sorted[sorted.length - 1].x + sorted[sorted.length - 1].width;
      const itemWidths = sorted.reduce((sum, el) => sum + el.width, 0);
      const spacing = (maxX - minX - itemWidths) / (sorted.length - 1);
      let currentX = minX;
      sorted.forEach((el) => {
        const index = newElements.findIndex((e) => e.id === el.id);
        newElements[index].x = currentX;
        currentX += el.width + spacing;
      });
    } else if (direction === "vertical") {
      const sorted = [...selected].sort((a, b) => a.y - b.y);
      const minY = sorted[0].y;
      const maxY =
        sorted[sorted.length - 1].y + sorted[sorted.length - 1].height;
      const itemHeights = sorted.reduce((sum, el) => sum + el.height, 0);
      const spacing = (maxY - minY - itemHeights) / (sorted.length - 1);
      let currentY = minY;
      sorted.forEach((el) => {
        const index = newElements.findIndex((e) => e.id === el.id);
        newElements[index].y = currentY;
        currentY += el.height + spacing;
      });
    }

    get().updateStateWithHistory({ elements: newElements });
  },

  groupSelected: () => {
    const { elements, selectedIds } = get();
    if (selectedIds.length < 2) return;

    const selected = elements.filter(
      (el) => selectedIds.includes(el.id) && !el.parentId
    );

    const minX = Math.min(...selected.map((el) => el.x));
    const minY = Math.min(...selected.map((el) => el.y));

    const groupId = uuidv4();
    const group = {
      id: groupId,
      type: "group",
      x: minX,
      y: minY,
      rotation: 0,
      scaleX: 1,
      scaleY: 1,
      childrenIds: selected.map((el) => el.id),
    };

    const newElements = produce(elements, (draft) => {
      draft.push(group);
      selected.forEach((sel) => {
        const el = draft.find((e) => e.id === sel.id);
        el.parentId = groupId;
        el.x -= minX;
        el.y -= minY;
      });
    });

    get().updateStateWithHistory({
      elements: newElements,
      selectedIds: [groupId],
    });
  },

  ungroupSelected: () => {
    const { elements, selectedIds } = get();
    if (selectedIds.length !== 1) return;

    const groupId = selectedIds[0];
    const group = elements.find(
      (el) => el.id === groupId && el.type === "group"
    );
    if (!group) return;

    const angle = (group.rotation * Math.PI) / 180;
    const cos = Math.cos(angle);
    const sin = Math.sin(angle);
    const scaleX = group.scaleX;
    const scaleY = group.scaleY;

    const newElements = produce(elements, (draft) => {
      const groupIndex = draft.findIndex((el) => el.id === groupId);
      draft.splice(groupIndex, 1);

      group.childrenIds.forEach((childId) => {
        const child = draft.find((el) => el.id === childId);
        if (!child) return;

        const relX = child.x * scaleX;
        const relY = child.y * scaleY;
        const rotX = relX * cos - relY * sin;
        const rotY = relX * sin + relY * cos;

        child.x = group.x + rotX;
        child.y = group.y + rotY;
        child.rotation = (child.rotation || 0) + group.rotation;
        child.width *= scaleX;
        child.height *= scaleY;

        if (child.type === "text" || child.type === "placeholder") {
          child.fontSize *= (scaleX + scaleY) / 2;
        }
        if (child.type === "shape") {
          child.strokeWidth *= (scaleX + scaleY) / 2;
        }

        child.parentId = null;
      });
    });

    get().updateStateWithHistory({
      elements: newElements,
      selectedIds: group.childrenIds,
    });
  },

  toggleBold: () => {
    get().updateSelectedElements((el) => {
      let style = el.fontStyle || "";
      style = style.includes("bold")
        ? style.replace(/\bbold\b/g, "").trim()
        : `${style} bold`.trim();
      return { fontStyle: style };
    });
    get().commitUpdate();
  },

  toggleItalic: () => {
    get().updateSelectedElements((el) => {
      let style = el.fontStyle || "";
      style = style.includes("italic")
        ? style.replace(/\bitalic\b/g, "").trim()
        : `${style} italic`.trim();
      return { fontStyle: style };
    });
    get().commitUpdate();
  },

  toggleUnderline: () => {
    get().updateSelectedElements((el) => ({
      textDecoration: el.textDecoration === "underline" ? "none" : "underline",
    }));
    get().commitUpdate();
  },

  addCombination: (type) => {
    const { elements } = get();
    if (type === "signature") {
      const sigId = uuidv4();
      const nameId = uuidv4();
      const posX = 50;
      const posY = 50;

      const sig = {
        id: sigId,
        type: "placeholder",
        text: "{{signature}}",
        fontFamily: "Dancing Script",
        fontSize: 32,
        fill: "#000000",
        x: posX,
        y: posY,
        width: 200,
        height: 40,
        align: "left",
        fontStyle: "normal",
        textDecoration: "none",
        parentId: null,
      };

      const name = {
        id: nameId,
        type: "text",
        text: "Name, Title",
        fontSize: 16,
        fontFamily: "Arial",
        fill: "#000000",
        x: posX,
        y: posY + 40,
        width: 200,
        height: 20,
        align: "left",
        fontStyle: "normal",
        textDecoration: "none",
        parentId: null,
      };

      get().updateStateWithHistory({
        elements: [...elements, sig, name],
        selectedIds: [sigId, nameId],
      });
    }
  },

  undo: () => {
    set(
      produce((state) => {
        if (state.historyIndex > 0) {
          const newIndex = state.historyIndex - 1;
          const prev = state.history[newIndex];
          state.elements = prev.elements;
          state.background = prev.background;
          state.canvas = prev.canvas;
          state.historyIndex = newIndex;
        }
      })
    );
  },

  redo: () => {
    set(
      produce((state) => {
        if (state.historyIndex < state.history.length - 1) {
          const newIndex = state.historyIndex + 1;
          const next = state.history[newIndex];
          state.elements = next.elements;
          state.background = next.background;
          state.canvas = next.canvas;
          state.historyIndex = newIndex;
        }
      })
    );
  },

  getFlattenedElements: () => {
    const { elements } = get();
    const flat = [];

    elements.forEach((el) => {
      if (el.parentId) return;
      if (el.type === "group") {
        const angle = (el.rotation * Math.PI) / 180;
        const cos = Math.cos(angle);
        const sin = Math.sin(angle);
        const scaleX = el.scaleX || 1;
        const scaleY = el.scaleY || 1;

        el.childrenIds.forEach((childId) => {
          const child = elements.find((c) => c.id === childId);
          if (!child) return;

          const relX = child.x * scaleX;
          const relY = child.y * scaleY;
          const rotX = relX * cos - relY * sin;
          const rotY = relX * sin + relY * cos;

          const absChild = {
            ...child,
            x: el.x + rotX,
            y: el.y + rotY,
            rotation: (child.rotation || 0) + el.rotation,
            width: child.width * scaleX,
            height: child.height * scaleY,
          };

          if (child.type === "text" || child.type === "placeholder") {
            absChild.fontSize = child.fontSize * ((scaleX + scaleY) / 2);
          }
          if (child.type === "shape") {
            absChild.strokeWidth = child.strokeWidth * ((scaleX + scaleY) / 2);
          }

          delete absChild.parentId;
          flat.push(absChild);
        });
      } else {
        flat.push({ ...el });
      }
    });

    return flat;
  },

  loadTemplate: (data) => {
    const canvasConfig = data.layout_data?.canvas || {
      ...PAGE_SIZES.A4.landscape,
      size: "A4",
      orientation: "landscape",
    };
    let elementsData = data.layout_data?.elements || [];
    elementsData = elementsData.map((el) => ({ ...el, parentId: null })); // ensure flat
    const backgroundData = data.layout_data?.background || {
      fill: "#FFFFFF",
      image: null,
    };

    const initialState = {
      templateTitle: data.title,
      elements: elementsData,
      background: backgroundData,
      canvas: canvasConfig,
      selectedIds: [],
      clipboard: [],
      history: [
        {
          elements: elementsData,
          background: backgroundData,
          canvas: canvasConfig,
        },
      ],
      historyIndex: 0,
    };
    set(initialState);
  },
}));

export default useEditorStore;



==================================================
FILE: styles\Admin.css
==================================================




==================================================
FILE: styles\App.css
==================================================

:root {
  --primary-blue: #2563eb;
  --accent-green: #22c55e;
  --text-slate: #1e293b;
  --text-slate-light: #64748b;
  --sidebar-bg: #ffffff;
  --workspace-bg: #f8f9fc;
  --sidebar-text: #475569;
  --sidebar-text-active: var(--primary-blue);
  --border-color: #e5e7eb;
}

body {
  margin: 0;
  font-family: "Inter", sans-serif;
  background-color: var(--workspace-bg);
  color: var(--text-slate);
  overflow-x: hidden;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  font-family: "Poppins", sans-serif;
  font-weight: 700;
  color: var(--text-slate);
}

/* --- DASHBOARD-SPECIFIC LAYOUT --- */
.dashboard-layout {
  display: flex;
  min-height: 100vh;
}

/* --- SIDEBAR STYLES (DESKTOP) --- */
.sidebar {
  width: 260px;
  background-color: var(--sidebar-bg);
  padding: 1.5rem 1rem;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  flex-shrink: 0;
  border-right: 1px solid var(--border-color);
  position: fixed;
  height: 100vh;
  z-index: 1020;
}

.sidebar-logo {
  font-family: "Poppins", sans-serif;
  font-weight: 700;
  font-size: 1.5rem;
  color: var(--text-slate);
  margin-bottom: 3rem;
  text-decoration: none;
  padding-left: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.sidebar-logo .green {
  color: var(--accent-green);
}

.sidebar-logo .blue {
  color: var(--primary-blue);
}

.sidebar .nav-link {
  color: var(--sidebar-text);
  font-weight: 500;
  padding: 0.75rem 1rem;
  border-radius: 0.75rem;
  display: flex;
  align-items: center;
  gap: 1rem;
  transition: all 0.2s ease-in-out;
  margin-bottom: 0.25rem;
}

.sidebar .nav-link:hover {
  color: var(--primary-blue);
  background-color: #f3f4f6;
}

.sidebar .nav-link.active {
  background-color: rgba(37, 99, 235, 0.1);
  color: var(--sidebar-text-active);
  font-weight: 600;
}

.sidebar .nav-link svg {
  width: 22px;
  height: 22px;
}

/* --- MAIN CONTENT --- */
.main-content {
  flex-grow: 1;
  margin-left: 260px; /* Space for the desktop sidebar */
  transition: margin-left 0.3s ease;
}

.workspace {
  padding: 2.5rem;
}

/* --- DASHBOARD COMPONENT STYLES --- */
.page-content-card {
  background-color: white;
  padding: 2rem;
  border-radius: 1.5rem;
  border: 1px solid var(--border-color);
  box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
}

.custom-form-control {
  border-radius: 0.75rem !important;
  padding: 0.9rem 1rem !important;
  border: 1px solid var(--border-color) !important;
  background-color: var(--background-white) !important;
}

.custom-form-control:focus {
  border-color: var(--primary-blue) !important;
  box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.2) !important;
}

/* --- MOBILE RESPONSIVENESS (<= 768px) --- */
@media (max-width: 768px) {
  /* Hide the desktop sidebar */
  .sidebar {
    display: none;
  }

  /* Main content takes up full width */
  .main-content {
    margin-left: 0;
  }

  /* Adjust padding for content and bottom nav */
  .workspace {
    padding: 1.5rem 1rem 100px 1rem; /* Added 100px bottom padding */
  }

  .page-content-card {
    padding: 1.5rem;
  }

  /* General responsive adjustments */
  .table-responsive {
    font-size: 0.875rem;
  }
  .btn {
    padding: 0.5rem 1rem !important;
    font-size: 0.9rem;
  }
}

@media (max-width: 480px) {
  .workspace {
    padding: 1rem 0.75rem 100px 0.75rem;
  }
  .page-content-card {
    padding: 1rem;
  }
  h1 {
    font-size: 1.75rem;
  }
  h2 {
    font-size: 1.5rem;
  }
}



==================================================
FILE: styles\Auth.css
==================================================

/* frontend/src/styles/Auth.css */
.auth-container {
  min-height: 100vh;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #f8f9fc;
}

.auth-wrapper {
  display: grid;
  grid-template-columns: 4fr 5fr;
  max-width: 960px;
  width: 100%;
  margin: 2rem;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
  border-radius: 1.5rem;
  overflow: hidden;
  animation: fadeIn 0.5s ease-in-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.auth-panel {
  padding: 3rem 2.5rem;
  color: white;
  background-color: #111827;
  background-image: radial-gradient(
      circle at 10% 20%,
      rgba(59, 130, 246, 0.3),
      transparent 40%
    ),
    radial-gradient(circle at 90% 80%, rgba(20, 184, 166, 0.2), transparent 40%);
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.auth-panel h2 {
  font-size: 2.25rem;
  font-weight: 700;
  color: white;
  line-height: 1.2;
  margin-bottom: 1rem;
}

.auth-panel p {
  font-size: 1.1rem;
  color: rgba(255, 255, 255, 0.8);
}

.auth-form-container {
  padding: 3rem 2.5rem;
  background-color: #ffffff;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.auth-logo {
  max-height: 35px;
  margin-bottom: 2rem;
  align-self: flex-start;
}

.auth-form-container h3 {
  font-weight: 700;
  color: #1e293b;
  margin-bottom: 2rem;
  font-size: 1.75rem;
}

.auth-form-container .form-label {
  font-weight: 500;
  color: #475569;
}

.auth-form-container .form-control {
  background-color: #f8f9fc;
  border: 1px solid #e5e7eb;
  border-radius: 0.75rem !important;
  padding: 0.9rem 1rem !important;
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.auth-form-container .form-control:focus {
  border-color: #2563eb !important;
  box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.2) !important;
  background-color: white;
}

.btn-auth {
  background-color: #2563eb;
  border: none;
  color: white;
  font-weight: 600;
  padding: 0.9rem;
  border-radius: 0.75rem;
  transition: all 0.3s ease;
  font-size: 1rem;
}

.btn-auth:hover {
  background-color: #1e40af;
  transform: translateY(-2px);
  box-shadow: 0 4px 10px rgba(37, 99, 235, 0.2);
}

.auth-switch-link {
  color: #2563eb;
  font-weight: 500;
  text-decoration: none;
}

.auth-switch-link:hover {
  text-decoration: underline;
}

/* Password toggle button */
.password-toggle-btn {
  position: absolute;
  right: 1rem;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  cursor: pointer;
  color: #64748b;
  padding: 0.5rem;
  display: flex;
  align-items: center;
  justify-content: center;
}

.auth-form-container .form-control.password-input {
  padding-right: 3rem !important;
}

/* Custom Radio Toggle for Signup Page */
.account-type-toggle {
  display: grid;
  grid-template-columns: 1fr 1fr;
  border: 1px solid #e5e7eb;
  border-radius: 0.75rem;
  overflow: hidden;
}

.account-type-toggle input[type="radio"] {
  display: none;
}

.account-type-toggle label {
  text-align: center;
  padding: 0.75rem;
  font-weight: 500;
  color: #475569;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  background-color: #f8f9fc;
}

.account-type-toggle input[type="radio"]:checked + label {
  background-color: #2563eb;
  color: white;
  font-weight: 600;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .auth-wrapper {
    grid-template-columns: 1fr;
    max-width: 480px;
  }
  .auth-panel {
    display: none;
  }
  .auth-form-container {
    padding: 2rem 1.5rem;
  }
  .auth-logo {
    max-height: 30px;
    margin-bottom: 1.5rem;
  }
}

.custom-alert {
  display: flex;
  align-items: center;
  padding: 0.8rem 1rem;
  margin-bottom: 1.25rem;
  border-radius: 0.5rem; /* 8px */
  font-size: 0.9rem;
  border: 1px solid transparent;
  font-weight: 500;
}

.custom-alert .alert-icon {
  margin-right: 0.75rem;
  flex-shrink: 0; /* Prevents icon from shrinking */
}

.custom-alert-danger {
  background-color: #fef2f2;
  border-color: #fecaca;
  color: #b91c1c;
}

.custom-alert-success {
  background-color: #f0fdf4;
  border-color: #bbf7d0;
  color: #166534;
}

.custom-alert-warning {
  background-color: #fffbeb;
  border-color: #fde68a;
  color: #92400e;
}

/* Specific styling for the resend link inside the warning alert */
.custom-alert-warning .resend-link {
  font-weight: 600;
  color: #92400e;
  text-decoration: none;
  margin-left: auto; /* Pushes it to the far right */
  padding-left: 1rem;
  background: none;
  border: none;
}

.custom-alert-warning .resend-link:hover {
  text-decoration: underline;
}

.custom-alert {
  display: flex;
  align-items: center;
  padding: 0.8rem 1rem;
  margin-bottom: 1.25rem;
  border-radius: 0.5rem; /* 8px */
  font-size: 0.9rem;
  border: 1px solid transparent;
  font-weight: 500;
}

.custom-alert .alert-icon {
  margin-right: 0.75rem;
  flex-shrink: 0; /* Prevents icon from shrinking */
}

.custom-alert-danger {
  background-color: #fef2f2;
  border-color: #fecaca;
  color: #b91c1c;
}

.custom-alert-success {
  background-color: #f0fdf4;
  border-color: #bbf7d0;
  color: #166534;
}

.custom-alert-warning {
  background-color: #fffbeb;
  border-color: #fde68a;
  color: #92400e;
}

/* --- NEW STYLES FOR VERIFICATION PROMPT --- */
.verification-prompt {
  align-items: flex-start; /* Aligns icon to the top of the content box */
  padding: 1rem;
}

.verification-prompt .alert-content {
  flex-grow: 1;
  margin-left: 0.25rem; /* Reduced margin slightly */
}

.verification-prompt .alert-title {
  font-weight: 600;
  display: block;
  font-size: 0.95rem;
  color: #78350f; /* Darker text for title */
}

.verification-prompt .alert-message {
  margin: 0.25rem 0 0.75rem 0;
  font-size: 0.875rem;
  color: #92400e;
}

.verification-prompt .alert-actions {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 0.5rem;
}

.verification-prompt .resend-link {
  padding: 0;
  font-weight: 500;
  font-size: 0.875rem;
  color: #92400e;
  text-decoration: none;
  border: none;
  background: none;
}

.verification-prompt .resend-link:hover {
  text-decoration: underline;
}

.verification-prompt .verify-action-btn {
  font-weight: 600;
  font-size: 0.875rem;
  padding: 0.4rem 0.8rem;
  border-radius: 6px;
  background-color: #f59e0b; /* A bright, actionable yellow/orange */
  color: #422006;
  text-decoration: none;
  border: 1px solid #d97706;
  transition: all 0.2s ease-in-out;
}

.verification-prompt .verify-action-btn:hover {
  background-color: #d97706;
  color: white;
  text-decoration: none;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}



==================================================
FILE: styles\BottomNav.css
==================================================

/* src/styles/BottomNav.css */
.bottom-nav {
  position: fixed;
  bottom: 1rem;
  left: 50%;
  transform: translateX(-50%);
  width: calc(100% - 2rem);
  max-width: 500px;
  height: 65px;
  background-color: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border-radius: 20px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  display: flex;
  justify-content: space-around;
  align-items: center;
  z-index: 1010;
  border: 1px solid rgba(229, 231, 235, 0.8);
}

.bottom-nav-link {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  color: #6b7280; /* Gray-500 */
  text-decoration: none;
  font-size: 0.7rem;
  font-weight: 500;
  transition: color 0.2s ease, transform 0.2s ease;
  flex-grow: 1;
  height: 100%;
}

.bottom-nav-link:hover {
  color: #1d4ed8; /* Blue-700 */
}

.bottom-nav-link.active {
  color: #2563eb; /* Blue-600 */
  font-weight: 600;
}

.bottom-nav-create-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 60px;
  height: 60px;
  background: linear-gradient(145deg, #3b82f6, #2563eb);
  color: white;
  border-radius: 50%;
  border: 4px solid white;
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
  transform: translateY(-20px);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  cursor: pointer;
}

.bottom-nav-create-btn:hover {
  transform: translateY(-22px) scale(1.05);
  box-shadow: 0 6px 16px rgba(59, 130, 246, 0.5);
}

/* --- NEW STYLES FOR CREATE OPTIONS MODAL --- */
.create-options-overlay {
  position: fixed;
  inset: 0;
  background-color: rgba(0, 0, 0, 0.4);
  z-index: 1011;
  -webkit-backdrop-filter: blur(2px);
  backdrop-filter: blur(2px);
}

.create-options-modal {
  position: fixed;
  bottom: 100px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 1012;
  background-color: white;
  border-radius: 16px;
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
  padding: 1rem;
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  width: 90%;
  max-width: 300px;
  animation: slide-up 0.3s ease-out;
}

@keyframes slide-up {
  from {
    transform: translate(-50%, 20px);
    opacity: 0;
  }
  to {
    transform: translate(-50%, 0);
    opacity: 1;
  }
}

.create-option-link {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 0.75rem;
  text-decoration: none;
  color: #374151; /* Gray-700 */
  border-radius: 12px;
  transition: background-color 0.2s ease;
}

.create-option-link:hover {
  background-color: #f3f4f6; /* Gray-100 */
}

.create-option-icon {
  color: #2563eb; /* Blue-600 */
  flex-shrink: 0;
}

.create-option-text {
  display: flex;
  flex-direction: column;
}

.create-option-text strong {
  font-weight: 600;
  color: #111827; /* Gray-900 */
}

.create-option-text small {
  font-size: 0.8rem;
  color: #6b7280; /* Gray-500 */
}



==================================================
FILE: styles\CreateCertificatePage.css
==================================================

/* frontend/src/styles/CreateCertificatePage.css */
.create-certificate-page {
  padding: 20px;
  max-width: 1400px;
  margin: 0 auto;
}

.form-section {
  background: white;
  border-radius: 12px;
  padding: 30px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  transition: box-shadow 0.3s ease;
}

.form-section:hover {
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
}

.preview-section {
  background: #f8f9fa;
  border-radius: 12px;
  padding: 30px;
  height: fit-content;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.publish-btn {
  background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
  border: none;
  padding: 12px 30px;
  font-weight: 600;
  border-radius: 8px;
  transition: transform 0.2s, box-shadow 0.2s;
}

.publish-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.publish-btn:disabled {
  background: #6c757d;
  cursor: not-allowed;
}

.form-control,
.form-select {
  border-radius: 8px;
  padding: 10px;
  font-size: 1rem;
}

.form-label {
  font-weight: 500;
  color: #333;
}

.alert.rounded-8 {
  border-radius: 8px;
}



==================================================
FILE: styles\Dashboard.css
==================================================

:root {
  --primary-blue: #2563eb;
  --text-slate: #1e293b;
  --text-slate-light: #64748b;
  --sidebar-bg: #ffffff;
  --workspace-bg: #f8f9fc;
  --sidebar-text: #475569;
  --sidebar-text-active: var(--primary-blue);
  --border-color: #e5e7eb;
}

body {
  margin: 0;
}
h1,
h2,
h3,
h4,
h5,
h6 {
  font-family: "Poppins", sans-serif;
  font-weight: 700;
  color: var(--text-slate);
}

/* --- THE NEW, STABLE, FULL-WIDTH SIDEBAR --- */
.dashboard-layout {
  display: flex;
  min-height: 100vh;
  background-color: var(--workspace-bg);
}
.sidebar {
  width: 260px; /* PERMANENT full width */
  background-color: var(--sidebar-bg);
  padding: 1.5rem 1rem;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  flex-shrink: 0;
  border-right: 1px solid var(--border-color);
  position: fixed; /* Decouples sidebar from page scroll */
  height: 100vh;
  z-index: 1020;
}

.sidebar-logo {
  font-family: "Poppins", sans-serif;
  font-weight: 700;
  font-size: 1.5rem;
  color: var(--text-slate);
  margin-bottom: 3rem;
  text-decoration: none;
  padding-left: 0.5rem;
  display: flex;
  align-items: center;
}
.sidebar-logo .green {
  color: #22c55e;
}
.sidebar-logo .blue {
  color: var(--primary-blue);
}

.sidebar .nav-link {
  color: var(--sidebar-text);
  font-weight: 500;
  padding: 0.75rem 1rem;
  border-radius: 0.75rem;
  display: flex;
  align-items: center;
  gap: 1rem; /* Added gap for icon and text */
  transition: all 0.2s ease-in-out;
  white-space: nowrap;
  overflow: hidden;
}

.sidebar .nav-link:hover {
  color: var(--primary-blue);
  background-color: #f3f4f6;
}
.sidebar .nav-link.active {
  background-color: rgba(37, 99, 235, 0.1);
  color: var(--sidebar-text-active);
  font-weight: 600;
}

/* --- MAIN CONTENT AREA --- */
.main-content {
  flex-grow: 1;
  margin-left: 260px; /* PERMANENT margin to match sidebar width */
}
.dashboard-nav {
  background-color: var(--workspace-bg);
  border-bottom: 1px solid var(--border-color);
  position: sticky;
  top: 0;
  z-index: 1000;
}
.workspace {
  padding: 2rem;
}

/* --- ALL OTHER STYLES (UNCHANGED BUT INCLUDED FOR COMPLETENESS) --- */
.content-card {
  background-color: white;
  padding: 2rem;
  border-radius: 1.5rem;
  border: 1px solid var(--border-color);
  box-shadow: 0 8px 24px rgba(20, 29, 54, 0.05);
}
.stat-card {
  background-color: white;
  border: none;
  border-radius: 1.5rem;
  padding: 1.5rem;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  box-shadow: 0 8px 24px rgba(20, 29, 54, 0.05);
}
.stat-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 12px 28px rgba(20, 29, 54, 0.1);
}
.stat-card-icon {
  width: 48px;
  height: 48px;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 1rem;
}
.stat-card-icon.blue {
  background-color: rgba(37, 99, 235, 0.1);
  color: var(--primary-blue);
}
.stat-card-icon.green {
  background-color: rgba(34, 197, 94, 0.1);
  color: var(--accent-green);
}
.stat-card-icon.gold {
  background-color: rgba(250, 204, 21, 0.1);
  color: var(--secondary-gold);
}

.empty-state-card {
  border-style: dashed;
  border-width: 2px;
  border-color: #cbd5e1;
  background-color: #fdfdff;
  padding: 4rem;
  text-align: center;
  border-radius: 1.5rem;
}

.custom-form-control {
  border-radius: 0.75rem !important;
  padding: 0.9rem 1rem !important;
  border: 1px solid var(--border-color) !important;
  background-color: var(--workspace-bg) !important;
  font-weight: 500;
}
.custom-form-control:focus {
  border-color: var(--primary-blue) !important;
  box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.2) !important;
  background-color: white !important;
}



==================================================
FILE: styles\DocsPage.css
==================================================

.docs-page-wrapper {
  background-color: #ffffff;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}

.docs-page-wrapper .docs-container {
  display: flex;
  max-width: 1400px;
  margin: 0 auto;
  flex-grow: 1; /* Make the container fill available space */
  width: 100%;
}

.docs-page-wrapper .docs-sidebar {
  width: 280px;
  flex-shrink: 0;
  padding: 2rem 1rem;
  position: sticky;
  /* Adjust top position to account for the height of the new fixed header */
  top: 80px;
  height: calc(100vh - 80px);
  overflow-y: auto;
  border-right: 1px solid #e2e8f0;
}

.docs-page-wrapper .docs-sidebar nav ul {
  list-style: none;
  padding: 0;
}

.docs-page-wrapper .docs-sidebar nav a {
  display: block;
  padding: 0.5rem 1rem;
  color: #475569;
  text-decoration: none;
  border-radius: 0.375rem;
  font-weight: 500;
}

.docs-page-wrapper .docs-sidebar nav a:hover {
  background-color: #f1f5f9;
  color: #1e293b;
}

.docs-page-wrapper .docs-content {
  flex-grow: 1;
  /* --- FIX: Add space for the fixed header (~80px) plus original padding --- */
  padding: calc(80px + 2.5rem) 3rem 2.5rem;
  line-height: 1.7;
}

.docs-page-wrapper .docs-content section {
  margin-bottom: 4rem;
  scroll-margin-top: 90px; /* Adjust for better anchor linking */
}

.docs-page-wrapper .docs-content h1 {
  font-size: 2.5rem;
  font-weight: 800;
  color: #111827;
  border-bottom: 1px solid #e2e8f0;
  padding-bottom: 0.5rem;
  margin-bottom: 1rem;
}

.docs-page-wrapper .docs-content h2 {
  font-size: 1.875rem;
  font-weight: 700;
  color: #1e293b;
  margin-top: 2rem;
  margin-bottom: 1rem;
}

.docs-page-wrapper .docs-content h3 {
  font-size: 1.25rem;
  font-weight: 600;
  color: #334155;
  margin-top: 1.5rem;
  margin-bottom: 0.75rem;
}

.docs-page-wrapper .docs-content p,
.docs-page-wrapper .docs-content li {
  color: #334155;
  font-size: 1rem;
}

.docs-page-wrapper .docs-content code {
  background-color: #f1f5f9;
  color: #dd1144;
  padding: 0.2em 0.4em;
  margin: 0;
  font-size: 85%;
  border-radius: 6px;
  font-family: "Courier New", Courier, monospace;
}

/* Custom List */
.docs-page-wrapper .docs-list {
  list-style-type: decimal;
  padding-left: 2rem;
}
.docs-page-wrapper .docs-list li {
  margin-bottom: 0.75rem;
}

/* Custom Alert Box */
.docs-page-wrapper .docs-alert {
  background-color: #fefce8;
  border-left: 4px solid #facc15;
  padding: 1rem;
  margin: 1.5rem 0;
  border-radius: 0 0.375rem 0.375rem 0;
}
.docs-page-wrapper .docs-alert strong {
  color: #ca8a04;
}

/* Endpoint Display */
.docs-page-wrapper .endpoint-details {
  display: flex;
  align-items: center;
  gap: 1rem;
  background-color: #f8fafc;
  border: 1px solid #e2e8f0;
  padding: 0.75rem 1rem;
  border-radius: 0.375rem;
  margin-top: 1rem;
}
.docs-page-wrapper .method-post {
  background-color: #22c55e;
  color: white;
  padding: 0.25rem 0.75rem;
  border-radius: 9999px;
  font-weight: 700;
  font-size: 0.875rem;
}
.docs-page-wrapper .endpoint-url {
  font-family: "Courier New", Courier, monospace;
  font-weight: 600;
  color: #0f172a;
}

/* Table Styling */
.docs-page-wrapper .docs-table {
  width: 100%;
  margin-top: 1.5rem;
  border-collapse: collapse;
  font-size: 0.9rem;
}
.docs-page-wrapper .docs-table th,
.docs-page-wrapper .docs-table td {
  border: 1px solid #e2e8f0;
  padding: 0.75rem 1rem;
  text-align: left;
}
.docs-page-wrapper .docs-table th {
  background-color: #f8fafc;
  font-weight: 600;
}
.docs-page-wrapper .docs-table code {
  font-size: 95%;
}

/* Code Block Component Styling */
.docs-page-wrapper .code-block-container {
  position: relative;
  background-color: #1e293b;
  color: #e2e8f0;
  border-radius: 0.5rem;
  margin: 1rem 0;
  font-family: "Courier New", Courier, monospace;
}

.docs-page-wrapper .code-block-container pre {
  padding: 1.5rem;
  overflow-x: auto;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.docs-page-wrapper .code-block-container code {
  background-color: transparent;
  color: inherit;
  padding: 0;
  font-size: 0.875rem;
}

.docs-page-wrapper .code-block-copy-button {
  position: absolute;
  top: 0.75rem;
  right: 0.75rem;
  background-color: #334155;
  border: none;
  color: #94a3b8;
  padding: 0.5rem;
  border-radius: 0.375rem;
  cursor: pointer;
  transition: background-color 0.2s;
}

.docs-page-wrapper .code-block-copy-button:hover {
  background-color: #475569;
  color: #e2e8f0;
}

.docs-page-wrapper .code-block-language {
  position: absolute;
  top: 0.75rem;
  left: 1rem;
  color: #94a3b8;
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
}

@media (max-width: 992px) {
  .docs-page-wrapper .docs-sidebar {
    position: fixed;
    top: 0;
    left: 0;
    height: 100%;
    width: 280px;
    background-color: #ffffff;
    z-index: 2000;
    transform: translateX(-100%); /* Hidden by default */
    transition: transform 0.3s ease-in-out;
    border-right: 1px solid #e2e8f0;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
  }

  .docs-page-wrapper .docs-sidebar.mobile-open {
    transform: translateX(0); /* Slides in when open */
  }

  .docs-page-wrapper .docs-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 1999;
  }

  .docs-page-wrapper .docs-container {
    flex-direction: column;
  }

  .docs-page-wrapper .docs-content {
    /* --- FIX: Adjust mobile padding for the fixed header too --- */
    padding: calc(80px + 1.5rem) 1.5rem 1.5rem;
  }

  .docs-page-wrapper .docs-content h1 {
    font-size: 2rem;
  }

  .docs-page-wrapper .docs-content h2 {
    font-size: 1.5rem;
  }
}



==================================================
FILE: styles\HelpCenter.css
==================================================

/* --- HUB PAGE CARD STYLING --- */
.help-topic-card {
  border: none;
  border-radius: 0.75rem;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
  transition: all 0.3s ease-in-out;
  background-color: #fff;
}

.help-topic-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
}

.help-topic-card .card-title {
  color: #212529; /* Dark text for title */
}

/* --- ICON WRAPPER STYLING --- */
.icon-wrapper {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 1.25rem auto; /* Center the icon */
  transition: background-color 0.3s ease;
}

/* Soft background colors for each theme */
.bg-primary-soft {
  background-color: rgba(13, 110, 253, 0.1);
}
.bg-success-soft {
  background-color: rgba(25, 135, 84, 0.1);
}
.bg-info-soft {
  background-color: rgba(13, 202, 240, 0.1);
}
.bg-warning-soft {
  background-color: rgba(255, 193, 7, 0.1);
}
.bg-danger-soft {
  background-color: rgba(220, 53, 69, 0.1);
}
.bg-secondary-soft {
  background-color: rgba(108, 117, 125, 0.1);
}
.bg-dark-soft {
  background-color: rgba(33, 37, 41, 0.1);
}
.bg-purple-soft {
  background-color: rgba(111, 66, 193, 0.1);
} /* Custom purple */

/* --- ARTICLE PAGE CONTENT STYLING --- */
.article-content h2 {
  font-weight: 700;
  margin-top: 2rem;
  margin-bottom: 1rem;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid #e9ecef;
}

.article-content p,
.article-content li {
  font-size: 1.1rem;
  line-height: 1.7;
  color: #495057;
}

.article-content ol,
.article-content ul {
  padding-left: 20px;
  margin-bottom: 1.5rem;
}

.article-content li {
  margin-bottom: 0.75rem;
}

/* Style for code snippets and technical terms */
.article-content code {
  background-color: #e9ecef;
  padding: 0.2em 0.4em;
  margin: 0;
  font-size: 85%;
  border-radius: 6px;
  font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier,
    monospace;
  color: #d63384; /* A nice pink/magenta for code */
}

/* Style for important UI elements or actions */
.article-content strong {
  color: #0d6efd; /* Bootstrap primary blue */
}



==================================================
FILE: styles\LandingPage.css
==================================================

@import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap");

:root {
  --bg-color: #f8fafc;
  --primary-blue: #2563eb;
  --text-dark: #1e293b;
  --text-light: #64748b;
  --border-color: #e5e7eb;
  --card-bg: #ffffff;
  --section-bg: #ffffff;
}

/* ===== BASE & LAYOUT ===== */
.chrono-body {
  font-family: "Inter", sans-serif;
  background-color: var(--bg-color);
  color: var(--text-dark);
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  width: 100vw;
  overflow-x: hidden;
}

/* ===== HEADER / NAVIGATION ===== */
.chrono-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  padding: 16px 32px;
  box-sizing: border-box;
  position: fixed;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  z-index: 1000;
  background-color: rgba(255, 255, 255, 0.8);
  backdrop-filter: blur(8px);
  border-bottom: 1px solid var(--border-color);
  border-radius: 0 0 1rem 1rem;
}
.nav-left {
  display: flex;
  align-items: center;
  gap: 12px;
}
.logo-text {
  font-weight: 600;
  font-size: 1.25rem;
  color: var(--text-dark);
}
.logo-icon {
  height: 28px;
  width: auto;
}
.nav-right {
  display: flex;
  align-items: center;
  gap: 16px;
}
.signin-link {
  text-decoration: none;
  color: var(--text-light);
  font-weight: 500;
  font-size: 0.95rem;
  transition: color 0.2s ease;
}
.signin-link:hover {
  color: var(--primary-blue);
}
.demo-button-secondary {
  background-color: var(--primary-blue);
  color: white;
  text-decoration: none;
  border: none;
  border-radius: 8px;
  padding: 8px 16px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
}

/* ===== MAIN CONTENT ===== */
.chrono-main-content {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  padding: 120px 32px 60px;
}
.hero-content {
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-bottom: 6rem;
}

.hero-graphic {
  margin-bottom: 2rem;
}
.hero-graphic img {
  max-width: 100px;
  width: 100%;
  height: auto;
  object-fit: contain;
}

.hero-headline {
  font-size: 3.5rem;
  font-weight: 800;
  line-height: 1.2;
  margin: 0 0 16px 0;
  max-width: 700px;
  color: var(--text-dark);
}
.hero-subheadline {
  font-size: 1.125rem;
  color: var(--text-light);
  margin: 0 0 32px 0;
  max-width: 600px;
  line-height: 1.6;
}
.demo-button-primary {
  background-color: var(--primary-blue);
  color: white;
  border-radius: 8px;
  padding: 14px 28px;
  font-size: 1rem;
  font-weight: 600;
  text-decoration: none;
  transition: all 0.2s ease;
  box-shadow: 0 4px 14px rgba(37, 99, 235, 0.3);
}
.demo-button-primary:hover,
.demo-button-secondary:hover {
  filter: brightness(1.1);
  transform: translateY(-2px);
}

.section-eyebrow {
  text-align: center;
  color: var(--primary-blue);
  font-weight: 600;
  margin-bottom: 1rem;
  font-size: 1rem;
}
.section-title {
  font-size: 2.5rem;
  font-weight: 700;
  text-align: center;
  margin-bottom: 1rem;
  color: var(--text-dark);
}
.section-subtitle {
  font-size: 1.125rem;
  color: var(--text-light);
  max-width: 600px;
  text-align: center;
  margin-left: auto;
  margin-right: auto;
  margin-bottom: 3rem;
  line-height: 1.6;
}

/* ===== Partners Section ===== */
.partners-section {
  width: 100%;
  padding: 4rem 0;
}
.partners-grid {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  align-items: center;
  gap: 4.5rem;
}
.partner-logo {
  height: 55px;
}
.partner-logo img {
  height: 100%;
  max-width: 180px;
  object-fit: contain;
  transition: all 0.3s ease;
}
.partner-logo img:hover {
  transform: scale(1.05);
}

/* ===== Stats Section ===== */
.stats-section {
  display: flex;
  gap: 2rem;
  width: 100%;
  justify-content: center;
  padding: 4rem 0;
  flex-wrap: wrap;
}
.stat-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  padding: 1.5rem;
  flex: 1;
  min-width: 200px;
}
.stat-icon {
  color: var(--primary-blue);
  margin-bottom: 1rem;
}
.stat-number {
  font-size: 2.5rem;
  font-weight: 700;
  line-height: 1;
  color: var(--text-dark);
}
.stat-label {
  font-size: 1rem;
  color: var(--text-light);
  margin-top: 0.5rem;
}

/* ===== Testimonials Section ===== */
.testimonials-section {
  width: 100vw;
  max-width: 100%;
  padding: 6rem 0;
  background-color: var(--section-bg);
  overflow: hidden;
  border-top: 1px solid var(--border-color);
  border-bottom: 1px solid var(--border-color);
}
.testimonials-container {
  max-width: 900px;
  margin: 0 auto;
  padding: 0 1rem;
}
.testimonial-slider {
  position: relative;
  min-height: 350px;
  display: flex;
  align-items: center;
}
.testimonial-slide {
  display: flex;
  align-items: center;
  gap: 3rem;
  width: 100%;
  opacity: 1;
  transition: opacity 0.3s ease-in-out;
}
.testimonial-slide.fading {
  opacity: 0;
}
.testimonial-image-wrapper {
  position: relative;
  flex-shrink: 0;
  width: 250px;
  height: 250px;
}
.testimonial-image-wrapper::before {
  content: "";
  position: absolute;
  width: 100%;
  height: 100%;
  background-color: var(--primary-blue);
  border-radius: 50%;
  top: 10%;
  left: 10%;
  z-index: 0;
  opacity: 0.1;
}
.testimonial-avatar {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  object-fit: cover;
  position: relative;
  z-index: 1;
  border: 4px solid var(--card-bg);
}
.testimonial-content {
  text-align: left;
}
.testimonial-quote {
  font-size: 1.25rem;
  font-style: italic;
  line-height: 1.6;
  color: var(--text-light);
  margin-bottom: 2rem;
}
.testimonial-author-name {
  display: block;
  font-size: 1.2rem;
  font-weight: 700;
  color: var(--text-dark);
}
.testimonial-author-title {
  display: block;
  color: var(--text-light);
}
.slider-nav {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background-color: var(--card-bg);
  border: 1px solid var(--border-color);
  color: var(--text-light);
  border-radius: 50%;
  width: 48px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  z-index: 10;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
}
.slider-nav:hover {
  background-color: var(--primary-blue);
  color: white;
}
.slider-nav.prev {
  left: -24px;
}
.slider-nav.next {
  right: -24px;
}
.slider-dots {
  display: flex;
  justify-content: center;
  gap: 0.75rem;
  margin-top: 2rem;
}
.slider-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background-color: var(--border-color);
  border: none;
  cursor: pointer;
  padding: 0;
  transition: all 0.3s ease;
}
.slider-dot.active {
  background-color: var(--primary-blue);
  transform: scale(1.2);
}

/* ===== Pricing Section ===== */
.pricing-section {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2rem;
  margin-top: 6rem;
  width: 100%;
}
.pricing-grid {
  display: flex;
  gap: 2rem;
  width: 100%;
  max-width: 1200px;
  justify-content: center;
  flex-wrap: wrap;
}
.pricing-card {
  background-color: var(--card-bg);
  border: 1px solid var(--border-color);
  border-radius: 12px;
  padding: 2rem;
  flex: 1;
  min-width: 250px;
  max-width: 300px;
  display: flex;
  flex-direction: column;
  text-align: left;
  transition: all 0.3s ease;
  position: relative;
}
.pricing-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.07);
}
.pricing-card.popular {
  border-color: var(--primary-blue);
  transform: scale(1.05);
}
.popular-badge {
  position: absolute;
  top: -15px;
  left: 50%;
  transform: translateX(-50%);
  background-color: var(--primary-blue);
  color: white;
  padding: 0.25rem 0.75rem;
  border-radius: 99px;
  font-size: 0.8rem;
  font-weight: 600;
}
.plan-title {
  font-size: 1.25rem;
  font-weight: 600;
  color: var(--text-dark);
}
.plan-price {
  font-size: 2.5rem;
  font-weight: 700;
  margin: 0.5rem 0;
  color: var(--text-dark);
}
.plan-suffix {
  font-size: 1rem;
  font-weight: 400;
  color: var(--text-light);
}
.plan-features {
  list-style: none;
  padding: 0;
  margin: 1.5rem 0;
  color: var(--text-light);
  flex-grow: 1;
}
.plan-features li {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  margin-bottom: 0.75rem;
  color: var(--text-dark);
}
.plan-button {
  width: 100%;
  text-align: center;
  padding: 0.75rem;
  border-radius: 8px;
  text-decoration: none;
  font-weight: 600;
  background-color: white;
  color: var(--primary-blue);
  border: 1px solid var(--primary-blue);
  cursor: pointer;
  transition: all 0.2s ease;
}
.plan-button.primary,
.plan-button:hover {
  background-color: var(--primary-blue);
  color: white;
}

/* ===== API CTA Section ===== */
.api-cta-section {
  width: 100%;
  margin: 6rem 0;
  padding: 4rem;
  background-color: var(--text-dark);
  color: white;
  border-radius: 16px;
  display: flex;
  align-items: center;
  gap: 3rem;
  position: relative;
  overflow: hidden;
}
.api-cta-section .section-title {
  color: white;
}
.api-cta-section .section-subtitle {
  color: rgba(255, 255, 255, 0.7);
}
.api-cta-icon-wrapper {
  flex-shrink: 0;
  background-color: rgba(59, 130, 246, 0.1);
  color: var(--primary-blue);
  width: 96px;
  height: 96px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid var(--primary-blue);
}
.api-cta-content {
  text-align: left;
}
.api-cta-content .section-title,
.api-cta-content .section-subtitle {
  text-align: left;
  margin-left: 0;
  margin-right: 0;
}
.api-cta-content .section-subtitle {
  margin-bottom: 1.5rem;
}
.api-cta-section .demo-button-secondary {
  background-color: white;
  color: var(--primary-blue);
}

/* ===== Public Footer ===== */
.public-footer {
  background-color: var(--section-bg);
  border-top: 1px solid var(--border-color);
  color: var(--text-light);
  padding: 4rem 2rem 2rem;
  width: 100%;
}
.footer-container {
  max-width: 1200px;
  margin: 0 auto;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 2rem;
}
.footer-column .footer-heading {
  font-size: 1rem;
  font-weight: 600;
  color: var(--text-dark);
  margin-bottom: 1rem;
}
.footer-links {
  list-style: none;
  padding: 0;
  margin: 0;
}
.footer-links li {
  margin-bottom: 0.75rem;
}
.footer-links a {
  color: var(--text-light);
  text-decoration: none;
  transition: color 0.2s ease;
}
.footer-links a:hover {
  color: var(--primary-blue);
}
.footer-brand .footer-logo {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 1rem;
}
.footer-tagline {
  font-size: 0.9rem;
  line-height: 1.5;
  margin-bottom: 1.5rem;
}
.social-links {
  display: flex;
  gap: 1rem;
}
.social-links a {
  color: var(--text-light);
  transition: color 0.2s ease;
}
.social-links a:hover {
  color: var(--primary-blue);
}
.footer-bottom {
  max-width: 1200px;
  margin: 3rem auto 0;
  padding-top: 2rem;
  border-top: 1px solid var(--border-color);
  text-align: center;
  font-size: 0.875rem;
}

/* ===== Mobile Menu ===== */
.mobile-menu-button {
  display: none;
  background: none;
  border: none;
  padding: 0.5rem;
  cursor: pointer;
  color: var(--text-dark);
}
.mobile-menu-fullscreen {
  position: fixed;
  inset: 0;
  background-color: var(--card-bg);
  z-index: 2000;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 1rem;
  animation: fadeIn 0.3s ease-in-out;
}
@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
.mobile-menu-close {
  position: absolute;
  top: 1.5rem;
  right: 1.5rem;
  background: none;
  border: none;
  color: var(--text-light);
  cursor: pointer;
}
.mobile-menu-link {
  color: var(--text-dark);
  text-decoration: none;
  font-size: 1.75rem;
  font-weight: 600;
  padding: 0.75rem 1.5rem;
  border-radius: 8px;
  transition: color 0.2s ease, background-color 0.2s ease;
  display: flex;
  align-items: center;
  gap: 1rem;
}
.mobile-menu-link:hover {
  background-color: var(--bg-color);
  color: var(--primary-blue);
}

/* ===== RESPONSIVENESS ===== */
@media (max-width: 992px) {
  .chrono-header.has-mobile-menu .nav-right {
    display: none;
  }
  .chrono-header.has-mobile-menu .mobile-menu-button {
    display: block;
  }
}

@media (max-width: 768px) {
  .hero-headline {
    font-size: 2.5rem;
  }
  .section-title {
    font-size: 2rem;
  }
  .pricing-card.popular {
    transform: scale(1);
  }
  .pricing-grid {
    flex-direction: column;
    gap: 1.5rem;
  }
  .pricing-card {
    min-width: 100%;
  }
  .testimonial-slide {
    flex-direction: column;
    text-align: center;
    gap: 1.5rem;
  }
  .testimonial-content {
    text-align: center;
  }
  .testimonial-image-wrapper {
    width: 150px;
    height: 150px;
  }
  .slider-nav {
    display: none;
  }
  .api-cta-section {
    flex-direction: column;
    text-align: center;
    padding: 2.5rem;
    gap: 2rem;
  }
  .api-cta-content .section-title,
  .api-cta-content .section-subtitle {
    text-align: center;
  }
}



==================================================
FILE: styles\MyCertificatesPage.css
==================================================

/* frontend/src/styles/MyCertificatesPage.css */
.my-certificates-page {
  padding: 20px;
  max-width: 1400px;
  margin: 0 auto;
}

.stat-card {
  background: white;
  border-radius: 12px;
  padding: 24px;
  text-align: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  transition: transform 0.2s, box-shadow 0.2s;
}

.stat-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
}

.stat-card-icon {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 12px;
  font-size: 1.2em;
}

.stat-card-icon.blue {
  background: linear-gradient(135deg, #2563eb, #1d4ed8);
  color: white;
}
.stat-card-icon.green {
  background: linear-gradient(135deg, #22c55e, #16a34a);
  color: white;
}
.stat-card-icon.gold {
  background: linear-gradient(135deg, #f59e0b, #d97706);
  color: white;
}

.content-card {
  background: white;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.cert-item {
  border-left: 4px solid #2563eb;
  transition: background-color 0.2s;
}

.cert-item:hover {
  background-color: #f8f9fa;
}

.action-btn {
  border-radius: 6px;
  padding: 6px 12px;
  font-size: 0.9em;
}

.action-btn.view {
  background: #e3f2fd;
  color: #1976d2;
}
.action-btn.edit {
  background: #f3e5f5;
  color: #7b1fa2;
}
.action-btn.delete {
  background: #ffebee;
  color: #c62828;
}

.empty-state-card {
  text-align: center;
  padding: 60px 20px;
  background: #f8f9fa;
  border-radius: 12px;
  border: 2px dashed #dee2e6;
}

.alert {
  border-radius: 8px;
}



==================================================
FILE: styles\OpenLedger.css
==================================================

:root {
  --ledger-bg: #f8f9fa;
  --ledger-card-bg: #ffffff;
  --ledger-primary: #2563eb;
  --ledger-text-dark: #1f2937;
  --ledger-text-light: #6b7280;
  --ledger-border: #e5e7eb;
}

.ledger-page-wrapper {
  background-color: var(--ledger-bg);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.ledger-main {
  flex-grow: 1;
  /* Add padding to create space for the fixed header and before the footer */
  padding-top: 120px;
  padding-bottom: 60px;
}

.filter-sidebar {
  background-color: var(--ledger-card-bg);
  border-radius: 0.75rem;
  padding: 1.5rem;
  box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  position: sticky;
  top: 100px; /* ADJUSTED: To stick below the fixed public header */
}

.credential-card {
  background-color: var(--ledger-card-bg);
  border: 1px solid var(--ledger-border);
  border-radius: 0.75rem;
  text-decoration: none;
  color: var(--ledger-text-dark);
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  height: 100%;
}

.credential-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
  border-color: var(--ledger-primary);
}

.credential-card .card-body {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
}

.card-issuer {
  color: var(--ledger-text-light);
  font-weight: 500;
  font-size: 0.875rem;
}

.card-recipient {
  font-size: 1.3rem;
  font-weight: 700;
  color: var(--ledger-text-dark);
}

.card-course {
  font-size: 1.1rem;
  color: var(--ledger-primary);
  font-weight: 600;
  flex-grow: 1;
}

.card-footer {
  background-color: transparent !important;
  border-top: 1px solid var(--ledger-border);
  font-size: 0.8rem;
  color: var(--ledger-text-light);
}

/* Skeleton Loader */
.skeleton-card {
  background-color: #fff;
  border: 1px solid #e5e7eb;
  border-radius: 0.75rem;
  padding: 1.5rem;
}

.skeleton {
  opacity: 0.7;
  animation: shimmer 2s infinite linear;
  background: linear-gradient(to right, #f6f7f8 4%, #edeef1 25%, #f6f7f8 36%);
  background-size: 1000px 100%;
}

@keyframes shimmer {
  0% {
    background-position: -1000px 0;
  }
  100% {
    background-position: 1000px 0;
  }
}

.skeleton.skeleton-text {
  width: 100%;
  height: 0.75rem;
  border-radius: 0.25rem;
}

/* Date Picker Customization */
.react-datepicker-wrapper {
  display: block !important;
}

.date-range-picker {
  width: 100%;
}

/* Empty/Initial State Card */
.placeholder-card {
  border: 2px dashed var(--ledger-border);
  background-color: #fff;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 3rem;
  text-align: center;
  min-height: 400px;
}

/* Pagination Styles */
.pagination .page-item.active .page-link {
  background-color: var(--ledger-primary);
  border-color: var(--ledger-primary);
}

.pagination .page-link {
  color: var(--ledger-primary);
}

.pagination .page-link:hover {
  color: #1e4ead; /* A darker shade of primary blue */
}



==================================================
FILE: styles\style.css
==================================================

/* frontend/src/styles/styles.css */
.navbar-sticky {
  background-color: #111827;
  transition: background-color 0.3s ease;
}

.navbar-scrolled {
  background-color: #1e293b !important;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.hero-section {
  background: linear-gradient(135deg, #2563eb 0%, #22c55e 100%);
  color: white;
  padding: 80px 0;
}

.feature-card {
  border: none;
  transition: transform 0.2s;
}

.feature-card:hover {
  transform: translateY(-5px);
}

.feature-icon {
  color: #2563eb;
}

.pricing-card {
  background-color: #1e293b;
  color: white;
  border: none;
}

.pricing-card.highlighted {
  background-color: #2563eb;
  box-shadow: 0 0 15px rgba(37, 99, 235, 0.5);
}

.plan-title {
  font-size: 1.5rem;
}

.free-title {
  color: #22c55e;
}

.monthly-title {
  color: #facc15;
}

.lifetime-title {
  color: #ffffff;
}



==================================================
FILE: styles\SupportPage.css
==================================================

.support-thumbnail {
  max-width: 200px;
  max-height: 200px;
  cursor: pointer;
  transition: opacity 0.2s ease-in-out;
}

.support-thumbnail:hover {
  opacity: 0.8;
}

.support-contact-card {
  background-color: #f8f9fa; /* A light grey background */
  border: 1px solid #dee2e6;
  border-radius: 0.75rem;
}

.status-indicator-container {
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 1rem;
  font-weight: 600;
}

.status-indicator {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  margin-right: 8px;
  transition: background-color 0.3s ease;
}

.status-indicator.online {
  background-color: #198754; /* Bootstrap success green */
  animation: pulse 2s infinite;
}

.status-indicator.offline {
  background-color: #dc3545; /* Bootstrap danger red */
}

@keyframes pulse {
  0% {
    box-shadow: 0 0 0 0 rgba(25, 135, 84, 0.7);
  }
  70% {
    box-shadow: 0 0 0 10px rgba(25, 135, 84, 0);
  }
  100% {
    box-shadow: 0 0 0 0 rgba(25, 135, 84, 0);
  }
}



==================================================
FILE: styles\TicketPage.css
==================================================

/* --- Ticket List Styles --- */
.ticket-list-item {
  transition: background-color 0.2s ease-in-out,
    border-left-color 0.2s ease-in-out;
  border-left: 4px solid transparent;
}

.ticket-list-item:hover {
  background-color: #f8f9fa; /* Light grey on hover */
  border-left-color: #0d6efd; /* Primary blue */
}

.ticket-list-item .btn-delete {
  opacity: 0;
  transition: opacity 0.2s ease-in-out;
}

.ticket-list-item:hover .btn-delete {
  opacity: 1;
}

/* --- Ticket Details (Chat View) Styles --- */
.chat-container-card {
  display: flex;
  flex-direction: column;
  height: 75vh; /* Taller chat window */
}

.chat-header {
  flex-shrink: 0;
  border-bottom: 1px solid #dee2e6;
}

.chat-body {
  flex-grow: 1;
  overflow-y: auto;
  padding: 1.5rem;
  background-color: #f8f9fa; /* Light background for chat area */
}

.chat-bubble {
  max-width: 75%;
  padding: 0.75rem 1.25rem;
  word-wrap: break-word;
  white-space: pre-wrap; /* Preserves whitespace and newlines */
}

.chat-bubble.user {
  background-color: #0d6efd; /* Primary blue */
  color: white;
  align-self: flex-end;
  border-radius: 1.25rem 1.25rem 0.25rem 1.25rem; /* Modern bubble shape */
}

.chat-bubble.admin {
  background-color: #ffffff;
  color: #212529;
  border: 1px solid #dee2e6;
  align-self: flex-start;
  border-radius: 1.25rem 1.25rem 1.25rem 0.25rem;
}

.chat-footer {
  flex-shrink: 0;
  background-color: #ffffff;
  border-top: 1px solid #dee2e6;
  padding: 1rem;
}

.chat-footer .form-control {
  border-radius: 1.5rem;
  background-color: #f1f3f5;
  border: none;
  padding: 0.75rem 1.25rem;
}

.chat-footer .form-control:focus {
  background-color: #e9ecef;
  box-shadow: none;
}

.chat-footer .btn {
  border-radius: 50%;
  width: 48px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
}



==================================================
FILE: styles\VerifyPage.css
==================================================

.verify-page-wrapper {
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  background-color: #f8f9fa; /* A clean, light gray background */
}

.verify-main {
  flex-grow: 1;
  /* Add padding to create space for the fixed header and before the footer */
  padding-top: 120px;
  padding-bottom: 60px;
}


